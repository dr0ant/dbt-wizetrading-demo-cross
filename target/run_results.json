{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.11", "generated_at": "2024-04-16T16:29:44.832232Z", "invocation_id": "fdbe5417-6adb-487f-bb3a-9371658a4299", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.623135Z", "completed_at": "2024-04-16T16:29:44.631300Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.631300Z", "completed_at": "2024-04-16T16:29:44.631300Z"}], "thread_id": "Thread-1", "execution_time": 0.010163307189941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perptreated_data", "compiled": true, "compiled_code": "with source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"raw_data\"\n),\nfinal as \n(\n   select\n       stream      :: varchar as stream\n       ,\"data_e\"   :: varchar as event_type\n       ,\"data_E\"   :: bigint as event_time\n       ,\"data_s\"   :: varchar as symbole_src\n       ,\"data_k_t\" :: bigint as candle_open_time\n       ,\"data_k_T\" :: bigint as candle_close_time\n       ,\"data_k_s\" :: varchar as symbole\n       ,\"data_k_i\" :: varchar as interval\n       ,\"data_k_f\" :: int as first_trade_id\n       ,\"data_k_L\" :: int as last_trade_id\n       ,\"data_k_o\" :: decimal as openprice\n       ,\"data_k_c\" :: decimal as close_price\n       ,\"data_k_h\" :: decimal as high_price\n       ,\"data_k_l\" :: decimal as low_price\n       ,\"data_k_v\" :: int as base_asset_volume\n       ,\"data_k_n\" :: int as  nb_trades\n       ,\"data_k_x\" :: boolean as candle_closed\n       ,\"data_k_q\" :: decimal as quote_asset_volume\n       ,\"data_k_V\" :: decimal as taker_buy_base_asset_volume\n       ,\"data_k_Q\" :: decimal as taker_buy_quote_asset_volume\n    from wizetrading.raw_data\n)\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.631300Z", "completed_at": "2024-04-16T16:29:44.644411Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.645807Z", "completed_at": "2024-04-16T16:29:44.645807Z"}], "thread_id": "Thread-1", "execution_time": 0.014507293701171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.raw_data_btc_perp", "compiled": true, "compiled_code": "with source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"raw_data\"\n),\nfinal as (\n    select * from source_btc_data\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"raw_data_btc_perp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.645807Z", "completed_at": "2024-04-16T16:29:44.645807Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.645807Z", "completed_at": "2024-04-16T16:29:44.645807Z"}], "thread_id": "Thread-1", "execution_time": 0.01634526252746582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_15m", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n        and interval ='15m'\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_15m\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.666307Z", "completed_at": "2024-04-16T16:29:44.710198Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.712198Z", "completed_at": "2024-04-16T16:29:44.712198Z"}], "thread_id": "Thread-1", "execution_time": 0.04800081253051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_15m_history", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n         AND source_btc_data.interval::text = '15m'::text\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_15m_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.717204Z", "completed_at": "2024-04-16T16:29:44.727204Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.728204Z", "completed_at": "2024-04-16T16:29:44.728204Z"}], "thread_id": "Thread-1", "execution_time": 0.014998674392700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_1h", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n        and interval ='1h'\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_1h\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.731203Z", "completed_at": "2024-04-16T16:29:44.736204Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.737204Z", "completed_at": "2024-04-16T16:29:44.737204Z"}], "thread_id": "Thread-1", "execution_time": 0.008000850677490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_1h_history", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n         AND source_btc_data.interval::text = '1h'::text\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_1h_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.740204Z", "completed_at": "2024-04-16T16:29:44.743203Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.744204Z", "completed_at": "2024-04-16T16:29:44.744204Z"}], "thread_id": "Thread-1", "execution_time": 0.005995273590087891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_1w", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n        and interval ='1w'\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_1w\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.748204Z", "completed_at": "2024-04-16T16:29:44.751204Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.753197Z", "completed_at": "2024-04-16T16:29:44.753197Z"}], "thread_id": "Thread-1", "execution_time": 0.00699925422668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_1w_history", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n         AND source_btc_data.interval::text = '1w'::text\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_1w_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.756204Z", "completed_at": "2024-04-16T16:29:44.760205Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.761203Z", "completed_at": "2024-04-16T16:29:44.761203Z"}], "thread_id": "Thread-1", "execution_time": 0.0069997310638427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_4h", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n        and interval ='4h'\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_4h\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.765204Z", "completed_at": "2024-04-16T16:29:44.768203Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.770080Z", "completed_at": "2024-04-16T16:29:44.770080Z"}], "thread_id": "Thread-1", "execution_time": 0.007905721664428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_4h_history", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n         AND source_btc_data.interval::text = '4h'::text\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_4h_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.776114Z", "completed_at": "2024-04-16T16:29:44.781113Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.783108Z", "completed_at": "2024-04-16T16:29:44.783108Z"}], "thread_id": "Thread-1", "execution_time": 0.009997844696044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_5m", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n        and interval ='5m'\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_5m\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.788114Z", "completed_at": "2024-04-16T16:29:44.793113Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.794114Z", "completed_at": "2024-04-16T16:29:44.795109Z"}], "thread_id": "Thread-1", "execution_time": 0.010999917984008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_5m_history", "compiled": true, "compiled_code": "-- This is now a dbt model file, not a raw SQL query\nwith source_btc_data as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perptreated_data\"\n),\nfinal as (\n    select * from source_btc_data\n    where 1=1\n         AND source_btc_data.interval::text = '5m'::text\n)\n\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_5m_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.798113Z", "completed_at": "2024-04-16T16:29:44.804108Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.805114Z", "completed_at": "2024-04-16T16:29:44.805114Z"}], "thread_id": "Thread-1", "execution_time": 0.008994340896606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history", "compiled": true, "compiled_code": "-- wizetrading.candle_15min_current_and_history source\n\n-- This is now a dbt model file, not a raw SQL query\nwith \nBTC_PERP_15m_btc_c as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_15m\"\n)\n,\nBTC_PERP_15m_btc_h as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_15m_history\"\n),\nBTC_PERP_15m_btc_c_treated as (\n    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n    stream,\n    event_type,\n    event_time,\n    symbole_src,\n    candle_open_time,\n    candle_close_time,\n    symbole,\n    \"interval\",\n    first_trade_id,\n    last_trade_id,\n    openprice,\n    close_price,\n    high_price,\n    low_price,\n    base_asset_volume,\n    nb_trades,\n    candle_closed,\n    quote_asset_volume,\n    taker_buy_base_asset_volume,\n    taker_buy_quote_asset_volume\n    FROM BTC_PERP_15m_btc_c\n      WHERE candle_closed = false\n)\n,\nBTC_PERP_15m_btc_h_treated as (\n         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n         stream,\n         event_type,\n         event_time,\n         symbole_src,\n         candle_open_time,\n         candle_close_time,\n         symbole,\n         \"interval\",\n         first_trade_id,\n         last_trade_id,\n         openprice,\n         close_price,\n         high_price,\n         low_price,\n         base_asset_volume,\n         nb_trades,\n         candle_closed,\n         quote_asset_volume,\n         taker_buy_base_asset_volume,\n         taker_buy_quote_asset_volume\n        FROM BTC_PERP_15m_btc_h\n)\n,\npivot_curent AS (\n         select curr.formatted_datetime,\n         curr.stream,\n         curr.event_type,\n         curr.event_time,\n         curr.symbole_src,\n         curr.candle_open_time,\n         curr.candle_close_time,\n         curr.symbole,\n         curr.\"interval\",\n         curr.first_trade_id,\n         curr.last_trade_id,\n         curr.openprice,\n         curr.close_price,\n         curr.high_price,\n         curr.low_price,\n         curr.base_asset_volume,\n         curr.nb_trades,\n         curr.candle_closed,\n         curr.quote_asset_volume,\n         curr.taker_buy_base_asset_volume,\n         curr.taker_buy_quote_asset_volume,\n         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,\n         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,\n         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,\n         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,\n         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,\n         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,\n         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,\n         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,\n         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,\n         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,\n         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,\n         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,\n         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,\n         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,\n         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,\n         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,\n         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,\n         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,\n         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,\n         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,\n         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,\n         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,\n         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,\n         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,\n         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,\n         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,\n         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,\n         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,\n         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,\n         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,\n         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,\n         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,\n         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,\n         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,\n         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,\n         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,\n         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,\n         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,\n         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,\n         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,\n         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank\n           FROM BTC_PERP_15m_btc_c_treated curr\n             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time\n          ORDER BY curr.event_time\n)\n,\nfinal as \n(\n    SELECT pivot_curent.formatted_datetime,\n    pivot_curent.stream,\n    pivot_curent.event_type,\n    pivot_curent.event_time,\n    pivot_curent.symbole_src,\n    pivot_curent.candle_open_time,\n    pivot_curent.candle_close_time,\n    pivot_curent.symbole,\n    pivot_curent.\"interval\",\n    pivot_curent.first_trade_id,\n    pivot_curent.last_trade_id,\n    pivot_curent.openprice,\n    pivot_curent.close_price,\n    pivot_curent.high_price,\n    pivot_curent.low_price,\n    pivot_curent.base_asset_volume,\n    pivot_curent.nb_trades,\n    pivot_curent.candle_closed,\n    pivot_curent.quote_asset_volume,\n    pivot_curent.taker_buy_base_asset_volume,\n    pivot_curent.taker_buy_quote_asset_volume,\n    pivot_curent.openprice_lag_1,\n    pivot_curent.openprice_lag_2,\n    pivot_curent.openprice_lag_3,\n    pivot_curent.openprice_lag_4,\n    pivot_curent.openprice_lag_5,\n    pivot_curent.openprice_lag_6,\n    pivot_curent.openprice_lag_7,\n    pivot_curent.openprice_lag_8,\n    pivot_curent.openprice_lag_9,\n    pivot_curent.openprice_lag_10,\n    pivot_curent.close_price_lag_1,\n    pivot_curent.close_price_lag_2,\n    pivot_curent.close_price_lag_3,\n    pivot_curent.close_price_lag_4,\n    pivot_curent.close_price_lag_5,\n    pivot_curent.close_price_lag_6,\n    pivot_curent.close_price_lag_7,\n    pivot_curent.close_price_lag_8,\n    pivot_curent.close_price_lag_9,\n    pivot_curent.close_price_lag_10,\n    pivot_curent.high_price_lag_1,\n    pivot_curent.high_price_lag_2,\n    pivot_curent.high_price_lag_3,\n    pivot_curent.high_price_lag_4,\n    pivot_curent.high_price_lag_5,\n    pivot_curent.high_price_lag_6,\n    pivot_curent.high_price_lag_7,\n    pivot_curent.high_price_lag_8,\n    pivot_curent.high_price_lag_9,\n    pivot_curent.high_price_lag_10,\n    pivot_curent.low_price_lag_1,\n    pivot_curent.low_price_lag_2,\n    pivot_curent.low_price_lag_3,\n    pivot_curent.low_price_lag_4,\n    pivot_curent.low_price_lag_5,\n    pivot_curent.low_price_lag_6,\n    pivot_curent.low_price_lag_7,\n    pivot_curent.low_price_lag_8,\n    pivot_curent.low_price_lag_9,\n    pivot_curent.low_price_lag_10,\n    pivot_curent.rank\n   FROM pivot_curent\n  WHERE pivot_curent.rank = 1\n)\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_15m_current_and_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.809093Z", "completed_at": "2024-04-16T16:29:44.813324Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.815008Z", "completed_at": "2024-04-16T16:29:44.815008Z"}], "thread_id": "Thread-1", "execution_time": 0.008089065551757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history", "compiled": true, "compiled_code": "-- wizetrading.candle_1hour_current_and_history source\n\n-- This is now a dbt model file, not a raw SQL query\nwith \nBTC_PERP_1h_btc_c as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_1h\"\n)\n,\nBTC_PERP_1h_btc_h as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_1h_history\"\n),\nBTC_PERP_1h_btc_c_treated as (\n    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n    stream,\n    event_type,\n    event_time,\n    symbole_src,\n    candle_open_time,\n    candle_close_time,\n    symbole,\n    \"interval\",\n    first_trade_id,\n    last_trade_id,\n    openprice,\n    close_price,\n    high_price,\n    low_price,\n    base_asset_volume,\n    nb_trades,\n    candle_closed,\n    quote_asset_volume,\n    taker_buy_base_asset_volume,\n    taker_buy_quote_asset_volume\n    FROM BTC_PERP_1h_btc_c\n      WHERE candle_closed = false\n)\n,\nBTC_PERP_1h_btc_h_treated as (\n         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n         stream,\n         event_type,\n         event_time,\n         symbole_src,\n         candle_open_time,\n         candle_close_time,\n         symbole,\n         \"interval\",\n         first_trade_id,\n         last_trade_id,\n         openprice,\n         close_price,\n         high_price,\n         low_price,\n         base_asset_volume,\n         nb_trades,\n         candle_closed,\n         quote_asset_volume,\n         taker_buy_base_asset_volume,\n         taker_buy_quote_asset_volume\n        FROM BTC_PERP_1h_btc_h\n)\n,\npivot_curent AS (\n         select curr.formatted_datetime,\n         curr.stream,\n         curr.event_type,\n         curr.event_time,\n         curr.symbole_src,\n         curr.candle_open_time,\n         curr.candle_close_time,\n         curr.symbole,\n         curr.\"interval\",\n         curr.first_trade_id,\n         curr.last_trade_id,\n         curr.openprice,\n         curr.close_price,\n         curr.high_price,\n         curr.low_price,\n         curr.base_asset_volume,\n         curr.nb_trades,\n         curr.candle_closed,\n         curr.quote_asset_volume,\n         curr.taker_buy_base_asset_volume,\n         curr.taker_buy_quote_asset_volume,\n         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,\n         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,\n         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,\n         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,\n         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,\n         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,\n         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,\n         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,\n         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,\n         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,\n         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,\n         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,\n         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,\n         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,\n         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,\n         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,\n         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,\n         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,\n         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,\n         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,\n         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,\n         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,\n         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,\n         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,\n         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,\n         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,\n         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,\n         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,\n         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,\n         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,\n         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,\n         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,\n         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,\n         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,\n         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,\n         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,\n         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,\n         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,\n         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,\n         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,\n         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank\n           FROM BTC_PERP_1h_btc_c_treated curr\n             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time\n          ORDER BY curr.event_time\n)\n,\nfinal as \n(\n    SELECT pivot_curent.formatted_datetime,\n    pivot_curent.stream,\n    pivot_curent.event_type,\n    pivot_curent.event_time,\n    pivot_curent.symbole_src,\n    pivot_curent.candle_open_time,\n    pivot_curent.candle_close_time,\n    pivot_curent.symbole,\n    pivot_curent.\"interval\",\n    pivot_curent.first_trade_id,\n    pivot_curent.last_trade_id,\n    pivot_curent.openprice,\n    pivot_curent.close_price,\n    pivot_curent.high_price,\n    pivot_curent.low_price,\n    pivot_curent.base_asset_volume,\n    pivot_curent.nb_trades,\n    pivot_curent.candle_closed,\n    pivot_curent.quote_asset_volume,\n    pivot_curent.taker_buy_base_asset_volume,\n    pivot_curent.taker_buy_quote_asset_volume,\n    pivot_curent.openprice_lag_1,\n    pivot_curent.openprice_lag_2,\n    pivot_curent.openprice_lag_3,\n    pivot_curent.openprice_lag_4,\n    pivot_curent.openprice_lag_5,\n    pivot_curent.openprice_lag_6,\n    pivot_curent.openprice_lag_7,\n    pivot_curent.openprice_lag_8,\n    pivot_curent.openprice_lag_9,\n    pivot_curent.openprice_lag_10,\n    pivot_curent.close_price_lag_1,\n    pivot_curent.close_price_lag_2,\n    pivot_curent.close_price_lag_3,\n    pivot_curent.close_price_lag_4,\n    pivot_curent.close_price_lag_5,\n    pivot_curent.close_price_lag_6,\n    pivot_curent.close_price_lag_7,\n    pivot_curent.close_price_lag_8,\n    pivot_curent.close_price_lag_9,\n    pivot_curent.close_price_lag_10,\n    pivot_curent.high_price_lag_1,\n    pivot_curent.high_price_lag_2,\n    pivot_curent.high_price_lag_3,\n    pivot_curent.high_price_lag_4,\n    pivot_curent.high_price_lag_5,\n    pivot_curent.high_price_lag_6,\n    pivot_curent.high_price_lag_7,\n    pivot_curent.high_price_lag_8,\n    pivot_curent.high_price_lag_9,\n    pivot_curent.high_price_lag_10,\n    pivot_curent.low_price_lag_1,\n    pivot_curent.low_price_lag_2,\n    pivot_curent.low_price_lag_3,\n    pivot_curent.low_price_lag_4,\n    pivot_curent.low_price_lag_5,\n    pivot_curent.low_price_lag_6,\n    pivot_curent.low_price_lag_7,\n    pivot_curent.low_price_lag_8,\n    pivot_curent.low_price_lag_9,\n    pivot_curent.low_price_lag_10,\n    pivot_curent.rank\n   FROM pivot_curent\n  WHERE pivot_curent.rank = 1\n)\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_1h_current_and_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.817587Z", "completed_at": "2024-04-16T16:29:44.822070Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.822070Z", "completed_at": "2024-04-16T16:29:44.822070Z"}], "thread_id": "Thread-1", "execution_time": 0.006539106369018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history", "compiled": true, "compiled_code": "-- wizetrading.candle_1week_current_and_history source\n\n-- This is now a dbt model file, not a raw SQL query\nwith \nBTC_PERP_1w_btc_c as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_1w\"\n)\n,\nBTC_PERP_1w_btc_h as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_1w_history\"\n),\nBTC_PERP_1w_btc_c_treated as (\n    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n    stream,\n    event_type,\n    event_time,\n    symbole_src,\n    candle_open_time,\n    candle_close_time,\n    symbole,\n    \"interval\",\n    first_trade_id,\n    last_trade_id,\n    openprice,\n    close_price,\n    high_price,\n    low_price,\n    base_asset_volume,\n    nb_trades,\n    candle_closed,\n    quote_asset_volume,\n    taker_buy_base_asset_volume,\n    taker_buy_quote_asset_volume\n    FROM BTC_PERP_1w_btc_c\n      WHERE candle_closed = false\n)\n,\nBTC_PERP_1w_btc_h_treated as (\n         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n         stream,\n         event_type,\n         event_time,\n         symbole_src,\n         candle_open_time,\n         candle_close_time,\n         symbole,\n         \"interval\",\n         first_trade_id,\n         last_trade_id,\n         openprice,\n         close_price,\n         high_price,\n         low_price,\n         base_asset_volume,\n         nb_trades,\n         candle_closed,\n         quote_asset_volume,\n         taker_buy_base_asset_volume,\n         taker_buy_quote_asset_volume\n        FROM BTC_PERP_1w_btc_h\n)\n,\npivot_curent AS (\n         select curr.formatted_datetime,\n         curr.stream,\n         curr.event_type,\n         curr.event_time,\n         curr.symbole_src,\n         curr.candle_open_time,\n         curr.candle_close_time,\n         curr.symbole,\n         curr.\"interval\",\n         curr.first_trade_id,\n         curr.last_trade_id,\n         curr.openprice,\n         curr.close_price,\n         curr.high_price,\n         curr.low_price,\n         curr.base_asset_volume,\n         curr.nb_trades,\n         curr.candle_closed,\n         curr.quote_asset_volume,\n         curr.taker_buy_base_asset_volume,\n         curr.taker_buy_quote_asset_volume,\n         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,\n         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,\n         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,\n         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,\n         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,\n         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,\n         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,\n         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,\n         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,\n         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,\n         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,\n         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,\n         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,\n         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,\n         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,\n         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,\n         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,\n         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,\n         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,\n         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,\n         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,\n         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,\n         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,\n         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,\n         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,\n         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,\n         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,\n         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,\n         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,\n         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,\n         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,\n         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,\n         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,\n         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,\n         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,\n         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,\n         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,\n         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,\n         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,\n         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,\n         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank\n           FROM BTC_PERP_1w_btc_c_treated curr\n             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time\n          ORDER BY curr.event_time\n)\n,\nfinal as \n(\n    SELECT pivot_curent.formatted_datetime,\n    pivot_curent.stream,\n    pivot_curent.event_type,\n    pivot_curent.event_time,\n    pivot_curent.symbole_src,\n    pivot_curent.candle_open_time,\n    pivot_curent.candle_close_time,\n    pivot_curent.symbole,\n    pivot_curent.\"interval\",\n    pivot_curent.first_trade_id,\n    pivot_curent.last_trade_id,\n    pivot_curent.openprice,\n    pivot_curent.close_price,\n    pivot_curent.high_price,\n    pivot_curent.low_price,\n    pivot_curent.base_asset_volume,\n    pivot_curent.nb_trades,\n    pivot_curent.candle_closed,\n    pivot_curent.quote_asset_volume,\n    pivot_curent.taker_buy_base_asset_volume,\n    pivot_curent.taker_buy_quote_asset_volume,\n    pivot_curent.openprice_lag_1,\n    pivot_curent.openprice_lag_2,\n    pivot_curent.openprice_lag_3,\n    pivot_curent.openprice_lag_4,\n    pivot_curent.openprice_lag_5,\n    pivot_curent.openprice_lag_6,\n    pivot_curent.openprice_lag_7,\n    pivot_curent.openprice_lag_8,\n    pivot_curent.openprice_lag_9,\n    pivot_curent.openprice_lag_10,\n    pivot_curent.close_price_lag_1,\n    pivot_curent.close_price_lag_2,\n    pivot_curent.close_price_lag_3,\n    pivot_curent.close_price_lag_4,\n    pivot_curent.close_price_lag_5,\n    pivot_curent.close_price_lag_6,\n    pivot_curent.close_price_lag_7,\n    pivot_curent.close_price_lag_8,\n    pivot_curent.close_price_lag_9,\n    pivot_curent.close_price_lag_10,\n    pivot_curent.high_price_lag_1,\n    pivot_curent.high_price_lag_2,\n    pivot_curent.high_price_lag_3,\n    pivot_curent.high_price_lag_4,\n    pivot_curent.high_price_lag_5,\n    pivot_curent.high_price_lag_6,\n    pivot_curent.high_price_lag_7,\n    pivot_curent.high_price_lag_8,\n    pivot_curent.high_price_lag_9,\n    pivot_curent.high_price_lag_10,\n    pivot_curent.low_price_lag_1,\n    pivot_curent.low_price_lag_2,\n    pivot_curent.low_price_lag_3,\n    pivot_curent.low_price_lag_4,\n    pivot_curent.low_price_lag_5,\n    pivot_curent.low_price_lag_6,\n    pivot_curent.low_price_lag_7,\n    pivot_curent.low_price_lag_8,\n    pivot_curent.low_price_lag_9,\n    pivot_curent.low_price_lag_10,\n    pivot_curent.rank\n   FROM pivot_curent\n  WHERE pivot_curent.rank = 1\n)\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_1w_current_and_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.826074Z", "completed_at": "2024-04-16T16:29:44.830077Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.831074Z", "completed_at": "2024-04-16T16:29:44.831074Z"}], "thread_id": "Thread-1", "execution_time": 0.0069997310638427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history", "compiled": true, "compiled_code": "-- wizetrading.candle_4hour_current_and_history source\n\n-- This is now a dbt model file, not a raw SQL query\nwith \nBTC_PERP_4h_btc_c as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_4h\"\n)\n,\nBTC_PERP_4h_btc_h as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_4h_history\"\n),\nBTC_PERP_4h_btc_c_treated as (\n    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n    stream,\n    event_type,\n    event_time,\n    symbole_src,\n    candle_open_time,\n    candle_close_time,\n    symbole,\n    \"interval\",\n    first_trade_id,\n    last_trade_id,\n    openprice,\n    close_price,\n    high_price,\n    low_price,\n    base_asset_volume,\n    nb_trades,\n    candle_closed,\n    quote_asset_volume,\n    taker_buy_base_asset_volume,\n    taker_buy_quote_asset_volume\n    FROM BTC_PERP_4h_btc_c\n      WHERE candle_closed = false\n)\n,\nBTC_PERP_4h_btc_h_treated as (\n         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n         stream,\n         event_type,\n         event_time,\n         symbole_src,\n         candle_open_time,\n         candle_close_time,\n         symbole,\n         \"interval\",\n         first_trade_id,\n         last_trade_id,\n         openprice,\n         close_price,\n         high_price,\n         low_price,\n         base_asset_volume,\n         nb_trades,\n         candle_closed,\n         quote_asset_volume,\n         taker_buy_base_asset_volume,\n         taker_buy_quote_asset_volume\n        FROM BTC_PERP_4h_btc_h\n)\n,\npivot_curent AS (\n         select curr.formatted_datetime,\n         curr.stream,\n         curr.event_type,\n         curr.event_time,\n         curr.symbole_src,\n         curr.candle_open_time,\n         curr.candle_close_time,\n         curr.symbole,\n         curr.\"interval\",\n         curr.first_trade_id,\n         curr.last_trade_id,\n         curr.openprice,\n         curr.close_price,\n         curr.high_price,\n         curr.low_price,\n         curr.base_asset_volume,\n         curr.nb_trades,\n         curr.candle_closed,\n         curr.quote_asset_volume,\n         curr.taker_buy_base_asset_volume,\n         curr.taker_buy_quote_asset_volume,\n         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,\n         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,\n         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,\n         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,\n         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,\n         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,\n         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,\n         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,\n         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,\n         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,\n         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,\n         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,\n         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,\n         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,\n         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,\n         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,\n         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,\n         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,\n         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,\n         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,\n         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,\n         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,\n         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,\n         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,\n         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,\n         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,\n         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,\n         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,\n         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,\n         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,\n         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,\n         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,\n         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,\n         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,\n         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,\n         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,\n         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,\n         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,\n         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,\n         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,\n         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank\n           FROM BTC_PERP_4h_btc_c_treated curr\n             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time\n          ORDER BY curr.event_time\n)\n,\nfinal as \n(\n    SELECT pivot_curent.formatted_datetime,\n    pivot_curent.stream,\n    pivot_curent.event_type,\n    pivot_curent.event_time,\n    pivot_curent.symbole_src,\n    pivot_curent.candle_open_time,\n    pivot_curent.candle_close_time,\n    pivot_curent.symbole,\n    pivot_curent.\"interval\",\n    pivot_curent.first_trade_id,\n    pivot_curent.last_trade_id,\n    pivot_curent.openprice,\n    pivot_curent.close_price,\n    pivot_curent.high_price,\n    pivot_curent.low_price,\n    pivot_curent.base_asset_volume,\n    pivot_curent.nb_trades,\n    pivot_curent.candle_closed,\n    pivot_curent.quote_asset_volume,\n    pivot_curent.taker_buy_base_asset_volume,\n    pivot_curent.taker_buy_quote_asset_volume,\n    pivot_curent.openprice_lag_1,\n    pivot_curent.openprice_lag_2,\n    pivot_curent.openprice_lag_3,\n    pivot_curent.openprice_lag_4,\n    pivot_curent.openprice_lag_5,\n    pivot_curent.openprice_lag_6,\n    pivot_curent.openprice_lag_7,\n    pivot_curent.openprice_lag_8,\n    pivot_curent.openprice_lag_9,\n    pivot_curent.openprice_lag_10,\n    pivot_curent.close_price_lag_1,\n    pivot_curent.close_price_lag_2,\n    pivot_curent.close_price_lag_3,\n    pivot_curent.close_price_lag_4,\n    pivot_curent.close_price_lag_5,\n    pivot_curent.close_price_lag_6,\n    pivot_curent.close_price_lag_7,\n    pivot_curent.close_price_lag_8,\n    pivot_curent.close_price_lag_9,\n    pivot_curent.close_price_lag_10,\n    pivot_curent.high_price_lag_1,\n    pivot_curent.high_price_lag_2,\n    pivot_curent.high_price_lag_3,\n    pivot_curent.high_price_lag_4,\n    pivot_curent.high_price_lag_5,\n    pivot_curent.high_price_lag_6,\n    pivot_curent.high_price_lag_7,\n    pivot_curent.high_price_lag_8,\n    pivot_curent.high_price_lag_9,\n    pivot_curent.high_price_lag_10,\n    pivot_curent.low_price_lag_1,\n    pivot_curent.low_price_lag_2,\n    pivot_curent.low_price_lag_3,\n    pivot_curent.low_price_lag_4,\n    pivot_curent.low_price_lag_5,\n    pivot_curent.low_price_lag_6,\n    pivot_curent.low_price_lag_7,\n    pivot_curent.low_price_lag_8,\n    pivot_curent.low_price_lag_9,\n    pivot_curent.low_price_lag_10,\n    pivot_curent.rank\n   FROM pivot_curent\n  WHERE pivot_curent.rank = 1\n)\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_4h_current_and_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-16T16:29:44.832232Z", "completed_at": "2024-04-16T16:29:44.832232Z"}, {"name": "execute", "started_at": "2024-04-16T16:29:44.832232Z", "completed_at": "2024-04-16T16:29:44.832232Z"}], "thread_id": "Thread-1", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history", "compiled": true, "compiled_code": "-- wizetrading.candle_5min_current_and_history source\n\n-- This is now a dbt model file, not a raw SQL query\nwith \nBTC_PERP_5m_btc_c as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_5m\"\n)\n,\nBTC_PERP_5m_btc_h as\n(\n    select * from \"aoavfbel\".\"wizetrading\".\"btc_perp_data_5m_history\"\n),\nBTC_PERP_5m_btc_c_treated as (\n    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n    stream,\n    event_type,\n    event_time,\n    symbole_src,\n    candle_open_time,\n    candle_close_time,\n    symbole,\n    \"interval\",\n    first_trade_id,\n    last_trade_id,\n    openprice,\n    close_price,\n    high_price,\n    low_price,\n    base_asset_volume,\n    nb_trades,\n    candle_closed,\n    quote_asset_volume,\n    taker_buy_base_asset_volume,\n    taker_buy_quote_asset_volume\n    FROM BTC_PERP_5m_btc_c\n      WHERE candle_closed = false\n)\n,\nBTC_PERP_5m_btc_h_treated as (\n         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,\n         stream,\n         event_type,\n         event_time,\n         symbole_src,\n         candle_open_time,\n         candle_close_time,\n         symbole,\n         \"interval\",\n         first_trade_id,\n         last_trade_id,\n         openprice,\n         close_price,\n         high_price,\n         low_price,\n         base_asset_volume,\n         nb_trades,\n         candle_closed,\n         quote_asset_volume,\n         taker_buy_base_asset_volume,\n         taker_buy_quote_asset_volume\n        FROM BTC_PERP_5m_btc_h\n)\n,\npivot_curent AS (\n         select curr.formatted_datetime,\n         curr.stream,\n         curr.event_type,\n         curr.event_time,\n         curr.symbole_src,\n         curr.candle_open_time,\n         curr.candle_close_time,\n         curr.symbole,\n         curr.\"interval\",\n         curr.first_trade_id,\n         curr.last_trade_id,\n         curr.openprice,\n         curr.close_price,\n         curr.high_price,\n         curr.low_price,\n         curr.base_asset_volume,\n         curr.nb_trades,\n         curr.candle_closed,\n         curr.quote_asset_volume,\n         curr.taker_buy_base_asset_volume,\n         curr.taker_buy_quote_asset_volume,\n         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,\n         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,\n         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,\n         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,\n         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,\n         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,\n         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,\n         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,\n         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,\n         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,\n         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,\n         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,\n         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,\n         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,\n         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,\n         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,\n         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,\n         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,\n         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,\n         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,\n         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,\n         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,\n         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,\n         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,\n         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,\n         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,\n         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,\n         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,\n         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,\n         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,\n         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,\n         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,\n         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,\n         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,\n         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,\n         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,\n         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,\n         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,\n         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,\n         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,\n         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank\n           FROM BTC_PERP_5m_btc_c_treated curr\n             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time\n          ORDER BY curr.event_time\n)\n,\nfinal as \n(\n    SELECT pivot_curent.formatted_datetime,\n    pivot_curent.stream,\n    pivot_curent.event_type,\n    pivot_curent.event_time,\n    pivot_curent.symbole_src,\n    pivot_curent.candle_open_time,\n    pivot_curent.candle_close_time,\n    pivot_curent.symbole,\n    pivot_curent.\"interval\",\n    pivot_curent.first_trade_id,\n    pivot_curent.last_trade_id,\n    pivot_curent.openprice,\n    pivot_curent.close_price,\n    pivot_curent.high_price,\n    pivot_curent.low_price,\n    pivot_curent.base_asset_volume,\n    pivot_curent.nb_trades,\n    pivot_curent.candle_closed,\n    pivot_curent.quote_asset_volume,\n    pivot_curent.taker_buy_base_asset_volume,\n    pivot_curent.taker_buy_quote_asset_volume,\n    pivot_curent.openprice_lag_1,\n    pivot_curent.openprice_lag_2,\n    pivot_curent.openprice_lag_3,\n    pivot_curent.openprice_lag_4,\n    pivot_curent.openprice_lag_5,\n    pivot_curent.openprice_lag_6,\n    pivot_curent.openprice_lag_7,\n    pivot_curent.openprice_lag_8,\n    pivot_curent.openprice_lag_9,\n    pivot_curent.openprice_lag_10,\n    pivot_curent.close_price_lag_1,\n    pivot_curent.close_price_lag_2,\n    pivot_curent.close_price_lag_3,\n    pivot_curent.close_price_lag_4,\n    pivot_curent.close_price_lag_5,\n    pivot_curent.close_price_lag_6,\n    pivot_curent.close_price_lag_7,\n    pivot_curent.close_price_lag_8,\n    pivot_curent.close_price_lag_9,\n    pivot_curent.close_price_lag_10,\n    pivot_curent.high_price_lag_1,\n    pivot_curent.high_price_lag_2,\n    pivot_curent.high_price_lag_3,\n    pivot_curent.high_price_lag_4,\n    pivot_curent.high_price_lag_5,\n    pivot_curent.high_price_lag_6,\n    pivot_curent.high_price_lag_7,\n    pivot_curent.high_price_lag_8,\n    pivot_curent.high_price_lag_9,\n    pivot_curent.high_price_lag_10,\n    pivot_curent.low_price_lag_1,\n    pivot_curent.low_price_lag_2,\n    pivot_curent.low_price_lag_3,\n    pivot_curent.low_price_lag_4,\n    pivot_curent.low_price_lag_5,\n    pivot_curent.low_price_lag_6,\n    pivot_curent.low_price_lag_7,\n    pivot_curent.low_price_lag_8,\n    pivot_curent.low_price_lag_9,\n    pivot_curent.low_price_lag_10,\n    pivot_curent.rank\n   FROM pivot_curent\n  WHERE pivot_curent.rank = 1\n)\nselect * from final", "relation_name": "\"aoavfbel\".\"wizetrading\".\"btc_perp_data_5m_current_and_history\""}], "elapsed_time": 0.8109798431396484, "args": {"profiles_dir": "C:\\Users\\alarcher\\.dbt", "favor_state": false, "which": "generate", "use_colors": true, "show_resource_report": false, "log_path": "C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs", "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "quiet": false, "partial_parse": true, "select": [], "version_check": true, "enable_legacy_logger": false, "log_format_file": "debug", "static_parser": true, "use_colors_file": true, "invocation_command": "dbt docs generate", "compile": true, "cache_selected_only": false, "defer": false, "print": true, "static": false, "write_json": true, "partial_parse_file_diff": true, "log_level": "info", "empty_catalog": false, "log_format": "default", "project_dir": "C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading", "introspect": true, "exclude": [], "macro_debugging": false, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "vars": {}, "log_level_file": "debug", "indirect_selection": "eager", "populate_cache": true, "strict_mode": false}}