[0m15:14:54.258973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272274F09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027229D472E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027229D47970>]}


============================== 15:14:54.265549 | 7d8833e7-1c67-4a21-a169-1d897c5df75e ==============================
[0m15:14:54.265549 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:14:54.266399 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:14:54.275954 [info ] [MainThread]: dbt version: 1.7.11
[0m15:14:54.275954 [info ] [MainThread]: python version: 3.8.2
[0m15:14:54.276955 [info ] [MainThread]: python path: c:\program files\python38\python.exe
[0m15:14:54.276955 [info ] [MainThread]: os info: Windows-10-10.0.19041-SP0
[0m15:14:54.355948 [info ] [MainThread]: Using profiles dir at C:\Users\alarcher\.dbt
[0m15:14:54.357045 [info ] [MainThread]: Using profiles.yml file at C:\Users\alarcher\.dbt\profiles.yml
[0m15:14:54.357948 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\dbt_project.yml
[0m15:14:54.358948 [info ] [MainThread]: adapter type: postgres
[0m15:14:54.359986 [info ] [MainThread]: adapter version: 1.7.11
[0m15:14:54.422948 [info ] [MainThread]: Configuration:
[0m15:14:54.424093 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:14:54.424093 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:14:54.424093 [info ] [MainThread]: Required dependencies:
[0m15:14:54.424093 [debug] [MainThread]: Executing "git --help"
[0m15:14:54.492937 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:14:54.493937 [debug] [MainThread]: STDERR: "b''"
[0m15:14:54.493937 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:14:54.494937 [info ] [MainThread]: Connection:
[0m15:14:54.495938 [info ] [MainThread]:   host: ella.db.elephantsql.com
[0m15:14:54.495938 [info ] [MainThread]:   port: 5432
[0m15:14:54.497051 [info ] [MainThread]:   user: aoavfbel
[0m15:14:54.497051 [info ] [MainThread]:   database: aoavfbel
[0m15:14:54.497937 [info ] [MainThread]:   schema: wizetrading
[0m15:14:54.497937 [info ] [MainThread]:   connect_timeout: 10
[0m15:14:54.497937 [info ] [MainThread]:   role: None
[0m15:14:54.498937 [info ] [MainThread]:   search_path: None
[0m15:14:54.498937 [info ] [MainThread]:   keepalives_idle: 0
[0m15:14:54.499943 [info ] [MainThread]:   sslmode: None
[0m15:14:54.499943 [info ] [MainThread]:   sslcert: None
[0m15:14:54.499943 [info ] [MainThread]:   sslkey: None
[0m15:14:54.500936 [info ] [MainThread]:   sslrootcert: None
[0m15:14:54.500936 [info ] [MainThread]:   application_name: dbt
[0m15:14:54.501946 [info ] [MainThread]:   retries: 1
[0m15:14:54.501946 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:14:54.502935 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:14:54.502935 [debug] [MainThread]: Using postgres connection "debug"
[0m15:14:54.502935 [debug] [MainThread]: On debug: select 1 as id
[0m15:14:54.503936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:54.739959 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m15:14:54.740955 [debug] [MainThread]: On debug: Close
[0m15:14:54.740955 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:14:54.741974 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:14:54.743952 [debug] [MainThread]: Command `dbt debug` succeeded at 15:14:54.742950 after 0.53 seconds
[0m15:14:54.743952 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:14:54.743952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272274F09A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027229FD8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027229CF4640>]}
[0m15:14:54.743952 [debug] [MainThread]: Flushing usage events
[0m15:56:01.315911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA041D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA2CA63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA2CA6A60>]}


============================== 15:56:01.321935 | 56db1ab9-824b-42fd-ac26-af6921ac617e ==============================
[0m15:56:01.321935 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:56:01.322547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:01.409965 [error] [MainThread]: Encountered an error:
Runtime Error
  source-paths and model-paths cannot both be defined. The `source-paths` config has been deprecated in favor of `model-paths`. Please update your `dbt_project.yml` configuration to reflect this change.

Error encountered in C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\dbt_project.yml
[0m15:56:01.412124 [debug] [MainThread]: Command `dbt run` failed at 15:56:01.412124 after 0.14 seconds
[0m15:56:01.412124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA041D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA2EC6460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AA2EC64F0>]}
[0m15:56:01.413096 [debug] [MainThread]: Flushing usage events
[0m15:56:54.102564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDDF1E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE07C94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE07C9520>]}


============================== 15:56:54.107563 | 0d1cbde8-c178-4b2e-838e-35719bd56e0d ==============================
[0m15:56:54.107563 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:56:54.108563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:54.367161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d1cbde8-c178-4b2e-838e-35719bd56e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDE823BE0>]}
[0m15:56:54.438242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d1cbde8-c178-4b2e-838e-35719bd56e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE0A55580>]}
[0m15:56:54.440243 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:56:54.458370 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:56:54.459372 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:56:54.460371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d1cbde8-c178-4b2e-838e-35719bd56e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE0B14FD0>]}
[0m15:56:55.800585 [debug] [MainThread]: 1603: static parser failed on trading_perp_btc_data\raw_data_btc_perp.sql
[0m15:56:55.804584 [error] [MainThread]: Encountered an error:
Compilation Error in model raw_data_btc_perp (models\trading_perp_btc_data\raw_data_btc_perp.sql)
  The table name (second) argument to source() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m15:56:55.807582 [debug] [MainThread]: Command `dbt run` failed at 15:56:55.806584 after 1.74 seconds
[0m15:56:55.807582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECDDF1E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE0BF00A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE0D5A0A0>]}
[0m15:56:55.808582 [debug] [MainThread]: Flushing usage events
[0m15:57:29.077735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA5DD0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA86663D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA8666A60>]}


============================== 15:57:29.082729 | 1370c4a1-af35-4385-b970-8862185cddce ==============================
[0m15:57:29.082729 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:57:29.083743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:29.271552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1370c4a1-af35-4385-b970-8862185cddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA66DBCA0>]}
[0m15:57:29.342165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1370c4a1-af35-4385-b970-8862185cddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA88CD520>]}
[0m15:57:29.343172 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:57:29.351168 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:57:29.352175 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:57:29.352175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1370c4a1-af35-4385-b970-8862185cddce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA89B4D30>]}
[0m15:57:30.042243 [debug] [MainThread]: 1603: static parser failed on trading_perp_btc_data\raw_data_btc_perp.sql
[0m15:57:30.046375 [error] [MainThread]: Encountered an error:
Compilation Error in model raw_data_btc_perp (models\trading_perp_btc_data\raw_data_btc_perp.sql)
  The table name (second) argument to source() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
[0m15:57:30.047373 [debug] [MainThread]: Command `dbt run` failed at 15:57:30.047373 after 1.01 seconds
[0m15:57:30.048373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA5DD0970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA8BBBAF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AA8BFA220>]}
[0m15:57:30.048373 [debug] [MainThread]: Flushing usage events
[0m15:58:29.364576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169860D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169AEB6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169AEB6490>]}


============================== 15:58:29.370577 | cb75ab46-ca37-4c7a-ab2a-a761a21c336c ==============================
[0m15:58:29.370577 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:58:29.371575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:58:29.601541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb75ab46-ca37-4c7a-ab2a-a761a21c336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021698F117F0>]}
[0m15:58:29.681011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb75ab46-ca37-4c7a-ab2a-a761a21c336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169AE9F730>]}
[0m15:58:29.683006 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:58:29.691153 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:58:29.691305 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:58:29.692314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cb75ab46-ca37-4c7a-ab2a-a761a21c336c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169B20B970>]}
[0m15:58:30.384222 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m15:58:30.447417 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'raw_data_btc' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m15:58:30.448444 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_wizetrading.raw_data_btc_perp' (models\trading_perp_btc_data\raw_data_btc_perp.sql) depends on a source named 'raw_data_btc.raw_data' which was not found
[0m15:58:30.449415 [debug] [MainThread]: Command `dbt run` failed at 15:58:30.449415 after 1.12 seconds
[0m15:58:30.450473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169860D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169B4A22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002169B3B9640>]}
[0m15:58:30.450473 [debug] [MainThread]: Flushing usage events
[0m15:59:16.920395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF66009D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF8E99430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF8E99490>]}


============================== 15:59:16.926389 | 5ed7a306-a544-41b1-bc0e-8ea94343a406 ==============================
[0m15:59:16.926389 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:59:16.927388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:17.130681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ed7a306-a544-41b1-bc0e-8ea94343a406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF6EF6BE0>]}
[0m15:59:17.207680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ed7a306-a544-41b1-bc0e-8ea94343a406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF8E79700>]}
[0m15:59:17.208675 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:59:17.216686 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:59:17.218685 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:59:17.218685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ed7a306-a544-41b1-bc0e-8ea94343a406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF91EB970>]}
[0m15:59:17.953363 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m15:59:18.021864 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_wizetrading.raw_data_btc_perp' (models\trading_perp_btc_data\raw_data_btc_perp.sql) depends on a source named 'raw_data_btc_perp.raw_data' which was not found
[0m15:59:18.023864 [debug] [MainThread]: Command `dbt run` failed at 15:59:18.023864 after 1.14 seconds
[0m15:59:18.024864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF66009D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF94832B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020DF9448190>]}
[0m15:59:18.024864 [debug] [MainThread]: Flushing usage events
[0m16:02:45.075471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B53CD9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B7C76430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B7C76490>]}


============================== 16:02:45.081389 | e2306ed0-e1b4-463c-a029-0a1df0775bed ==============================
[0m16:02:45.081389 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:02:45.083336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:02:45.270047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2306ed0-e1b4-463c-a029-0a1df0775bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B5CED7F0>]}
[0m16:02:45.344582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2306ed0-e1b4-463c-a029-0a1df0775bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B7C57730>]}
[0m16:02:45.344582 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:02:45.344582 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:02:45.344582 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:02:45.361019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e2306ed0-e1b4-463c-a029-0a1df0775bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B7FCB970>]}
[0m16:02:46.041943 [debug] [MainThread]: 1603: static parser failed on trading_perp_btc_data\raw_data_btc_perp.sql
[0m16:02:46.045944 [error] [MainThread]: Encountered an error:
Compilation Error in model raw_data_btc_perp (models\trading_perp_btc_data\raw_data_btc_perp.sql)
  source() takes exactly two arguments (3 given)
[0m16:02:46.046959 [debug] [MainThread]: Command `dbt run` failed at 16:02:46.046959 after 1.01 seconds
[0m16:02:46.047952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B53CD9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B81DDB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228B820D220>]}
[0m16:02:46.047952 [debug] [MainThread]: Flushing usage events
[0m16:03:06.262379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20C3F3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20EC893A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20EC89A30>]}


============================== 16:03:06.267960 | af6344c5-2966-4a2e-ac3b-6014e7f3468b ==============================
[0m16:03:06.267960 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:03:06.267960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:06.458431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af6344c5-2966-4a2e-ac3b-6014e7f3468b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20CCE94C0>]}
[0m16:03:06.530439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af6344c5-2966-4a2e-ac3b-6014e7f3468b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20ECA1E80>]}
[0m16:03:06.531438 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:03:06.538438 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:03:06.539438 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:03:06.540439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af6344c5-2966-4a2e-ac3b-6014e7f3468b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20EFD69A0>]}
[0m16:03:07.219543 [debug] [MainThread]: 1603: static parser failed on trading_perp_btc_data\raw_data_btc_perp.sql
[0m16:03:07.219543 [error] [MainThread]: Encountered an error:
Compilation Error in model raw_data_btc_perp (models\trading_perp_btc_data\raw_data_btc_perp.sql)
  source() takes exactly two arguments (3 given)
[0m16:03:07.227609 [debug] [MainThread]: Command `dbt run` failed at 16:03:07.227609 after 1.00 seconds
[0m16:03:07.227609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20C3F3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20F1A6EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C20F1A6FD0>]}
[0m16:03:07.227609 [debug] [MainThread]: Flushing usage events
[0m16:03:17.091193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E1270970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E3B093D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E3B09A60>]}


============================== 16:03:17.096192 | 1b8c2679-db28-4bb7-b79b-7da69d399dce ==============================
[0m16:03:17.096192 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:03:17.097192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:17.284728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E1B61CD0>]}
[0m16:03:17.355729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E3D7D520>]}
[0m16:03:17.356728 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:03:17.364860 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:03:17.365862 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:03:17.366860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E3E54D30>]}
[0m16:03:18.048877 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m16:03:18.155055 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m16:03:18.159108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E424EDC0>]}
[0m16:03:18.191053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E401C850>]}
[0m16:03:18.191053 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:03:18.192055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E3D02B80>]}
[0m16:03:18.193055 [info ] [MainThread]: 
[0m16:03:18.194047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:18.196048 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m16:03:18.199200 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m16:03:18.199200 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m16:03:18.199200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:18.531132 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m16:03:18.535146 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m16:03:18.538484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m16:03:18.544432 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m16:03:18.544432 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m16:03:18.544432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:18.752966 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:03:18.753970 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m16:03:18.755973 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m16:03:18.782168 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m16:03:18.783168 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m16:03:18.805759 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m16:03:18.811826 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:18.811826 [debug] [MainThread]: On master: BEGIN
[0m16:03:18.811826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:19.008759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:19.009757 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:19.009757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:19.043659 [debug] [MainThread]: SQL status: SELECT 24 in 0.0 seconds
[0m16:03:19.052647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E424FE50>]}
[0m16:03:19.053633 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:19.075530 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:19.075530 [debug] [MainThread]: On master: BEGIN
[0m16:03:19.111922 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:19.111922 [debug] [MainThread]: On master: COMMIT
[0m16:03:19.111922 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:19.111922 [debug] [MainThread]: On master: COMMIT
[0m16:03:19.141163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:19.141163 [debug] [MainThread]: On master: Close
[0m16:03:19.142162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:19.143163 [info ] [MainThread]: 
[0m16:03:19.161157 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m16:03:19.161657 [info ] [Thread-1  ]: 1 of 1 START sql view model wizetrading.raw_data_btc_perp ...................... [RUN]
[0m16:03:19.162656 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.raw_data_btc_perp'
[0m16:03:19.163157 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m16:03:19.170164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:03:19.173162 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 16:03:19.163157 => 16:03:19.173162
[0m16:03:19.173663 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m16:03:19.205684 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:03:19.207741 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:03:19.208746 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m16:03:19.208746 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:03:19.400313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:03:19.400313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:03:19.400313 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final;
  );
[0m16:03:19.431914 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: select * from final;
                            ^

[0m16:03:19.432913 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: ROLLBACK
[0m16:03:19.454333 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 16:03:19.174163 => 16:03:19.454333
[0m16:03:19.454333 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m16:03:19.477530 [debug] [Thread-1  ]: Database Error in model raw_data_btc_perp (models\trading_perp_btc_data\raw_data_btc_perp.sql)
  syntax error at or near ";"
  LINE 15: select * from final;
                              ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\raw_data_btc_perp.sql
[0m16:03:19.477530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b8c2679-db28-4bb7-b79b-7da69d399dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E444DBB0>]}
[0m16:03:19.478531 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model wizetrading.raw_data_btc_perp ............. [[31mERROR[0m in 0.32s]
[0m16:03:19.479360 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m16:03:19.480690 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:19.481757 [debug] [MainThread]: On master: BEGIN
[0m16:03:19.481757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:19.683741 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:03:19.684772 [debug] [MainThread]: On master: COMMIT
[0m16:03:19.685754 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:19.686746 [debug] [MainThread]: On master: COMMIT
[0m16:03:19.708678 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:03:19.708678 [debug] [MainThread]: On master: Close
[0m16:03:19.709687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:19.709687 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m16:03:19.710686 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m16:03:19.710686 [debug] [MainThread]: Connection 'model.dbt_wizetrading.raw_data_btc_perp' was properly closed.
[0m16:03:19.710686 [info ] [MainThread]: 
[0m16:03:19.711679 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m16:03:19.712680 [debug] [MainThread]: Command end result
[0m16:03:19.722679 [info ] [MainThread]: 
[0m16:03:19.723679 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:19.723679 [info ] [MainThread]: 
[0m16:03:19.724684 [error] [MainThread]:   Database Error in model raw_data_btc_perp (models\trading_perp_btc_data\raw_data_btc_perp.sql)
  syntax error at or near ";"
  LINE 15: select * from final;
                              ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\raw_data_btc_perp.sql
[0m16:03:19.725679 [info ] [MainThread]: 
[0m16:03:19.725679 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:19.726678 [debug] [MainThread]: Command `dbt run` failed at 16:03:19.726678 after 2.67 seconds
[0m16:03:19.727681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E1270970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E42A16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158E42A15E0>]}
[0m16:03:19.727681 [debug] [MainThread]: Flushing usage events
[0m16:05:02.264713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C6BDD970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C94923D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C9492A60>]}


============================== 16:05:02.269572 | 2899008b-ecae-4dc9-bb4b-d82dce819532 ==============================
[0m16:05:02.269572 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:05:02.270572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:02.462095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2899008b-ecae-4dc9-bb4b-d82dce819532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C74E1CD0>]}
[0m16:05:02.532306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2899008b-ecae-4dc9-bb4b-d82dce819532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C9725520>]}
[0m16:05:02.533513 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:05:02.542848 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:05:02.616851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:02.616851 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\raw_data_btc_perp.sql
[0m16:05:02.704256 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m16:05:02.721164 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m16:05:02.725165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2899008b-ecae-4dc9-bb4b-d82dce819532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C9AC4C10>]}
[0m16:05:02.740166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2899008b-ecae-4dc9-bb4b-d82dce819532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C98C22B0>]}
[0m16:05:02.741166 [info ] [MainThread]: Found 1 model, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:05:02.741166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2899008b-ecae-4dc9-bb4b-d82dce819532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C98C2400>]}
[0m16:05:02.743166 [info ] [MainThread]: 
[0m16:05:02.743166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:05:02.746110 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m16:05:02.755125 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m16:05:02.755680 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m16:05:02.755680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:02.962989 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m16:05:02.967002 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m16:05:02.970567 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m16:05:02.977579 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m16:05:02.977579 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m16:05:02.977579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:03.176585 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:05:03.177592 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m16:05:03.177592 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m16:05:03.202965 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m16:05:03.203965 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m16:05:03.225249 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m16:05:03.231249 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:03.231249 [debug] [MainThread]: On master: BEGIN
[0m16:05:03.231249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:03.420232 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:03.422321 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:03.423317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:05:03.458410 [debug] [MainThread]: SQL status: SELECT 24 in 0.0 seconds
[0m16:05:03.466422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2899008b-ecae-4dc9-bb4b-d82dce819532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C978CDF0>]}
[0m16:05:03.466933 [debug] [MainThread]: On master: ROLLBACK
[0m16:05:03.487399 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:03.488398 [debug] [MainThread]: On master: BEGIN
[0m16:05:03.530700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:03.530700 [debug] [MainThread]: On master: COMMIT
[0m16:05:03.531707 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:03.531707 [debug] [MainThread]: On master: COMMIT
[0m16:05:03.554331 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:03.555432 [debug] [MainThread]: On master: Close
[0m16:05:03.557416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:03.559422 [info ] [MainThread]: 
[0m16:05:03.570399 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m16:05:03.571343 [info ] [Thread-1  ]: 1 of 1 START sql view model wizetrading.raw_data_btc_perp ...................... [RUN]
[0m16:05:03.572344 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.raw_data_btc_perp'
[0m16:05:03.572344 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m16:05:03.579349 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:05:03.580350 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 16:05:03.573350 => 16:05:03.580350
[0m16:05:03.581360 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m16:05:03.647349 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:05:03.649351 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:05:03.649351 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m16:05:03.649351 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m16:05:03.852526 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:05:03.853974 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:05:03.854519 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m16:05:03.885371 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:05:03.893073 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:05:03.893703 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m16:05:03.916247 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:05:03.927247 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m16:05:03.927247 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:05:03.928247 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m16:05:03.956953 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:05:03.960954 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m16:05:03.964954 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:05:03.964954 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m16:05:03.988635 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:05:03.990685 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 16:05:03.581360 => 16:05:03.989669
[0m16:05:03.990685 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m16:05:03.991674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2899008b-ecae-4dc9-bb4b-d82dce819532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C9AC4EB0>]}
[0m16:05:03.991674 [info ] [Thread-1  ]: 1 of 1 OK created sql view model wizetrading.raw_data_btc_perp ................. [[32mCREATE VIEW[0m in 0.42s]
[0m16:05:03.992607 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m16:05:03.994606 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:03.994606 [debug] [MainThread]: On master: BEGIN
[0m16:05:03.994606 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:04.185084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:05:04.185084 [debug] [MainThread]: On master: COMMIT
[0m16:05:04.185084 [debug] [MainThread]: Using postgres connection "master"
[0m16:05:04.185084 [debug] [MainThread]: On master: COMMIT
[0m16:05:04.216357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:05:04.216357 [debug] [MainThread]: On master: Close
[0m16:05:04.216357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:04.216357 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m16:05:04.216357 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m16:05:04.216357 [debug] [MainThread]: Connection 'model.dbt_wizetrading.raw_data_btc_perp' was properly closed.
[0m16:05:04.216357 [info ] [MainThread]: 
[0m16:05:04.216357 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m16:05:04.216357 [debug] [MainThread]: Command end result
[0m16:05:04.231437 [info ] [MainThread]: 
[0m16:05:04.231437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:04.231437 [info ] [MainThread]: 
[0m16:05:04.238639 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:04.239449 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:04.239449 after 2.01 seconds
[0m16:05:04.240475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C6BDD970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C978CDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C99AD250>]}
[0m16:05:04.240475 [debug] [MainThread]: Flushing usage events
[0m16:53:30.108954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3128EA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF33AF6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF33AF6CD0>]}


============================== 16:53:30.114956 | 99a8ea7d-3943-43ff-9175-66d4e17a4999 ==============================
[0m16:53:30.114956 [info ] [MainThread]: Running with dbt=1.7.11
[0m16:53:30.114956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:30.310415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99a8ea7d-3943-43ff-9175-66d4e17a4999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF31B937F0>]}
[0m16:53:30.382900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99a8ea7d-3943-43ff-9175-66d4e17a4999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF33DC22B0>]}
[0m16:53:30.383994 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m16:53:30.391107 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m16:53:30.468838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:53:30.469839 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_15min.sql
[0m16:53:30.557776 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15min.sql
[0m16:53:30.574775 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m16:53:30.579776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99a8ea7d-3943-43ff-9175-66d4e17a4999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF34165250>]}
[0m16:53:30.581777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99a8ea7d-3943-43ff-9175-66d4e17a4999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF34005B80>]}
[0m16:53:30.582777 [info ] [MainThread]: Found 2 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m16:53:30.582777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a8ea7d-3943-43ff-9175-66d4e17a4999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF34005BB0>]}
[0m16:53:30.583777 [info ] [MainThread]: 
[0m16:53:30.584777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:30.587776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m16:53:30.596784 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m16:53:30.596784 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m16:53:30.596784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:30.835138 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:53:30.836137 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m16:53:30.837138 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m16:53:30.863828 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m16:53:30.864908 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m16:53:30.887622 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m16:53:30.903943 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:30.904943 [debug] [MainThread]: On master: BEGIN
[0m16:53:30.904943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:31.095831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:53:31.096844 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:31.096844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:31.131262 [debug] [MainThread]: SQL status: SELECT 25 in 0.0 seconds
[0m16:53:31.135256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99a8ea7d-3943-43ff-9175-66d4e17a4999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF33F6A1C0>]}
[0m16:53:31.135256 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:31.156376 [debug] [MainThread]: On master: Close
[0m16:53:31.157306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:53:31.158295 [info ] [MainThread]: 
[0m16:53:31.164294 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15min
[0m16:53:31.165303 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perp_data_15min'
[0m16:53:31.165303 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15min
[0m16:53:31.170698 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15min"
[0m16:53:31.170698 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15min (compile): 16:53:31.166300 => 16:53:31.170698
[0m16:53:31.170698 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15min
[0m16:53:31.170698 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15min (execute): 16:53:31.170698 => 16:53:31.170698
[0m16:53:31.170698 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15min
[0m16:53:31.170698 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m16:53:31.170698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15min, now model.dbt_wizetrading.raw_data_btc_perp)
[0m16:53:31.170698 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m16:53:31.170698 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m16:53:31.170698 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 16:53:31.170698 => 16:53:31.170698
[0m16:53:31.170698 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m16:53:31.170698 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 16:53:31.170698 => 16:53:31.170698
[0m16:53:31.170698 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m16:53:31.170698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:31.170698 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m16:53:31.170698 [debug] [MainThread]: Connection 'model.dbt_wizetrading.raw_data_btc_perp' was properly closed.
[0m16:53:31.170698 [debug] [MainThread]: Command end result
[0m16:53:31.304070 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:53:31.305046 [info ] [MainThread]: Building catalog
[0m16:53:31.307051 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m16:53:31.312988 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m16:53:31.313991 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m16:53:31.313991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:31.516483 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:53:31.517558 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m16:53:31.518554 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15min')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:53:31.544811 [debug] [ThreadPool]: SQL status: SELECT 40 in 0.0 seconds
[0m16:53:31.554893 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m16:53:31.578537 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m16:53:31.637473 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\target\catalog.json
[0m16:53:31.639709 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:53:31.639709 after 1.57 seconds
[0m16:53:31.639709 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:53:31.639709 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m16:53:31.640713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF3128EA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF33DC22B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF341961F0>]}
[0m16:53:31.640713 [debug] [MainThread]: Flushing usage events
[0m17:19:40.757920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB26941910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB291D2370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB291D2A00>]}


============================== 17:19:40.762928 | 300ba199-d377-41e8-898f-018ef3e73443 ==============================
[0m17:19:40.762928 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:19:40.764143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:19:40.951494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB27231970>]}
[0m17:19:41.021494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29443970>]}
[0m17:19:41.022494 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:19:41.029494 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:19:41.107753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:19:41.107753 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perptreated_data.sql
[0m17:19:41.107753 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m17:19:41.203664 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m17:19:41.264655 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m17:19:41.269659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29921640>]}
[0m17:19:41.317762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29830760>]}
[0m17:19:41.318767 [info ] [MainThread]: Found 3 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:19:41.318767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29830400>]}
[0m17:19:41.320767 [info ] [MainThread]: 
[0m17:19:41.320767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:41.323764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m17:19:41.331769 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m17:19:41.331769 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m17:19:41.332769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:41.543784 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m17:19:41.544783 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m17:19:41.546776 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m17:19:41.551783 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:19:41.551783 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m17:19:41.552783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:41.748103 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:19:41.748103 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:19:41.748103 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m17:19:41.773167 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m17:19:41.774105 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m17:19:41.795279 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m17:19:41.802273 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:41.802273 [debug] [MainThread]: On master: BEGIN
[0m17:19:41.803409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:42.003340 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:19:42.003340 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:42.003340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:42.035769 [debug] [MainThread]: SQL status: SELECT 25 in 0.0 seconds
[0m17:19:42.040785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29791B50>]}
[0m17:19:42.040785 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:42.063775 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:42.064804 [debug] [MainThread]: On master: BEGIN
[0m17:19:42.106756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:19:42.107822 [debug] [MainThread]: On master: COMMIT
[0m17:19:42.107822 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:42.108825 [debug] [MainThread]: On master: COMMIT
[0m17:19:42.125798 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:19:42.125798 [debug] [MainThread]: On master: Close
[0m17:19:42.125798 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:42.125798 [info ] [MainThread]: 
[0m17:19:42.125798 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15min
[0m17:19:42.125798 [info ] [Thread-1  ]: 1 of 3 START sql view model wizetrading.btc_perp_data_15min .................... [RUN]
[0m17:19:42.125798 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perp_data_15min'
[0m17:19:42.125798 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15min
[0m17:19:42.147282 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15min"
[0m17:19:42.147282 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15min (compile): 17:19:42.125798 => 17:19:42.147282
[0m17:19:42.147282 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15min
[0m17:19:42.180599 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15min"
[0m17:19:42.182608 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15min"
[0m17:19:42.182608 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15min: BEGIN
[0m17:19:42.182608 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:19:42.384621 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:19:42.384621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15min"
[0m17:19:42.385623 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15min: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15min"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15min__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m17:19:42.414006 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:19:42.421524 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15min"
[0m17:19:42.422025 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15min: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15min"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15min__dbt_tmp" rename to "btc_perp_data_15min"
[0m17:19:42.444592 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:19:42.458092 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15min: COMMIT
[0m17:19:42.459101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15min"
[0m17:19:42.460100 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15min: COMMIT
[0m17:19:42.486622 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:19:42.493014 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15min__dbt_backup"
[0m17:19:42.497168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15min"
[0m17:19:42.497707 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15min: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15min"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15min__dbt_backup" cascade
[0m17:19:42.519061 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:19:42.521060 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15min (execute): 17:19:42.147282 => 17:19:42.521060
[0m17:19:42.522062 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15min: Close
[0m17:19:42.523062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB299307F0>]}
[0m17:19:42.523062 [info ] [Thread-1  ]: 1 of 3 OK created sql view model wizetrading.btc_perp_data_15min ............... [[32mCREATE VIEW[0m in 0.40s]
[0m17:19:42.524062 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15min
[0m17:19:42.525061 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m17:19:42.525061 [info ] [Thread-1  ]: 2 of 3 START sql view model wizetrading.btc_perptreated_data ................... [RUN]
[0m17:19:42.526062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15min, now model.dbt_wizetrading.btc_perptreated_data)
[0m17:19:42.526062 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m17:19:42.529069 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:19:42.532065 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 17:19:42.527062 => 17:19:42.531062
[0m17:19:42.532065 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m17:19:42.537669 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:19:42.539184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:19:42.540182 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m17:19:42.541184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:42.739450 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:19:42.739955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:19:42.740608 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m17:19:42.767459 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:19:42.771462 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:19:42.771462 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m17:19:42.793458 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:19:42.795460 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:19:42.795460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:19:42.796459 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:19:42.823724 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:19:42.827694 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m17:19:42.829764 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:19:42.829764 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m17:19:42.851764 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:19:42.853767 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 17:19:42.532065 => 17:19:42.853767
[0m17:19:42.853767 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m17:19:42.854767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB299195B0>]}
[0m17:19:42.855766 [info ] [Thread-1  ]: 2 of 3 OK created sql view model wizetrading.btc_perptreated_data .............. [[32mCREATE VIEW[0m in 0.33s]
[0m17:19:42.856764 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m17:19:42.856764 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:19:42.856764 [info ] [Thread-1  ]: 3 of 3 START sql view model wizetrading.raw_data_btc_perp ...................... [RUN]
[0m17:19:42.857770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m17:19:42.858777 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m17:19:42.860764 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:42.863768 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 17:19:42.858777 => 17:19:42.862765
[0m17:19:42.863768 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m17:19:42.868767 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:42.871023 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:42.871523 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m17:19:42.872538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:43.054193 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:19:43.054338 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:43.054338 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m17:19:43.082588 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:19:43.086596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:43.086596 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m17:19:43.109844 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:19:43.113847 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:43.113847 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m17:19:43.136049 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:19:43.140048 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:19:43.141047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:43.141047 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:19:43.168056 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:19:43.171054 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m17:19:43.171054 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:19:43.172053 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m17:19:43.200049 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:19:43.202147 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 17:19:42.863768 => 17:19:43.202147
[0m17:19:43.202147 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m17:19:43.203112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '300ba199-d377-41e8-898f-018ef3e73443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB299197C0>]}
[0m17:19:43.204123 [info ] [Thread-1  ]: 3 of 3 OK created sql view model wizetrading.raw_data_btc_perp ................. [[32mCREATE VIEW[0m in 0.35s]
[0m17:19:43.204123 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:19:43.206048 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:43.206048 [debug] [MainThread]: On master: BEGIN
[0m17:19:43.206048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:43.412985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:19:43.414073 [debug] [MainThread]: On master: COMMIT
[0m17:19:43.414073 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:43.414073 [debug] [MainThread]: On master: COMMIT
[0m17:19:43.437202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:19:43.437202 [debug] [MainThread]: On master: Close
[0m17:19:43.438187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:43.438187 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m17:19:43.439187 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m17:19:43.439187 [debug] [MainThread]: Connection 'model.dbt_wizetrading.raw_data_btc_perp' was properly closed.
[0m17:19:43.439187 [info ] [MainThread]: 
[0m17:19:43.440409 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m17:19:43.441418 [debug] [MainThread]: Command end result
[0m17:19:43.452284 [info ] [MainThread]: 
[0m17:19:43.452284 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:43.453284 [info ] [MainThread]: 
[0m17:19:43.453284 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:19:43.454284 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:43.454284 after 2.73 seconds
[0m17:19:43.455291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB26941910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29A8E970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29A8E130>]}
[0m17:19:43.455291 [debug] [MainThread]: Flushing usage events
[0m17:37:01.467438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539ACC09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539D5694F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539D569520>]}


============================== 17:37:01.473438 | f2414cc6-2991-4e4e-8efe-017d20bcf74b ==============================
[0m17:37:01.473438 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:37:01.473438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:37:01.660649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539B5C1BE0>]}
[0m17:37:01.731634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539D7D9580>]}
[0m17:37:01.733633 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:37:01.741458 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:37:01.833913 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 5 files added, 1 files changed.
[0m17:37:01.834434 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_4h.sql
[0m17:37:01.834968 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1w.sql
[0m17:37:01.835500 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_15m.sql
[0m17:37:01.835500 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_5m.sql
[0m17:37:01.836028 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1h.sql
[0m17:37:01.836670 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m17:37:01.837200 [debug] [MainThread]: Partial parsing: deleted file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_15min.sql
[0m17:37:01.926673 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m17:37:01.940678 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m17:37:01.942678 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m17:37:01.944678 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m17:37:01.946967 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m17:37:02.025488 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_15_min' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m17:37:02.030497 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m17:37:02.040425 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m17:37:02.046540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DCAB340>]}
[0m17:37:02.063533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DA50490>]}
[0m17:37:02.063533 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:37:02.063533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539D79C070>]}
[0m17:37:02.068533 [info ] [MainThread]: 
[0m17:37:02.069535 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:37:02.072564 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m17:37:02.081205 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m17:37:02.082230 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m17:37:02.082570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:02.340296 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m17:37:02.342296 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m17:37:02.344299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m17:37:02.349298 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:37:02.349298 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m17:37:02.350296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:02.530741 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:37:02.530741 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:37:02.531749 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m17:37:02.552137 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.0 seconds
[0m17:37:02.552137 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m17:37:02.567009 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m17:37:02.584152 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:02.584152 [debug] [MainThread]: On master: BEGIN
[0m17:37:02.584152 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:02.790288 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:02.790288 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:02.791301 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:37:02.823223 [debug] [MainThread]: SQL status: SELECT 27 in 0.0 seconds
[0m17:37:02.831230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539D84C460>]}
[0m17:37:02.831230 [debug] [MainThread]: On master: ROLLBACK
[0m17:37:02.852446 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:02.852446 [debug] [MainThread]: On master: BEGIN
[0m17:37:02.899517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:02.899517 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.900593 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:02.900593 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.922522 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:02.924540 [debug] [MainThread]: On master: Close
[0m17:37:02.926536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:02.927007 [info ] [MainThread]: 
[0m17:37:02.935019 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:02.936026 [info ] [Thread-1  ]: 1 of 7 START sql view model wizetrading.btc_perptreated_data ................... [RUN]
[0m17:37:02.936026 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m17:37:02.937020 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:02.944019 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:02.946074 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 17:37:02.937020 => 17:37:02.946074
[0m17:37:02.947018 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:02.975024 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:02.978019 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:02.978019 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m17:37:02.978019 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:37:03.160668 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:03.160668 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:03.161668 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m17:37:03.187926 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:03.194001 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:03.194001 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m17:37:03.218588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:03.221596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:03.221596 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m17:37:03.244030 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:03.258055 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:37:03.259048 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:03.259048 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:37:03.286665 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:03.292666 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m17:37:03.296665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:03.296665 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m17:37:03.325661 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:03.327666 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 17:37:02.947018 => 17:37:03.327666
[0m17:37:03.328660 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m17:37:03.329659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DCFAB20>]}
[0m17:37:03.329659 [info ] [Thread-1  ]: 1 of 7 OK created sql view model wizetrading.btc_perptreated_data .............. [[32mCREATE VIEW[0m in 0.39s]
[0m17:37:03.330659 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:03.331660 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:03.332621 [info ] [Thread-1  ]: 2 of 7 START sql view model wizetrading.raw_data_btc_perp ...................... [RUN]
[0m17:37:03.334294 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m17:37:03.334294 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:03.338310 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.339321 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 17:37:03.334294 => 17:37:03.339321
[0m17:37:03.340298 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:03.345304 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.347297 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.347297 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m17:37:03.348298 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:03.539627 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:03.540627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.540627 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m17:37:03.568627 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:03.572689 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.573628 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m17:37:03.595632 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:03.598632 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.599639 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m17:37:03.621633 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:03.623633 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:37:03.624627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.624627 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:37:03.654027 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:03.654526 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m17:37:03.654526 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:03.654526 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m17:37:03.686559 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:03.688557 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 17:37:03.341305 => 17:37:03.687558
[0m17:37:03.688557 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m17:37:03.689558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DD1FF70>]}
[0m17:37:03.690570 [info ] [Thread-1  ]: 2 of 7 OK created sql view model wizetrading.raw_data_btc_perp ................. [[32mCREATE VIEW[0m in 0.36s]
[0m17:37:03.691577 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:03.691577 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:03.692655 [info ] [Thread-1  ]: 3 of 7 START sql view model wizetrading.btc_perp_data_15m ...................... [RUN]
[0m17:37:03.693558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m17:37:03.693558 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:03.696558 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:03.699203 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 17:37:03.693558 => 17:37:03.698703
[0m17:37:03.700056 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:03.705856 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:03.705856 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:03.705856 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m17:37:03.705856 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:03.891315 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:03.892364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:03.892364 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m17:37:03.920393 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:03.923479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:03.923479 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m17:37:03.946068 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:03.948069 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m17:37:03.948069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:03.949069 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m17:37:03.976070 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:03.979069 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m17:37:03.980069 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:03.981069 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m17:37:04.004102 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:04.005608 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 17:37:03.700555 => 17:37:04.005608
[0m17:37:04.006101 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m17:37:04.007100 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DDA0E20>]}
[0m17:37:04.008104 [info ] [Thread-1  ]: 3 of 7 OK created sql view model wizetrading.btc_perp_data_15m ................. [[32mCREATE VIEW[0m in 0.31s]
[0m17:37:04.008104 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:04.009105 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:04.010105 [info ] [Thread-1  ]: 4 of 7 START sql view model wizetrading.btc_perp_data_1h ....................... [RUN]
[0m17:37:04.010593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_1h)
[0m17:37:04.011120 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:04.014368 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:04.016137 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 17:37:04.011638 => 17:37:04.015620
[0m17:37:04.016656 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:04.021705 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:04.023703 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:04.024206 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m17:37:04.024709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:04.206660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:04.207661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:04.207661 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m17:37:04.235548 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:04.238553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:04.238553 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m17:37:04.260729 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:04.262799 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m17:37:04.262799 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:04.263797 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m17:37:04.290550 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:04.293611 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m17:37:04.293611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:04.294612 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m17:37:04.316563 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:04.318558 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 17:37:04.017203 => 17:37:04.318558
[0m17:37:04.318558 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m17:37:04.319550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DD41FA0>]}
[0m17:37:04.320550 [info ] [Thread-1  ]: 4 of 7 OK created sql view model wizetrading.btc_perp_data_1h .................. [[32mCREATE VIEW[0m in 0.31s]
[0m17:37:04.321551 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:04.321551 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:04.322559 [info ] [Thread-1  ]: 5 of 7 START sql view model wizetrading.btc_perp_data_1w ....................... [RUN]
[0m17:37:04.323551 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1w)
[0m17:37:04.323551 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:04.325550 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:04.327553 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 17:37:04.323551 => 17:37:04.327553
[0m17:37:04.328550 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:04.333551 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:04.334746 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:04.336332 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m17:37:04.337343 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:04.544033 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:04.544033 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:04.545044 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m17:37:04.571488 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:04.575429 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:04.576470 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m17:37:04.599758 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:04.601781 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m17:37:04.602791 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:04.602791 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m17:37:04.630979 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:04.632980 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m17:37:04.634002 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:04.634973 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m17:37:04.657979 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:04.659980 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 17:37:04.328550 => 17:37:04.659980
[0m17:37:04.659980 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m17:37:04.660979 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DD41FA0>]}
[0m17:37:04.661979 [info ] [Thread-1  ]: 5 of 7 OK created sql view model wizetrading.btc_perp_data_1w .................. [[32mCREATE VIEW[0m in 0.34s]
[0m17:37:04.661979 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:04.662982 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:04.662982 [info ] [Thread-1  ]: 6 of 7 START sql view model wizetrading.btc_perp_data_4h ....................... [RUN]
[0m17:37:04.663979 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_4h)
[0m17:37:04.663979 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:04.666974 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:04.668974 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 17:37:04.664979 => 17:37:04.668974
[0m17:37:04.669972 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:04.674981 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:04.677977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:04.677977 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m17:37:04.677977 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:04.859543 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:04.860543 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:04.861543 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m17:37:04.890446 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:04.894445 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:04.894445 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m17:37:04.917908 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:04.919991 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m17:37:04.920909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:04.920909 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m17:37:04.949966 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:04.952994 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m17:37:04.953909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:04.953909 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m17:37:04.976913 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:04.978913 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 17:37:04.669972 => 17:37:04.978913
[0m17:37:04.979913 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m17:37:04.980913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DD00310>]}
[0m17:37:04.980913 [info ] [Thread-1  ]: 6 of 7 OK created sql view model wizetrading.btc_perp_data_4h .................. [[32mCREATE VIEW[0m in 0.32s]
[0m17:37:04.981914 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:04.982908 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:04.982908 [info ] [Thread-1  ]: 7 of 7 START sql view model wizetrading.btc_perp_data_5m ....................... [RUN]
[0m17:37:04.983910 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_5m)
[0m17:37:04.984910 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:04.987915 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:04.989511 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 17:37:04.984910 => 17:37:04.989511
[0m17:37:04.990519 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:04.996522 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:04.998530 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:04.999519 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m17:37:04.999519 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:05.194315 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:05.195321 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:05.195321 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m17:37:05.226678 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:05.229670 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:05.230671 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m17:37:05.253523 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:05.255590 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m17:37:05.255590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:05.256521 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m17:37:05.283527 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:05.286528 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m17:37:05.287527 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:05.288530 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m17:37:05.311527 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:05.313527 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 17:37:04.990519 => 17:37:05.312529
[0m17:37:05.313527 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m17:37:05.314527 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2414cc6-2991-4e4e-8efe-017d20bcf74b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DD41FA0>]}
[0m17:37:05.315527 [info ] [Thread-1  ]: 7 of 7 OK created sql view model wizetrading.btc_perp_data_5m .................. [[32mCREATE VIEW[0m in 0.33s]
[0m17:37:05.315527 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:05.317521 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:05.317521 [debug] [MainThread]: On master: BEGIN
[0m17:37:05.317521 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:05.508285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:05.509373 [debug] [MainThread]: On master: COMMIT
[0m17:37:05.509373 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:05.509373 [debug] [MainThread]: On master: COMMIT
[0m17:37:05.531431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:05.532432 [debug] [MainThread]: On master: Close
[0m17:37:05.533434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:05.533434 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m17:37:05.533434 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m17:37:05.534366 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m' was properly closed.
[0m17:37:05.534366 [info ] [MainThread]: 
[0m17:37:05.535388 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m17:37:05.537367 [debug] [MainThread]: Command end result
[0m17:37:05.548361 [info ] [MainThread]: 
[0m17:37:05.549366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:05.550360 [info ] [MainThread]: 
[0m17:37:05.550360 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:37:05.551752 [debug] [MainThread]: Command `dbt run` succeeded at 17:37:05.551752 after 4.12 seconds
[0m17:37:05.552774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539ACC09D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DD41FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002539DB03580>]}
[0m17:37:05.552774 [debug] [MainThread]: Flushing usage events
[0m17:37:51.382705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E61290970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E63B263D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E63B26A60>]}


============================== 17:37:51.387759 | 3328de80-66b5-4cc3-acc0-5f6fcbceed59 ==============================
[0m17:37:51.387759 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:37:51.388784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:37:51.575113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E61B88CD0>]}
[0m17:37:51.643492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E63D99520>]}
[0m17:37:51.643492 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:37:51.654556 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:37:51.743996 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:51.744997 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m17:37:51.763994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m17:37:51.767999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E6408BFA0>]}
[0m17:37:51.783995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E6404E790>]}
[0m17:37:51.784995 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:37:51.784995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E6404E970>]}
[0m17:37:51.786995 [info ] [MainThread]: 
[0m17:37:51.788089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:37:51.790735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m17:37:51.799515 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m17:37:51.800067 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m17:37:51.800201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:52.000138 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m17:37:52.002129 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m17:37:52.004556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m17:37:52.010390 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:37:52.010390 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m17:37:52.010390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:52.187528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:37:52.188528 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:37:52.188528 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m17:37:52.214535 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m17:37:52.215535 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m17:37:52.237528 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m17:37:52.283534 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:52.284534 [debug] [MainThread]: On master: BEGIN
[0m17:37:52.284534 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:52.474816 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:52.477041 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:52.477541 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:37:52.510876 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m17:37:52.515901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E640E6F70>]}
[0m17:37:52.516901 [debug] [MainThread]: On master: ROLLBACK
[0m17:37:52.537877 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:52.538892 [debug] [MainThread]: On master: BEGIN
[0m17:37:52.583959 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:52.586029 [debug] [MainThread]: On master: COMMIT
[0m17:37:52.587037 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:52.587975 [debug] [MainThread]: On master: COMMIT
[0m17:37:52.611215 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:52.613235 [debug] [MainThread]: On master: Close
[0m17:37:52.615243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:52.616499 [info ] [MainThread]: 
[0m17:37:52.624706 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:52.625929 [info ] [Thread-1  ]: 1 of 7 START sql view model wizetrading.btc_perptreated_data ................... [RUN]
[0m17:37:52.626941 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m17:37:52.626941 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:52.628337 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:52.636804 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 17:37:52.626941 => 17:37:52.636134
[0m17:37:52.636804 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:52.665241 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:52.667303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:52.668330 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m17:37:52.668330 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:37:52.869760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:52.870760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:52.870760 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m17:37:52.899752 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:52.905759 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:52.905759 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m17:37:52.928773 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:52.931773 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:52.932773 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m17:37:52.954548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:52.969549 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:37:52.969549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:52.970550 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:37:52.999542 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:53.007733 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m17:37:53.011738 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:37:53.011738 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m17:37:53.036363 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:53.036363 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 17:37:52.636804 => 17:37:53.036363
[0m17:37:53.036363 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m17:37:53.036363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E64102400>]}
[0m17:37:53.036363 [info ] [Thread-1  ]: 1 of 7 OK created sql view model wizetrading.btc_perptreated_data .............. [[32mCREATE VIEW[0m in 0.41s]
[0m17:37:53.051444 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m17:37:53.051948 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:53.051948 [info ] [Thread-1  ]: 2 of 7 START sql view model wizetrading.raw_data_btc_perp ...................... [RUN]
[0m17:37:53.053554 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m17:37:53.053554 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:53.057649 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.059566 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 17:37:53.054567 => 17:37:53.059566
[0m17:37:53.060568 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:53.064624 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.065587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.066624 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m17:37:53.066624 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:53.251289 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:53.252313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.252313 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m17:37:53.279898 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:53.282721 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.283721 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m17:37:53.306042 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:53.308669 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.309669 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m17:37:53.331593 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:53.333594 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:37:53.333594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.334860 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:37:53.360648 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:53.363616 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m17:37:53.364613 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:37:53.364613 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m17:37:53.392614 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:53.394614 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 17:37:53.060568 => 17:37:53.394614
[0m17:37:53.395614 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m17:37:53.395614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E6413F4F0>]}
[0m17:37:53.396660 [info ] [Thread-1  ]: 2 of 7 OK created sql view model wizetrading.raw_data_btc_perp ................. [[32mCREATE VIEW[0m in 0.34s]
[0m17:37:53.397709 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:37:53.397709 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:53.398633 [info ] [Thread-1  ]: 3 of 7 START sql view model wizetrading.btc_perp_data_15m ...................... [RUN]
[0m17:37:53.399624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m17:37:53.399624 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:53.402615 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:53.404616 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 17:37:53.399624 => 17:37:53.404616
[0m17:37:53.405616 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:53.410613 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:53.413614 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:53.413614 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m17:37:53.414615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:53.596507 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:53.597505 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:53.597505 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m17:37:53.625137 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:53.629129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:53.630128 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m17:37:53.653070 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:53.655077 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m17:37:53.655077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:53.656072 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m17:37:53.683643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:53.686642 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m17:37:53.687643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:37:53.687643 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m17:37:53.709388 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:53.712391 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 17:37:53.405616 => 17:37:53.711392
[0m17:37:53.712391 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m17:37:53.713392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E6410B670>]}
[0m17:37:53.713392 [info ] [Thread-1  ]: 3 of 7 OK created sql view model wizetrading.btc_perp_data_15m ................. [[32mCREATE VIEW[0m in 0.31s]
[0m17:37:53.714392 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:37:53.714392 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:53.715392 [info ] [Thread-1  ]: 4 of 7 START sql view model wizetrading.btc_perp_data_1h ....................... [RUN]
[0m17:37:53.715392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_1h)
[0m17:37:53.716392 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:53.719392 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:53.720611 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 17:37:53.716392 => 17:37:53.720611
[0m17:37:53.721615 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:53.727451 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:53.729452 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:53.730448 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m17:37:53.730448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:53.917225 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:53.918247 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:53.918247 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m17:37:53.947166 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:53.951167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:53.952165 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m17:37:53.974650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:53.976643 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m17:37:53.976643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:53.976643 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m17:37:54.004061 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:54.007158 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m17:37:54.008157 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:37:54.008157 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m17:37:54.031083 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:54.033138 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 17:37:53.721615 => 17:37:54.032143
[0m17:37:54.033138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m17:37:54.034139 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E64141DF0>]}
[0m17:37:54.034139 [info ] [Thread-1  ]: 4 of 7 OK created sql view model wizetrading.btc_perp_data_1h .................. [[32mCREATE VIEW[0m in 0.32s]
[0m17:37:54.035081 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:37:54.036080 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:54.036080 [info ] [Thread-1  ]: 5 of 7 START sql view model wizetrading.btc_perp_data_1w ....................... [RUN]
[0m17:37:54.037081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1w)
[0m17:37:54.038081 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:54.041080 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:54.043080 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 17:37:54.038081 => 17:37:54.043080
[0m17:37:54.043080 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:54.048082 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:54.050080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:54.050080 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m17:37:54.050080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:54.240572 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:54.240572 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:54.241557 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m17:37:54.269556 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:54.273556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:54.274555 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m17:37:54.298559 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:54.300558 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m17:37:54.300558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:54.300558 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m17:37:54.326562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:54.329556 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m17:37:54.330556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:37:54.331556 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m17:37:54.353556 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:54.355559 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 17:37:54.044080 => 17:37:54.354559
[0m17:37:54.355559 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m17:37:54.356559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E6416E1F0>]}
[0m17:37:54.356559 [info ] [Thread-1  ]: 5 of 7 OK created sql view model wizetrading.btc_perp_data_1w .................. [[32mCREATE VIEW[0m in 0.32s]
[0m17:37:54.357559 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:37:54.358569 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:54.358569 [info ] [Thread-1  ]: 6 of 7 START sql view model wizetrading.btc_perp_data_4h ....................... [RUN]
[0m17:37:54.359576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_4h)
[0m17:37:54.360566 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:54.362562 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:54.364556 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 17:37:54.360566 => 17:37:54.364556
[0m17:37:54.364556 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:54.368556 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:54.370566 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:54.370566 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m17:37:54.371556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:54.565888 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:54.565888 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:54.565888 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m17:37:54.595039 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:54.599038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:54.600039 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m17:37:54.621118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:54.623167 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m17:37:54.623167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:54.624157 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m17:37:54.651938 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:54.655493 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m17:37:54.656492 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:37:54.656492 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m17:37:54.679563 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:54.681492 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 17:37:54.365560 => 17:37:54.680497
[0m17:37:54.681492 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m17:37:54.682492 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E641DF6D0>]}
[0m17:37:54.682492 [info ] [Thread-1  ]: 6 of 7 OK created sql view model wizetrading.btc_perp_data_4h .................. [[32mCREATE VIEW[0m in 0.32s]
[0m17:37:54.683485 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:37:54.683485 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:54.684497 [info ] [Thread-1  ]: 7 of 7 START sql view model wizetrading.btc_perp_data_5m ....................... [RUN]
[0m17:37:54.685495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_5m)
[0m17:37:54.685495 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:54.687492 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:54.690485 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 17:37:54.685495 => 17:37:54.689490
[0m17:37:54.690485 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:54.694493 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:54.695493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:54.696488 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m17:37:54.696488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:37:54.887314 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:37:54.887933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:54.888966 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m17:37:54.915956 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:37:54.918963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:54.918963 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m17:37:54.941965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:37:54.942964 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m17:37:54.943963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:54.943963 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m17:37:54.969957 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:37:54.973949 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m17:37:54.974950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:37:54.975950 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m17:37:54.998291 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:37:54.999305 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 17:37:54.690485 => 17:37:54.999305
[0m17:37:55.000294 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m17:37:55.001307 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3328de80-66b5-4cc3-acc0-5f6fcbceed59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E6416ABB0>]}
[0m17:37:55.001307 [info ] [Thread-1  ]: 7 of 7 OK created sql view model wizetrading.btc_perp_data_5m .................. [[32mCREATE VIEW[0m in 0.32s]
[0m17:37:55.002233 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:37:55.004233 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:55.004233 [debug] [MainThread]: On master: BEGIN
[0m17:37:55.005242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:55.189377 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:37:55.190381 [debug] [MainThread]: On master: COMMIT
[0m17:37:55.191370 [debug] [MainThread]: Using postgres connection "master"
[0m17:37:55.192383 [debug] [MainThread]: On master: COMMIT
[0m17:37:55.205118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:37:55.205118 [debug] [MainThread]: On master: Close
[0m17:37:55.205118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:55.205118 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m17:37:55.205118 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m17:37:55.205118 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m' was properly closed.
[0m17:37:55.205118 [info ] [MainThread]: 
[0m17:37:55.205118 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 3.42 seconds (3.42s).
[0m17:37:55.205118 [debug] [MainThread]: Command end result
[0m17:37:55.228866 [info ] [MainThread]: 
[0m17:37:55.229867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:55.230866 [info ] [MainThread]: 
[0m17:37:55.231866 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:37:55.232867 [debug] [MainThread]: Command `dbt run` succeeded at 17:37:55.232867 after 3.88 seconds
[0m17:37:55.232867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E61290970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E64043910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E640F8040>]}
[0m17:37:55.233867 [debug] [MainThread]: Flushing usage events
[0m17:38:42.895158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B52B5E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5540A580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5540AC10>]}


============================== 17:38:42.895158 | 5090b84a-1ccf-4ebf-bb2b-5bfb5ed44958 ==============================
[0m17:38:42.895158 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:38:42.895158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:43.092782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5090b84a-1ccf-4ebf-bb2b-5bfb5ed44958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B534615B0>]}
[0m17:38:43.165183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5090b84a-1ccf-4ebf-bb2b-5bfb5ed44958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B55692280>]}
[0m17:38:43.166214 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:38:43.173076 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:38:43.257101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:43.257101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:43.258100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m17:38:43.264100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5090b84a-1ccf-4ebf-bb2b-5bfb5ed44958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B55969AC0>]}
[0m17:38:43.268107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5090b84a-1ccf-4ebf-bb2b-5bfb5ed44958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5592C8E0>]}
[0m17:38:43.269104 [info ] [MainThread]: Found 7 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:38:43.270095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5090b84a-1ccf-4ebf-bb2b-5bfb5ed44958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5592C5E0>]}
[0m17:38:43.272101 [info ] [MainThread]: 
[0m17:38:43.273110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:43.276095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m17:38:43.277421 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:38:43.277421 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m17:38:43.277421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:43.494320 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:38:43.495331 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:38:43.495331 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m17:38:43.521566 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m17:38:43.522509 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m17:38:43.544138 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m17:38:43.555481 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:43.556488 [debug] [MainThread]: On master: BEGIN
[0m17:38:43.556488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:43.743651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:38:43.744648 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:43.744648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:43.776547 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m17:38:43.776547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5090b84a-1ccf-4ebf-bb2b-5bfb5ed44958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5592C460>]}
[0m17:38:43.776547 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:43.805590 [debug] [MainThread]: On master: Close
[0m17:38:43.807589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:43.808586 [info ] [MainThread]: 
[0m17:38:43.816584 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m17:38:43.817592 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m17:38:43.817592 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m17:38:43.825652 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:38:43.827651 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 17:38:43.817592 => 17:38:43.827651
[0m17:38:43.828657 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m17:38:43.828657 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 17:38:43.828657 => 17:38:43.828657
[0m17:38:43.830663 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m17:38:43.830663 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:38:43.831653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m17:38:43.831653 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m17:38:43.835650 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:38:43.837650 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 17:38:43.832660 => 17:38:43.836650
[0m17:38:43.837650 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m17:38:43.838653 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 17:38:43.837650 => 17:38:43.837650
[0m17:38:43.839651 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:38:43.839651 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:38:43.840655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m17:38:43.840655 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m17:38:43.843664 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:38:43.845654 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 17:38:43.840655 => 17:38:43.845654
[0m17:38:43.846657 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m17:38:43.846657 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 17:38:43.846657 => 17:38:43.846657
[0m17:38:43.848653 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:38:43.848653 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:38:43.849651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_1h)
[0m17:38:43.850660 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m17:38:43.852657 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:38:43.855651 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 17:38:43.850660 => 17:38:43.854651
[0m17:38:43.855651 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m17:38:43.856651 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 17:38:43.856651 => 17:38:43.856651
[0m17:38:43.857652 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:38:43.857652 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:38:43.858675 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1w)
[0m17:38:43.859701 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m17:38:43.861697 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:38:43.863692 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 17:38:43.859701 => 17:38:43.863692
[0m17:38:43.863692 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m17:38:43.864692 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 17:38:43.864692 => 17:38:43.864692
[0m17:38:43.865691 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:38:43.865691 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:38:43.866693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_4h)
[0m17:38:43.866693 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m17:38:43.869697 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:38:43.870692 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 17:38:43.866693 => 17:38:43.870692
[0m17:38:43.871693 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m17:38:43.871693 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 17:38:43.871693 => 17:38:43.871693
[0m17:38:43.872693 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:38:43.873693 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:38:43.874693 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_5m)
[0m17:38:43.874693 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m17:38:43.877699 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:38:43.878691 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 17:38:43.874693 => 17:38:43.878691
[0m17:38:43.879694 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m17:38:43.879694 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 17:38:43.879694 => 17:38:43.879694
[0m17:38:43.880694 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:38:43.881694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:43.881694 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m17:38:43.881694 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m' was properly closed.
[0m17:38:43.883698 [debug] [MainThread]: Command end result
[0m17:38:43.923994 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:38:43.923994 [info ] [MainThread]: Building catalog
[0m17:38:43.938895 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m17:38:43.938895 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m17:38:43.938895 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m17:38:43.938895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:44.145588 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:38:44.146588 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m17:38:44.146588 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perptreated_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:38:44.197081 [debug] [ThreadPool]: SQL status: SELECT 160 in 0.0 seconds
[0m17:38:44.206866 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m17:38:44.228530 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m17:38:44.250744 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\target\catalog.json
[0m17:38:44.252798 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:38:44.252798 after 1.39 seconds
[0m17:38:44.252798 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:38:44.254057 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m17:38:44.254057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B52B5E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B534615B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B55692280>]}
[0m17:38:44.255054 [debug] [MainThread]: Flushing usage events
[0m17:52:53.086668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D886C10970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8894A63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8894A6A60>]}


============================== 17:52:53.092668 | 9115714c-73ea-428b-a458-e37b3d93a3f1 ==============================
[0m17:52:53.092668 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:52:53.093668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:53.282608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9115714c-73ea-428b-a458-e37b3d93a3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D887501CD0>]}
[0m17:52:53.354604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9115714c-73ea-428b-a458-e37b3d93a3f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D88973E520>]}
[0m17:52:53.355603 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:52:53.365601 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:52:53.399465 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_wizetrading: trading_perp_btc_data\schema.yml - Runtime Error
    Syntax error near line 374
    ------------------------------
    371|         description: "volume acheteur maker"
    372| 
    373| 
    374|     - name: btc_perp_data_1d_history
    375|     description: "Filtered btc_perptreated_data for 1-day interval historical data"
    376|     materialized: table
    377|     columns:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 328, column 5
    did not find expected key
      in "<unicode string>", line 374, column 5
[0m17:52:53.403474 [debug] [MainThread]: Command `dbt run` failed at 17:52:53.403474 after 0.35 seconds
[0m17:52:53.404471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D886C10970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8899C2EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8899C2E50>]}
[0m17:52:53.404471 [debug] [MainThread]: Flushing usage events
[0m17:54:52.415253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB7520970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB9DB13D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB9DB1A60>]}


============================== 17:54:52.421254 | 41dd45a1-0db6-4bd2-ad7a-6fef9e99d540 ==============================
[0m17:54:52.421254 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:54:52.422254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:52.606478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB7E10CD0>]}
[0m17:54:52.663673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA01D520>]}
[0m17:54:52.663673 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:54:52.679347 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:54:52.769549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m17:54:52.770549 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m17:54:52.770549 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m17:54:52.771549 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m17:54:52.771549 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m17:54:52.771549 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m17:54:52.773549 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m17:54:52.856016 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m17:54:52.874138 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m17:54:52.876236 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m17:54:52.876236 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m17:54:52.876236 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m17:54:52.967680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m17:54:52.975780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA53FB50>]}
[0m17:54:52.996111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA2DAAC0>]}
[0m17:54:52.996111 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:54:52.996111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA2DACA0>]}
[0m17:54:52.996111 [info ] [MainThread]: 
[0m17:54:53.000378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:54:53.003007 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m17:54:53.006025 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m17:54:53.006025 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m17:54:53.006025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:53.251228 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m17:54:53.253049 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m17:54:53.256052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m17:54:53.261734 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:54:53.262236 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m17:54:53.262236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:53.447965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:54:53.447965 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:54:53.448971 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m17:54:53.474242 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.0 seconds
[0m17:54:53.475248 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m17:54:53.497446 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m17:54:53.506925 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:53.506925 [debug] [MainThread]: On master: BEGIN
[0m17:54:53.507932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:53.687045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:53.688126 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:53.690128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:54:53.724512 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m17:54:53.734684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB9FB2CA0>]}
[0m17:54:53.734684 [debug] [MainThread]: On master: ROLLBACK
[0m17:54:53.763692 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:53.764674 [debug] [MainThread]: On master: BEGIN
[0m17:54:53.810228 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:53.811224 [debug] [MainThread]: On master: COMMIT
[0m17:54:53.812244 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:53.813238 [debug] [MainThread]: On master: COMMIT
[0m17:54:53.835391 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:54:53.835391 [debug] [MainThread]: On master: Close
[0m17:54:53.836385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:54:53.838326 [info ] [MainThread]: 
[0m17:54:53.846332 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m17:54:53.847325 [info ] [Thread-1  ]: 1 of 12 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m17:54:53.849327 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m17:54:53.849327 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m17:54:53.856333 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:53.858341 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 17:54:53.849327 => 17:54:53.858341
[0m17:54:53.859327 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m17:54:53.889551 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:53.891544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:53.892546 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m17:54:53.892546 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m17:54:54.091655 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:54.092183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:54.092779 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m17:54:54.119293 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:54.126294 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:54.126294 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m17:54:54.150090 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:54.153857 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:54.154703 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m17:54:54.177924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:54.195707 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:54:54.196218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:54.196218 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m17:54:54.225051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:54.232231 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m17:54:54.236230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m17:54:54.237231 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m17:54:54.270762 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:54.273310 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 17:54:53.859327 => 17:54:54.273310
[0m17:54:54.273626 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m17:54:54.274526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA6F18B0>]}
[0m17:54:54.275027 [info ] [Thread-1  ]: 1 of 12 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.43s]
[0m17:54:54.276491 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m17:54:54.277272 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:54:54.278563 [info ] [Thread-1  ]: 2 of 12 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m17:54:54.279065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m17:54:54.279065 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m17:54:54.281736 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.283746 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 17:54:54.280078 => 17:54:54.283746
[0m17:54:54.284745 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m17:54:54.289276 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.291277 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.292277 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m17:54:54.292277 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:54.502175 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:54.502175 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.503170 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m17:54:54.530291 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:54.534297 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.535211 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m17:54:54.557945 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:54.561945 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.561945 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m17:54:54.583945 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:54.587944 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:54:54.587944 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.588947 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m17:54:54.616696 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:54.622355 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m17:54:54.623356 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:54:54.624370 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m17:54:54.652990 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:54.654990 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 17:54:54.284745 => 17:54:54.654990
[0m17:54:54.655990 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m17:54:54.656990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA5DE400>]}
[0m17:54:54.656990 [info ] [Thread-1  ]: 2 of 12 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.38s]
[0m17:54:54.658004 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:54:54.658995 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:54:54.658995 [info ] [Thread-1  ]: 3 of 12 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m17:54:54.659992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m17:54:54.660991 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m17:54:54.663991 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:54:54.666989 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 17:54:54.660991 => 17:54:54.665989
[0m17:54:54.666989 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m17:54:54.672734 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:54:54.675293 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:54:54.675793 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m17:54:54.676293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:54.872615 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:54.872615 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:54:54.872615 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m17:54:54.902793 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:54.902793 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:54:54.902793 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m17:54:54.931163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:54.933232 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m17:54:54.934397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:54:54.934397 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m17:54:54.964245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:54.967825 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m17:54:54.968119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:54:54.969132 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m17:54:54.992057 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:54.994053 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 17:54:54.666989 => 17:54:54.993054
[0m17:54:54.994053 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m17:54:54.995053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA521D30>]}
[0m17:54:54.996053 [info ] [Thread-1  ]: 3 of 12 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.34s]
[0m17:54:54.997051 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:54:54.997051 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:54:54.997751 [info ] [Thread-1  ]: 4 of 12 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m17:54:54.998973 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m17:54:54.999499 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:54:55.003210 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:54:55.005013 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 17:54:54.999837 => 17:54:55.005013
[0m17:54:55.006584 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:54:55.010884 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:54:55.013884 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:54:55.013884 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m17:54:55.014884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:55.196985 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:55.196985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:54:55.197985 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m17:54:55.223954 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:55.228955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:54:55.229954 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m17:54:55.253192 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:55.255198 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m17:54:55.256190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:54:55.256190 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m17:54:55.282776 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:55.287354 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m17:54:55.289207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:54:55.290198 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m17:54:55.311975 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:55.314915 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 17:54:55.006875 => 17:54:55.314017
[0m17:54:55.314915 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m17:54:55.315919 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA63A610>]}
[0m17:54:55.316917 [info ] [Thread-1  ]: 4 of 12 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m17:54:55.318553 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:54:55.319643 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:54:55.319680 [info ] [Thread-1  ]: 5 of 12 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m17:54:55.320769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m17:54:55.321769 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m17:54:55.324807 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:54:55.326768 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 17:54:55.321769 => 17:54:55.326768
[0m17:54:55.327769 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m17:54:55.333695 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:54:55.335724 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:54:55.336734 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m17:54:55.337751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:55.518392 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:55.519070 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:54:55.519070 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m17:54:55.545638 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:55.548629 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:54:55.549629 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m17:54:55.571813 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:55.573754 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m17:54:55.573754 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:54:55.574754 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m17:54:55.602481 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:55.607315 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m17:54:55.608313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:54:55.609313 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m17:54:55.631387 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:55.633544 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 17:54:55.327769 => 17:54:55.633544
[0m17:54:55.634543 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m17:54:55.635542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA640C70>]}
[0m17:54:55.635542 [info ] [Thread-1  ]: 5 of 12 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.31s]
[0m17:54:55.637542 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:54:55.637542 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:54:55.638553 [info ] [Thread-1  ]: 6 of 12 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m17:54:55.639542 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m17:54:55.640542 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:54:55.646541 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:54:55.648542 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 17:54:55.641542 => 17:54:55.648542
[0m17:54:55.649544 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:54:55.655543 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:54:55.658549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:54:55.659545 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m17:54:55.660543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:55.842954 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:55.843963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:54:55.843963 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m17:54:55.871954 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:55.875954 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:54:55.876955 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m17:54:55.899288 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:55.901789 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m17:54:55.902789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:54:55.902789 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m17:54:55.929788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:55.932788 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m17:54:55.933789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:54:55.934789 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m17:54:55.959647 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:55.961089 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 17:54:55.650544 => 17:54:55.961089
[0m17:54:55.962625 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m17:54:55.964234 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA6403D0>]}
[0m17:54:55.965395 [info ] [Thread-1  ]: 6 of 12 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.32s]
[0m17:54:55.966677 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:54:55.967445 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:54:55.968624 [info ] [Thread-1  ]: 7 of 12 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m17:54:55.969544 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m17:54:55.969544 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m17:54:55.973494 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:54:55.975492 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 17:54:55.970742 => 17:54:55.975492
[0m17:54:55.976492 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m17:54:55.982007 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:54:55.984999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:54:55.986118 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m17:54:55.986619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:56.193841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:56.194853 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:54:56.194853 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m17:54:56.222538 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:56.227305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:54:56.227815 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m17:54:56.250097 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:56.253126 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m17:54:56.253625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:54:56.254364 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m17:54:56.275895 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:56.287658 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m17:54:56.288882 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:54:56.288882 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m17:54:56.312992 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:56.315707 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 17:54:55.976492 => 17:54:56.315178
[0m17:54:56.316239 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m17:54:56.317851 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA6403D0>]}
[0m17:54:56.318393 [info ] [Thread-1  ]: 7 of 12 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.35s]
[0m17:54:56.319981 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:54:56.320529 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:54:56.321056 [info ] [Thread-1  ]: 8 of 12 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m17:54:56.322657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m17:54:56.323226 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:54:56.326346 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:54:56.328438 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 17:54:56.323226 => 17:54:56.327908
[0m17:54:56.328958 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:54:56.334743 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:54:56.336859 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:54:56.337909 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m17:54:56.338067 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:56.531259 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:56.532195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:54:56.532195 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m17:54:56.559193 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:56.564192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:54:56.564192 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m17:54:56.586982 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:56.589517 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m17:54:56.590519 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:54:56.592550 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m17:54:56.618270 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:56.622255 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m17:54:56.622255 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:54:56.623263 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m17:54:56.647020 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:56.650092 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 17:54:56.329478 => 17:54:56.649521
[0m17:54:56.650591 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m17:54:56.651690 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA63A610>]}
[0m17:54:56.652912 [info ] [Thread-1  ]: 8 of 12 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.33s]
[0m17:54:56.654411 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:54:56.655412 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:54:56.656572 [info ] [Thread-1  ]: 9 of 12 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m17:54:56.658094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m17:54:56.658802 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m17:54:56.664767 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:54:56.667874 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 17:54:56.659302 => 17:54:56.666804
[0m17:54:56.668375 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m17:54:56.678424 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:54:56.681428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:54:56.682599 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m17:54:56.683098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:56.866074 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:56.867085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:54:56.867085 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m17:54:56.894082 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:56.898080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:54:56.898080 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m17:54:56.920074 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:56.921079 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m17:54:56.922079 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:54:56.922079 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m17:54:56.950890 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:56.957482 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m17:54:56.958505 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:54:56.959507 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m17:54:56.981904 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:56.983896 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 17:54:56.669357 => 17:54:56.983896
[0m17:54:56.983896 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m17:54:56.984902 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA5C87C0>]}
[0m17:54:56.985903 [info ] [Thread-1  ]: 9 of 12 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.33s]
[0m17:54:56.986902 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:54:56.986902 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:54:56.987905 [info ] [Thread-1  ]: 10 of 12 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m17:54:56.988896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m17:54:56.989897 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:54:56.992897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:54:56.995448 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 17:54:56.989897 => 17:54:56.995358
[0m17:54:56.995950 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:54:57.001642 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:54:57.004133 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:54:57.004711 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m17:54:57.005276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:57.201087 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:57.201087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:54:57.202082 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m17:54:57.225420 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:57.225420 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:54:57.225420 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m17:54:57.254748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:57.254748 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m17:54:57.254748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:54:57.254748 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m17:54:57.287470 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:57.290486 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m17:54:57.291553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:54:57.292550 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m17:54:57.314494 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:57.316490 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 17:54:56.995950 => 17:54:57.316490
[0m17:54:57.316490 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m17:54:57.317490 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA718DF0>]}
[0m17:54:57.318490 [info ] [Thread-1  ]: 10 of 12 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m17:54:57.319493 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:54:57.320496 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:54:57.321495 [info ] [Thread-1  ]: 11 of 12 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m17:54:57.322483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m17:54:57.322483 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m17:54:57.326599 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:54:57.329351 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 17:54:57.323490 => 17:54:57.328746
[0m17:54:57.329855 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m17:54:57.335790 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:54:57.336961 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:54:57.337977 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m17:54:57.339105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:57.526042 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:57.527040 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:54:57.527040 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m17:54:57.557757 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:57.561752 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:54:57.561752 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m17:54:57.586743 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:57.589087 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m17:54:57.589087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:54:57.589087 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m17:54:57.616646 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:57.620641 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m17:54:57.621640 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:54:57.622641 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m17:54:57.645316 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:57.648309 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 17:54:57.330871 => 17:54:57.647309
[0m17:54:57.648309 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m17:54:57.649309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA50A9D0>]}
[0m17:54:57.650482 [info ] [Thread-1  ]: 11 of 12 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.33s]
[0m17:54:57.651982 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:54:57.652982 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:54:57.654012 [info ] [Thread-1  ]: 12 of 12 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m17:54:57.654733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m17:54:57.655763 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:54:57.658843 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:54:57.661794 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 17:54:57.655763 => 17:54:57.660764
[0m17:54:57.662296 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:54:57.670460 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:54:57.673252 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:54:57.674627 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m17:54:57.675126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:54:57.857587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m17:54:57.858588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:54:57.858588 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m17:54:57.885954 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:54:57.890956 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:54:57.891957 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m17:54:57.914018 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:54:57.915956 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m17:54:57.916956 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:54:57.916956 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m17:54:57.945958 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m17:54:57.948960 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m17:54:57.949954 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:54:57.949954 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m17:54:57.972954 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m17:54:57.974955 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 17:54:57.662873 => 17:54:57.973955
[0m17:54:57.974955 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m17:54:57.975955 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41dd45a1-0db6-4bd2-ad7a-6fef9e99d540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA63A790>]}
[0m17:54:57.976953 [info ] [Thread-1  ]: 12 of 12 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m17:54:57.977954 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:54:57.979963 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:57.979963 [debug] [MainThread]: On master: BEGIN
[0m17:54:57.979963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:58.177291 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:54:58.178046 [debug] [MainThread]: On master: COMMIT
[0m17:54:58.178545 [debug] [MainThread]: Using postgres connection "master"
[0m17:54:58.179045 [debug] [MainThread]: On master: COMMIT
[0m17:54:58.200800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:54:58.201800 [debug] [MainThread]: On master: Close
[0m17:54:58.202800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:58.203799 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m17:54:58.203799 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m17:54:58.204816 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_history' was properly closed.
[0m17:54:58.205619 [info ] [MainThread]: 
[0m17:54:58.206510 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 5.20 seconds (5.20s).
[0m17:54:58.209024 [debug] [MainThread]: Command end result
[0m17:54:58.225874 [info ] [MainThread]: 
[0m17:54:58.227394 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:54:58.227394 [info ] [MainThread]: 
[0m17:54:58.228395 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m17:54:58.229394 [debug] [MainThread]: Command `dbt run` succeeded at 17:54:58.229394 after 5.85 seconds
[0m17:54:58.230395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB7520970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA6242B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBA2DACA0>]}
[0m17:54:58.231395 [debug] [MainThread]: Flushing usage events
[0m17:55:11.426719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD34C21970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD374BAD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD374BAB50>]}


============================== 17:55:11.432218 | 07f1bd8b-a95f-4217-9fc7-ada0048a3a08 ==============================
[0m17:55:11.432218 [info ] [MainThread]: Running with dbt=1.7.11
[0m17:55:11.433213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:55:11.625190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07f1bd8b-a95f-4217-9fc7-ada0048a3a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3747D910>]}
[0m17:55:11.699706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07f1bd8b-a95f-4217-9fc7-ada0048a3a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD37821BE0>]}
[0m17:55:11.701433 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m17:55:11.704655 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m17:55:11.795305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:11.795305 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:11.796324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m17:55:11.802692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f1bd8b-a95f-4217-9fc7-ada0048a3a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD37A58640>]}
[0m17:55:11.802692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f1bd8b-a95f-4217-9fc7-ada0048a3a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD37931430>]}
[0m17:55:11.802692 [info ] [MainThread]: Found 12 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:55:11.802692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f1bd8b-a95f-4217-9fc7-ada0048a3a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD37A07C40>]}
[0m17:55:11.802692 [info ] [MainThread]: 
[0m17:55:11.802692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:55:11.813583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m17:55:11.813583 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:55:11.813583 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m17:55:11.813583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:12.059315 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:55:12.059815 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m17:55:12.060827 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m17:55:12.087062 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.0 seconds
[0m17:55:12.089052 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m17:55:12.110060 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m17:55:12.121060 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:12.121060 [debug] [MainThread]: On master: BEGIN
[0m17:55:12.122052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:12.302156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:55:12.302409 [debug] [MainThread]: Using postgres connection "master"
[0m17:55:12.303436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:55:12.336661 [debug] [MainThread]: SQL status: SELECT 37 in 0.0 seconds
[0m17:55:12.346090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f1bd8b-a95f-4217-9fc7-ada0048a3a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD37A07E50>]}
[0m17:55:12.346090 [debug] [MainThread]: On master: ROLLBACK
[0m17:55:12.368788 [debug] [MainThread]: On master: Close
[0m17:55:12.369795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:55:12.370787 [info ] [MainThread]: 
[0m17:55:12.380427 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m17:55:12.381927 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m17:55:12.383495 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m17:55:12.396545 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m17:55:12.399740 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 17:55:12.384146 => 17:55:12.399240
[0m17:55:12.400742 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m17:55:12.401871 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 17:55:12.401375 => 17:55:12.401375
[0m17:55:12.403371 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m17:55:12.404372 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:55:12.405499 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m17:55:12.406501 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m17:55:12.410733 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m17:55:12.414581 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 17:55:12.406714 => 17:55:12.414080
[0m17:55:12.415581 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m17:55:12.416080 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 17:55:12.416080 => 17:55:12.416080
[0m17:55:12.418125 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m17:55:12.419127 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:55:12.420153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m17:55:12.420153 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m17:55:12.423200 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m17:55:12.433196 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 17:55:12.420153 => 17:55:12.432147
[0m17:55:12.434195 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m17:55:12.434195 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 17:55:12.434195 => 17:55:12.434195
[0m17:55:12.435679 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m17:55:12.436678 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:55:12.437678 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m17:55:12.438678 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:55:12.441677 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m17:55:12.444262 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 17:55:12.438678 => 17:55:12.443763
[0m17:55:12.444262 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:55:12.445275 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 17:55:12.444262 => 17:55:12.444262
[0m17:55:12.446285 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m17:55:12.446285 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:55:12.447275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m17:55:12.447275 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m17:55:12.451280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m17:55:12.452274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 17:55:12.448276 => 17:55:12.452274
[0m17:55:12.452274 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m17:55:12.453275 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 17:55:12.453275 => 17:55:12.453275
[0m17:55:12.455275 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m17:55:12.455275 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:55:12.456274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m17:55:12.456274 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:55:12.492273 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m17:55:12.494282 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 17:55:12.456274 => 17:55:12.494282
[0m17:55:12.495274 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:55:12.495274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 17:55:12.495274 => 17:55:12.495274
[0m17:55:12.496281 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m17:55:12.496281 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:55:12.497275 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m17:55:12.497275 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m17:55:12.500274 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m17:55:12.501275 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 17:55:12.498282 => 17:55:12.501275
[0m17:55:12.502274 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m17:55:12.502274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 17:55:12.502274 => 17:55:12.502274
[0m17:55:12.503274 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m17:55:12.503274 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:55:12.504274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m17:55:12.504274 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:55:12.507280 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m17:55:12.509275 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 17:55:12.505273 => 17:55:12.508278
[0m17:55:12.509275 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:55:12.509275 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 17:55:12.509275 => 17:55:12.509275
[0m17:55:12.510284 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m17:55:12.511274 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:55:12.511274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m17:55:12.512273 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m17:55:12.514274 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m17:55:12.515274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 17:55:12.512273 => 17:55:12.515274
[0m17:55:12.516273 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m17:55:12.516273 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 17:55:12.516273 => 17:55:12.516273
[0m17:55:12.517274 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m17:55:12.517274 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:55:12.518273 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m17:55:12.518273 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:55:12.521281 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m17:55:12.522273 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 17:55:12.518273 => 17:55:12.522273
[0m17:55:12.522273 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:55:12.523274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 17:55:12.522273 => 17:55:12.522273
[0m17:55:12.523274 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m17:55:12.524281 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:55:12.524281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m17:55:12.525275 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m17:55:12.527275 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m17:55:12.529274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 17:55:12.525275 => 17:55:12.528274
[0m17:55:12.529274 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m17:55:12.529274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 17:55:12.529274 => 17:55:12.529274
[0m17:55:12.530286 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m17:55:12.530286 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:55:12.531274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m17:55:12.531274 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:55:12.534275 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m17:55:12.535275 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 17:55:12.532274 => 17:55:12.535275
[0m17:55:12.536273 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:55:12.536273 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 17:55:12.536273 => 17:55:12.536273
[0m17:55:12.537282 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m17:55:12.538275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:12.538275 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m17:55:12.539284 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_history' was properly closed.
[0m17:55:12.540280 [debug] [MainThread]: Command end result
[0m17:55:12.558499 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:55:12.558499 [info ] [MainThread]: Building catalog
[0m17:55:12.562252 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m17:55:12.568268 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m17:55:12.568268 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m17:55:12.568268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:12.781018 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:55:12.781018 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m17:55:12.782036 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perptreated_data')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:55:12.839029 [debug] [ThreadPool]: SQL status: SELECT 260 in 0.0 seconds
[0m17:55:12.856249 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m17:55:12.879364 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m17:55:12.916313 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\target\catalog.json
[0m17:55:12.919527 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:55:12.919527 after 1.53 seconds
[0m17:55:12.920033 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:55:12.920033 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m17:55:12.921052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD34C21970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD377AC1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD377E9040>]}
[0m17:55:12.921052 [debug] [MainThread]: Flushing usage events
[0m18:11:35.788548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A190DE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1B976340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1B9769D0>]}


============================== 18:11:35.794548 | 11d6e3ff-a9d3-4bb4-b465-55d6258888bf ==============================
[0m18:11:35.794548 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:11:35.795043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:11:35.979264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A199E7BB0>]}
[0m18:11:36.038960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1BC06940>]}
[0m18:11:36.038960 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m18:11:36.054579 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:11:36.154990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:11:36.155557 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:11:36.156627 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m18:11:36.249173 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:11:36.337322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m18:11:36.344325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1BDDA760>]}
[0m18:11:36.361023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1BEC6B20>]}
[0m18:11:36.361023 [info ] [MainThread]: Found 13 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:11:36.361023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1BCC67C0>]}
[0m18:11:36.361023 [info ] [MainThread]: 
[0m18:11:36.361023 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:36.370160 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m18:11:36.374187 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m18:11:36.374187 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m18:11:36.374187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:36.615227 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m18:11:36.617232 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m18:11:36.620229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m18:11:36.626976 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:11:36.627977 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m18:11:36.627977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:36.827455 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:11:36.828454 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:11:36.828454 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m18:11:36.855461 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.0 seconds
[0m18:11:36.856464 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m18:11:36.878460 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m18:11:36.887461 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:36.888460 [debug] [MainThread]: On master: BEGIN
[0m18:11:36.888460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:37.079723 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:37.079723 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:37.080741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:11:37.114498 [debug] [MainThread]: SQL status: SELECT 37 in 0.0 seconds
[0m18:11:37.119574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1BEC69D0>]}
[0m18:11:37.120570 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:37.141684 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:37.141684 [debug] [MainThread]: On master: BEGIN
[0m18:11:37.185493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:37.185493 [debug] [MainThread]: On master: COMMIT
[0m18:11:37.185493 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:37.186493 [debug] [MainThread]: On master: COMMIT
[0m18:11:37.207364 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:37.209363 [debug] [MainThread]: On master: Close
[0m18:11:37.211301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:37.213308 [info ] [MainThread]: 
[0m18:11:37.222692 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m18:11:37.223700 [info ] [Thread-1  ]: 1 of 13 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m18:11:37.224702 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m18:11:37.224702 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m18:11:37.231698 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.233698 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 18:11:37.224702 => 18:11:37.233698
[0m18:11:37.234704 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m18:11:37.263843 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.265884 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.265884 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m18:11:37.266883 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:11:37.475047 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:37.476047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.477047 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m18:11:37.504749 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:37.513757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.514751 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m18:11:37.537751 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:37.540750 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.541746 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m18:11:37.563745 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:37.580748 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:11:37.581747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.582746 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:11:37.612198 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:37.619198 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m18:11:37.623199 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:11:37.624192 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m18:11:37.661175 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:37.663194 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 18:11:37.234704 => 18:11:37.663194
[0m18:11:37.663694 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m18:11:37.665336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C2E46A0>]}
[0m18:11:37.665629 [info ] [Thread-1  ]: 1 of 13 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.44s]
[0m18:11:37.667036 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m18:11:37.667535 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:11:37.668035 [info ] [Thread-1  ]: 2 of 13 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m18:11:37.670065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m18:11:37.670505 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m18:11:37.673884 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.677659 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 18:11:37.670573 => 18:11:37.676659
[0m18:11:37.678300 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m18:11:37.683933 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.685585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.686681 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m18:11:37.687225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:37.877001 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:37.878004 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.878004 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m18:11:37.903802 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:37.907802 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.907802 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m18:11:37.930566 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:37.936631 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.936631 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m18:11:37.959760 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:37.961760 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:11:37.962761 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.962761 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:11:37.991801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:37.996899 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m18:11:37.997899 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:11:37.997899 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m18:11:38.029333 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:38.031341 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 18:11:37.678801 => 18:11:38.031341
[0m18:11:38.032341 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m18:11:38.034307 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C2D5F10>]}
[0m18:11:38.034756 [info ] [Thread-1  ]: 2 of 13 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.37s]
[0m18:11:38.036706 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:11:38.037342 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:11:38.037642 [info ] [Thread-1  ]: 3 of 13 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m18:11:38.038652 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m18:11:38.039763 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m18:11:38.044031 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:11:38.046031 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 18:11:38.039763 => 18:11:38.046031
[0m18:11:38.047034 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m18:11:38.051032 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:11:38.054530 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:11:38.055411 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m18:11:38.056302 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:38.247711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:38.247711 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:11:38.247711 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m18:11:38.276018 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:38.283518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:11:38.284138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m18:11:38.306625 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:38.310733 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:11:38.310733 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:11:38.311739 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:11:38.339755 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:38.343691 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m18:11:38.345070 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:11:38.345910 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m18:11:38.368450 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:38.370108 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 18:11:38.047034 => 18:11:38.370108
[0m18:11:38.370629 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m18:11:38.371186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C163070>]}
[0m18:11:38.372254 [info ] [Thread-1  ]: 3 of 13 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.33s]
[0m18:11:38.373289 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:11:38.373845 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:11:38.374368 [info ] [Thread-1  ]: 4 of 13 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m18:11:38.375412 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m18:11:38.375952 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:11:38.379180 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:11:38.380254 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 18:11:38.375952 => 18:11:38.380254
[0m18:11:38.381248 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:11:38.386091 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:11:38.388103 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:11:38.389105 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m18:11:38.389105 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:38.575760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:38.577824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:11:38.578325 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m18:11:38.604858 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:38.609846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:11:38.610855 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m18:11:38.631852 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:38.633858 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:11:38.634852 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:11:38.634852 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:11:38.662865 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:38.667880 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m18:11:38.668880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:11:38.668880 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m18:11:38.691460 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:38.695361 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 18:11:38.381248 => 18:11:38.694861
[0m18:11:38.696362 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m18:11:38.697423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C0D6100>]}
[0m18:11:38.698450 [info ] [Thread-1  ]: 4 of 13 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m18:11:38.699375 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:11:38.700445 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:11:38.700445 [info ] [Thread-1  ]: 5 of 13 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m18:11:38.701374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m18:11:38.702380 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m18:11:38.706379 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:11:38.707372 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 18:11:38.702380 => 18:11:38.707372
[0m18:11:38.708373 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m18:11:38.714373 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:11:38.716373 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:11:38.716373 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m18:11:38.717381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:38.918156 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:38.919328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:11:38.919328 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m18:11:38.946781 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:38.950780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:11:38.950780 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m18:11:38.973329 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:38.975329 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:11:38.975329 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:11:38.976329 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:11:39.003328 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:39.007155 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m18:11:39.008279 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:11:39.008756 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m18:11:39.030718 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:39.032244 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 18:11:38.708373 => 18:11:39.032244
[0m18:11:39.033237 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m18:11:39.034244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C2E46A0>]}
[0m18:11:39.035236 [info ] [Thread-1  ]: 5 of 13 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.33s]
[0m18:11:39.036235 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:11:39.036235 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:11:39.037241 [info ] [Thread-1  ]: 6 of 13 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m18:11:39.038236 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m18:11:39.038236 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:11:39.042237 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:11:39.046889 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 18:11:39.039237 => 18:11:39.045890
[0m18:11:39.047889 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:11:39.050097 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:11:39.056100 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:11:39.057226 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m18:11:39.057226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:39.250017 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:39.251016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:11:39.251016 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m18:11:39.276639 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:39.281637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:11:39.282636 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m18:11:39.304649 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:39.306646 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:11:39.307642 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:11:39.307642 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:11:39.337427 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:39.342011 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m18:11:39.342803 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:11:39.343301 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m18:11:39.365555 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:39.367556 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 18:11:39.047889 => 18:11:39.366555
[0m18:11:39.367556 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m18:11:39.368555 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C26C640>]}
[0m18:11:39.369555 [info ] [Thread-1  ]: 6 of 13 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.33s]
[0m18:11:39.370558 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:11:39.370558 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:11:39.370558 [info ] [Thread-1  ]: 7 of 13 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m18:11:39.371549 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m18:11:39.372558 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m18:11:39.375560 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:11:39.377550 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 18:11:39.372558 => 18:11:39.377550
[0m18:11:39.378549 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m18:11:39.383551 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:11:39.385550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:11:39.386550 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m18:11:39.386550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:39.590609 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:39.590609 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:11:39.591601 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m18:11:39.618484 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:39.621807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:11:39.622627 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m18:11:39.645484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:39.647485 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:11:39.647485 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:11:39.648484 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:11:39.677944 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:39.681955 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m18:11:39.682950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:11:39.682950 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m18:11:39.704952 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:39.706950 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 18:11:39.378549 => 18:11:39.705950
[0m18:11:39.706950 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m18:11:39.707949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C117190>]}
[0m18:11:39.707949 [info ] [Thread-1  ]: 7 of 13 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.34s]
[0m18:11:39.708949 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:11:39.709945 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:11:39.709945 [info ] [Thread-1  ]: 8 of 13 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m18:11:39.710951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m18:11:39.711945 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:11:39.714950 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:11:39.716953 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 18:11:39.711945 => 18:11:39.715946
[0m18:11:39.716953 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:11:39.721944 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:11:39.724681 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:11:39.725632 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m18:11:39.726682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:39.909128 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:39.910129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:11:39.910129 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m18:11:39.938126 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:39.941127 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:11:39.942126 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m18:11:39.964041 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:39.966041 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:11:39.966849 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:11:39.966849 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:11:39.993533 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:39.999077 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m18:11:40.000080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:11:40.000582 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m18:11:40.021703 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:40.025734 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 18:11:39.716953 => 18:11:40.025234
[0m18:11:40.027262 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m18:11:40.030267 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C226B20>]}
[0m18:11:40.031441 [info ] [Thread-1  ]: 8 of 13 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.32s]
[0m18:11:40.032633 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:11:40.033133 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:11:40.034141 [info ] [Thread-1  ]: 9 of 13 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m18:11:40.035141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m18:11:40.035141 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m18:11:40.039144 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:11:40.041142 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 18:11:40.036141 => 18:11:40.041142
[0m18:11:40.041142 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m18:11:40.049332 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:11:40.052328 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:11:40.052328 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m18:11:40.053327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:40.241723 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:40.241723 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:11:40.242723 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m18:11:40.270691 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:40.274698 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:11:40.275704 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m18:11:40.297691 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:40.299700 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:11:40.299700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:11:40.300698 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:11:40.327353 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:40.331443 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m18:11:40.333621 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:11:40.334278 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m18:11:40.356806 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:40.358457 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 18:11:40.042244 => 18:11:40.358457
[0m18:11:40.359456 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m18:11:40.360407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C2E46A0>]}
[0m18:11:40.361118 [info ] [Thread-1  ]: 9 of 13 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.32s]
[0m18:11:40.362129 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:11:40.362129 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:11:40.363130 [info ] [Thread-1  ]: 10 of 13 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m18:11:40.364127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m18:11:40.364127 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:11:40.367128 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:11:40.370128 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 18:11:40.364127 => 18:11:40.369129
[0m18:11:40.370128 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:11:40.376047 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:11:40.378560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:11:40.379309 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m18:11:40.379957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:40.589339 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:40.590325 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:11:40.590824 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m18:11:40.617411 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:40.622210 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:11:40.622734 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m18:11:40.645255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:40.647401 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:11:40.647947 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:11:40.648489 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:11:40.676503 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:40.679841 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m18:11:40.681375 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:11:40.681690 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m18:11:40.704439 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:40.706434 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 18:11:40.370128 => 18:11:40.705434
[0m18:11:40.706434 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m18:11:40.707434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C226B20>]}
[0m18:11:40.708434 [info ] [Thread-1  ]: 10 of 13 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.34s]
[0m18:11:40.709431 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:11:40.710431 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:11:40.710431 [info ] [Thread-1  ]: 11 of 13 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m18:11:40.712430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m18:11:40.712430 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m18:11:40.715437 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:11:40.716437 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 18:11:40.712430 => 18:11:40.716437
[0m18:11:40.717432 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m18:11:40.721438 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:11:40.723431 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:11:40.723431 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m18:11:40.723431 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:40.909165 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:40.909165 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:11:40.910165 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m18:11:40.940808 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:40.943812 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:11:40.943812 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m18:11:40.966350 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:40.968350 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:11:40.969350 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:11:40.969350 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:11:40.996048 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:40.999056 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m18:11:41.000056 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:11:41.001056 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m18:11:41.022815 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:41.024816 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 18:11:40.717432 => 18:11:41.024816
[0m18:11:41.024816 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m18:11:41.025816 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C1F6460>]}
[0m18:11:41.026815 [info ] [Thread-1  ]: 11 of 13 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.31s]
[0m18:11:41.027809 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:11:41.028813 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:11:41.028813 [info ] [Thread-1  ]: 12 of 13 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m18:11:41.029820 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m18:11:41.030818 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:11:41.033815 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:11:41.035810 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 18:11:41.030818 => 18:11:41.035810
[0m18:11:41.035810 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:11:41.039823 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:11:41.041817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:11:41.041817 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m18:11:41.042811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:41.230641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:41.231683 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:11:41.231683 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m18:11:41.259701 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:11:41.264638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:11:41.264638 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m18:11:41.286638 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:41.289638 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:11:41.289638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:11:41.289638 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:11:41.316787 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:11:41.319785 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m18:11:41.320786 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:11:41.321786 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m18:11:41.344195 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:11:41.347109 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 18:11:41.036823 => 18:11:41.346423
[0m18:11:41.347620 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m18:11:41.348570 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C2E46A0>]}
[0m18:11:41.349146 [info ] [Thread-1  ]: 12 of 13 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m18:11:41.349146 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:11:41.350171 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:11:41.351164 [info ] [Thread-1  ]: 13 of 13 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m18:11:41.352163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m18:11:41.353164 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:11:41.357163 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:11:41.361129 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 18:11:41.353164 => 18:11:41.359848
[0m18:11:41.362140 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:11:41.367810 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:11:41.370804 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:11:41.370804 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m18:11:41.371804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:11:41.579619 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:11:41.580619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:11:41.580619 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
),
 5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM 5m_btc_c
      WHERE candle_closed = false
)
,
5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_5min_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM 5m_btc_c_treated curr
             LEFT JOIN 5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:11:41.604268 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "5"
LINE 10: with 5m_btc_c as
              ^

[0m18:11:41.604268 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: ROLLBACK
[0m18:11:41.626339 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 18:11:41.363129 => 18:11:41.626339
[0m18:11:41.627238 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m18:11:41.634239 [debug] [Thread-1  ]: Database Error in model btc_perp_data_5m_current_and_history (models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql)
  syntax error at or near "5"
  LINE 10: with 5m_btc_c as
                ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:11:41.635238 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11d6e3ff-a9d3-4bb4-b465-55d6258888bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C226B20>]}
[0m18:11:41.635238 [error] [Thread-1  ]: 13 of 13 ERROR creating sql view model wizetrading.btc_perp_data_5m_current_and_history  [[31mERROR[0m in 0.28s]
[0m18:11:41.637237 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:11:41.638237 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:41.638237 [debug] [MainThread]: On master: BEGIN
[0m18:11:41.639240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:41.827004 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:41.828438 [debug] [MainThread]: On master: COMMIT
[0m18:11:41.828438 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:41.828438 [debug] [MainThread]: On master: COMMIT
[0m18:11:41.851616 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:41.852616 [debug] [MainThread]: On master: Close
[0m18:11:41.853610 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:41.854610 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m18:11:41.854610 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m18:11:41.854610 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m18:11:41.855609 [info ] [MainThread]: 
[0m18:11:41.855609 [info ] [MainThread]: Finished running 13 view models in 0 hours 0 minutes and 5.49 seconds (5.49s).
[0m18:11:41.858611 [debug] [MainThread]: Command end result
[0m18:11:41.875637 [info ] [MainThread]: 
[0m18:11:41.876859 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:11:41.877358 [info ] [MainThread]: 
[0m18:11:41.878040 [error] [MainThread]:   Database Error in model btc_perp_data_5m_current_and_history (models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql)
  syntax error at or near "5"
  LINE 10: with 5m_btc_c as
                ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:11:41.879126 [info ] [MainThread]: 
[0m18:11:41.880138 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m18:11:41.881138 [debug] [MainThread]: Command `dbt run` failed at 18:11:41.881138 after 6.13 seconds
[0m18:11:41.881138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A190DE850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C1F3FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A1C1F3760>]}
[0m18:11:41.882145 [debug] [MainThread]: Flushing usage events
[0m18:13:11.091451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75F1CFA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B761A394C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B761A39550>]}


============================== 18:13:11.096452 | 533f0486-83d6-4494-9d6a-d8843934fb04 ==============================
[0m18:13:11.096452 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:13:11.097450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:13:11.283443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75FAD1EE0>]}
[0m18:13:11.354183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B761DDE250>]}
[0m18:13:11.355202 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m18:13:11.363196 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:13:11.455901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:11.455901 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:13:11.543980 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:13:11.631995 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m18:13:11.637983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B762167220>]}
[0m18:13:11.641122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B761F07940>]}
[0m18:13:11.641122 [info ] [MainThread]: Found 13 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:13:11.656752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B761F07AF0>]}
[0m18:13:11.658325 [info ] [MainThread]: 
[0m18:13:11.659234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:11.662222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m18:13:11.671662 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m18:13:11.672557 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m18:13:11.673036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:11.879015 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m18:13:11.880022 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m18:13:11.883023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m18:13:11.888022 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:13:11.889022 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m18:13:11.889022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:12.076752 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:13:12.076752 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:13:12.076752 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m18:13:12.105737 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.0 seconds
[0m18:13:12.107931 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m18:13:12.129001 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m18:13:12.139002 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:12.139002 [debug] [MainThread]: On master: BEGIN
[0m18:13:12.140003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:12.310030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:13:12.310030 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:12.310030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:13:12.354597 [debug] [MainThread]: SQL status: SELECT 37 in 0.0 seconds
[0m18:13:12.360597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7621670A0>]}
[0m18:13:12.361597 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:12.383148 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:12.384163 [debug] [MainThread]: On master: BEGIN
[0m18:13:12.427335 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:13:12.427335 [debug] [MainThread]: On master: COMMIT
[0m18:13:12.427335 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:12.428400 [debug] [MainThread]: On master: COMMIT
[0m18:13:12.449293 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:13:12.450294 [debug] [MainThread]: On master: Close
[0m18:13:12.450294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:12.451295 [info ] [MainThread]: 
[0m18:13:12.458288 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m18:13:12.459291 [info ] [Thread-1  ]: 1 of 13 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m18:13:12.459291 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m18:13:12.460291 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m18:13:12.466290 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.468290 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 18:13:12.460291 => 18:13:12.468290
[0m18:13:12.468290 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m18:13:12.499290 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.500291 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.501364 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m18:13:12.501364 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:13:12.700822 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:12.701823 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.701823 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m18:13:12.727830 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:12.734828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.735822 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m18:13:12.757498 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:12.761508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.762494 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m18:13:12.783839 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:12.798022 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:13:12.799021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.799021 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:13:12.828344 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:12.836374 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m18:13:12.841374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:13:12.842373 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m18:13:12.879375 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:12.881380 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 18:13:12.469291 => 18:13:12.881380
[0m18:13:12.881380 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m18:13:12.882379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7623E97F0>]}
[0m18:13:12.883110 [info ] [Thread-1  ]: 1 of 13 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.42s]
[0m18:13:12.883610 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m18:13:12.884619 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:13:12.884619 [info ] [Thread-1  ]: 2 of 13 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m18:13:12.886619 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m18:13:12.886619 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m18:13:12.889619 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:12.891620 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 18:13:12.886619 => 18:13:12.890619
[0m18:13:12.891620 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m18:13:12.896623 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:12.898622 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:12.899621 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m18:13:12.899621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:13.084976 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.085975 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:13.085975 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m18:13:13.112903 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:13.116904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:13.117904 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m18:13:13.141120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:13.145125 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:13.146127 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m18:13:13.171318 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:13.173317 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:13:13.173317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:13.174317 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:13:13.200612 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.206998 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m18:13:13.207896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:13:13.207896 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m18:13:13.238289 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:13.239288 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 18:13:12.891620 => 18:13:13.239288
[0m18:13:13.240282 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m18:13:13.240282 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7623DBF40>]}
[0m18:13:13.241281 [info ] [Thread-1  ]: 2 of 13 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.35s]
[0m18:13:13.242282 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:13:13.242282 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:13:13.243295 [info ] [Thread-1  ]: 3 of 13 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m18:13:13.244284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m18:13:13.245285 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m18:13:13.247298 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:13:13.249284 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 18:13:13.245285 => 18:13:13.249284
[0m18:13:13.250286 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m18:13:13.257685 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:13:13.261053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:13:13.261553 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m18:13:13.263568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:13.450641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.451643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:13:13.451643 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m18:13:13.484344 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:13.488344 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:13:13.489350 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m18:13:13.511344 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:13.513344 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:13:13.514356 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:13:13.514356 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:13:13.541117 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.544620 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m18:13:13.545625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:13:13.545625 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m18:13:13.567835 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:13.569838 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 18:13:13.250286 => 18:13:13.569838
[0m18:13:13.570907 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m18:13:13.571901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B762285EE0>]}
[0m18:13:13.571901 [info ] [Thread-1  ]: 3 of 13 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.33s]
[0m18:13:13.572871 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:13:13.573836 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:13:13.573836 [info ] [Thread-1  ]: 4 of 13 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m18:13:13.574918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m18:13:13.574918 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:13:13.578834 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:13:13.581864 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 18:13:13.575836 => 18:13:13.580835
[0m18:13:13.581864 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:13:13.586837 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:13:13.588839 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:13:13.588839 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m18:13:13.589835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:13.774084 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.775077 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:13:13.776078 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m18:13:13.802383 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:13.807318 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:13:13.807318 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m18:13:13.829311 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:13.831318 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:13:13.832319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:13:13.832319 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:13:13.858317 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.862312 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m18:13:13.863317 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:13:13.863317 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m18:13:13.886322 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:13.888312 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 18:13:13.581864 => 18:13:13.888312
[0m18:13:13.888312 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m18:13:13.889311 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7623DB820>]}
[0m18:13:13.890320 [info ] [Thread-1  ]: 4 of 13 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m18:13:13.891312 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:13:13.891312 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:13:13.892313 [info ] [Thread-1  ]: 5 of 13 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m18:13:13.893312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m18:13:13.893312 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m18:13:13.897312 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:13:13.899313 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 18:13:13.894312 => 18:13:13.899313
[0m18:13:13.900317 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m18:13:13.904313 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:13:13.906313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:13:13.907313 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m18:13:13.907313 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:14.086841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:14.086841 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:13:14.087846 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m18:13:14.114569 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:14.118565 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:13:14.119568 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m18:13:14.141156 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:14.143164 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:13:14.144156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:13:14.145157 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:13:14.172577 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:14.178202 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m18:13:14.179204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:13:14.180251 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m18:13:14.202172 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:14.204205 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 18:13:13.900317 => 18:13:14.203203
[0m18:13:14.204205 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m18:13:14.205204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B762365F40>]}
[0m18:13:14.206204 [info ] [Thread-1  ]: 5 of 13 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.31s]
[0m18:13:14.207745 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:13:14.208245 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:13:14.209256 [info ] [Thread-1  ]: 6 of 13 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m18:13:14.210256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m18:13:14.210256 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:13:14.214532 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:13:14.216509 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 18:13:14.210256 => 18:13:14.216509
[0m18:13:14.216509 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:13:14.222015 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:13:14.224015 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:13:14.224015 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m18:13:14.225015 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:14.408710 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:14.409705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:13:14.409705 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m18:13:14.436003 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:14.440997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:13:14.441996 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m18:13:14.464617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:14.466618 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:13:14.467618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:13:14.468618 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:13:14.496187 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:14.498488 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m18:13:14.500490 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:13:14.500490 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m18:13:14.523794 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:14.527861 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 18:13:14.217520 => 18:13:14.527363
[0m18:13:14.529252 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m18:13:14.530560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B762325760>]}
[0m18:13:14.532025 [info ] [Thread-1  ]: 6 of 13 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.32s]
[0m18:13:14.533025 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:13:14.534028 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:13:14.535251 [info ] [Thread-1  ]: 7 of 13 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m18:13:14.536526 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m18:13:14.537178 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m18:13:14.541005 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:13:14.542997 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 18:13:14.537528 => 18:13:14.542997
[0m18:13:14.543998 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m18:13:14.552124 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:13:14.554276 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:13:14.555288 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m18:13:14.555288 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:14.739895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:14.740921 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:13:14.742221 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m18:13:14.770058 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:14.773059 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:13:14.774059 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m18:13:14.795721 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:14.798524 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:13:14.798524 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:13:14.798524 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:13:14.825371 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:14.829343 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m18:13:14.830885 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:13:14.831387 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m18:13:14.853522 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:14.855251 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 18:13:14.544999 => 18:13:14.855251
[0m18:13:14.856262 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m18:13:14.857261 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7623F37C0>]}
[0m18:13:14.857261 [info ] [Thread-1  ]: 7 of 13 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.32s]
[0m18:13:14.858259 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:13:14.859264 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:13:14.859264 [info ] [Thread-1  ]: 8 of 13 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m18:13:14.860254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m18:13:14.861253 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:13:14.864255 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:13:14.865255 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 18:13:14.861253 => 18:13:14.865255
[0m18:13:14.866265 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:13:14.873252 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:13:14.875253 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:13:14.875253 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m18:13:14.875253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:15.063087 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:15.063737 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:13:15.064390 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m18:13:15.091313 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:15.096483 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:13:15.097312 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m18:13:15.119823 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:15.121822 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:13:15.122813 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:13:15.122813 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:13:15.149813 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:15.153813 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m18:13:15.154812 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:13:15.154812 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m18:13:15.177814 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:15.179813 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 18:13:14.866265 => 18:13:15.178814
[0m18:13:15.179813 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m18:13:15.180813 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7622C78E0>]}
[0m18:13:15.181814 [info ] [Thread-1  ]: 8 of 13 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.32s]
[0m18:13:15.181814 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:13:15.182814 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:13:15.182814 [info ] [Thread-1  ]: 9 of 13 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m18:13:15.183818 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m18:13:15.184819 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m18:13:15.187822 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:13:15.188821 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 18:13:15.184819 => 18:13:15.188821
[0m18:13:15.189816 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m18:13:15.194812 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:13:15.196813 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:13:15.197829 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m18:13:15.197829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:15.416808 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:15.417797 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:13:15.417797 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m18:13:15.464631 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:15.468506 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:13:15.469090 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m18:13:15.493147 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:15.495463 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:13:15.496152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:13:15.496560 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:13:15.530625 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:15.533661 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m18:13:15.534661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:13:15.534661 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m18:13:15.585664 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:15.587665 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 18:13:15.189816 => 18:13:15.587665
[0m18:13:15.587665 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m18:13:15.588664 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B76229EC40>]}
[0m18:13:15.589665 [info ] [Thread-1  ]: 9 of 13 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.40s]
[0m18:13:15.590668 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:13:15.590668 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:13:15.591667 [info ] [Thread-1  ]: 10 of 13 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m18:13:15.592661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m18:13:15.592661 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:13:15.595661 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:13:15.597661 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 18:13:15.592661 => 18:13:15.597661
[0m18:13:15.598659 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:13:15.603668 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:13:15.605660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:13:15.605660 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m18:13:15.606669 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:16.076095 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:16.077095 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:13:16.077095 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m18:13:16.104095 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:16.108313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:13:16.108313 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m18:13:16.129141 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:16.129141 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:13:16.129141 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:13:16.129141 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:13:16.165140 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:16.167115 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m18:13:16.168084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:13:16.169084 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m18:13:16.191084 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:16.192084 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 18:13:15.598659 => 18:13:16.192084
[0m18:13:16.193644 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m18:13:16.194913 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B762243EB0>]}
[0m18:13:16.194913 [info ] [Thread-1  ]: 10 of 13 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.60s]
[0m18:13:16.196993 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:13:16.196993 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:13:16.196993 [info ] [Thread-1  ]: 11 of 13 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m18:13:16.198992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m18:13:16.198992 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m18:13:16.201993 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:13:16.203993 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 18:13:16.198992 => 18:13:16.203993
[0m18:13:16.204993 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m18:13:16.210825 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:13:16.213175 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:13:16.214175 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m18:13:16.214175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:16.411167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:16.412190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:13:16.413156 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m18:13:16.439470 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:16.443463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:13:16.444462 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m18:13:16.467284 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:16.469809 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:13:16.469809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:13:16.469809 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:13:16.497713 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:16.501452 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m18:13:16.502051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:13:16.502595 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m18:13:16.524416 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:16.526025 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 18:13:16.204993 => 18:13:16.526025
[0m18:13:16.526576 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m18:13:16.527669 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B762261760>]}
[0m18:13:16.528203 [info ] [Thread-1  ]: 11 of 13 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.33s]
[0m18:13:16.529267 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:13:16.529813 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:13:16.530333 [info ] [Thread-1  ]: 12 of 13 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m18:13:16.531392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m18:13:16.531912 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:13:16.536120 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:13:16.537679 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 18:13:16.531912 => 18:13:16.537679
[0m18:13:16.538197 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:13:16.546446 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:13:16.548909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:13:16.549611 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m18:13:16.550611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:16.736660 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:16.737273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:13:16.737745 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m18:13:16.763781 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:16.769941 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:13:16.770830 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m18:13:16.793899 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:16.796900 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:13:16.796900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:13:16.797899 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:13:16.824897 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:16.827896 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m18:13:16.829896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:13:16.830896 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m18:13:16.852987 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:16.855909 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 18:13:16.538952 => 18:13:16.855409
[0m18:13:16.855909 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m18:13:16.856921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7623B8760>]}
[0m18:13:16.857921 [info ] [Thread-1  ]: 12 of 13 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m18:13:16.859714 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:13:16.860214 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:13:16.861226 [info ] [Thread-1  ]: 13 of 13 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m18:13:16.862226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m18:13:16.863226 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:13:16.868852 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:13:16.871275 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 18:13:16.863226 => 18:13:16.871275
[0m18:13:16.872276 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:13:16.880569 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:13:16.884571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:13:16.885570 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m18:13:16.886569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:17.069958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:13:17.070480 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:13:17.070988 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_5min_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:13:17.105970 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:13:17.110047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:13:17.111044 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m18:13:17.134906 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:17.136923 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:13:17.136923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:13:17.137913 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:13:17.164827 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:13:17.168837 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m18:13:17.169820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:13:17.170880 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m18:13:17.192232 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:13:17.194230 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 18:13:16.873277 => 18:13:17.194230
[0m18:13:17.195223 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m18:13:17.196233 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '533f0486-83d6-4494-9d6a-d8843934fb04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B76241FD90>]}
[0m18:13:17.197224 [info ] [Thread-1  ]: 13 of 13 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.33s]
[0m18:13:17.198239 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:13:17.200223 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:17.200223 [debug] [MainThread]: On master: BEGIN
[0m18:13:17.200223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:17.382885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:13:17.383895 [debug] [MainThread]: On master: COMMIT
[0m18:13:17.383895 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:17.383895 [debug] [MainThread]: On master: COMMIT
[0m18:13:17.405658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:13:17.406160 [debug] [MainThread]: On master: Close
[0m18:13:17.407511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:17.407511 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m18:13:17.407511 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m18:13:17.407511 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m18:13:17.408839 [info ] [MainThread]: 
[0m18:13:17.409366 [info ] [MainThread]: Finished running 13 view models in 0 hours 0 minutes and 5.75 seconds (5.75s).
[0m18:13:17.412133 [debug] [MainThread]: Command end result
[0m18:13:17.427526 [info ] [MainThread]: 
[0m18:13:17.428574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:17.429071 [info ] [MainThread]: 
[0m18:13:17.430083 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m18:13:17.431083 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:17.431083 after 6.38 seconds
[0m18:13:17.432093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B75F1CFA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B761DCBF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B762366DF0>]}
[0m18:13:17.432093 [debug] [MainThread]: Flushing usage events
[0m18:23:00.850504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E99060970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9B8983D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9B898A60>]}


============================== 18:23:00.866136 | 1f192638-6273-4bff-ad63-3ec8a5490681 ==============================
[0m18:23:00.866136 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:23:00.866136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:23:01.056684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9994DD60>]}
[0m18:23:01.137042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9BB4E520>]}
[0m18:23:01.139042 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m18:23:01.146041 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:23:01.261041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m18:23:01.261041 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:23:01.262041 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m18:23:01.262041 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m18:23:01.262041 [debug] [MainThread]: Partial parsing: added file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m18:23:01.356213 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:23:01.368836 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m18:23:01.371830 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m18:23:01.373830 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m18:23:01.413687 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m18:23:01.419771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9BE6D550>]}
[0m18:23:01.437687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9BD74BB0>]}
[0m18:23:01.438691 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:23:01.439686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9BD74BB0>]}
[0m18:23:01.442688 [info ] [MainThread]: 
[0m18:23:01.444693 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:01.447694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m18:23:01.456693 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m18:23:01.456693 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m18:23:01.456693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:01.674739 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m18:23:01.676553 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m18:23:01.679208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m18:23:01.684445 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:23:01.684953 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m18:23:01.684953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:01.887081 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:23:01.888187 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:23:01.888187 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m18:23:01.917899 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.0 seconds
[0m18:23:01.920633 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m18:23:01.943223 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m18:23:01.953085 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:01.954087 [debug] [MainThread]: On master: BEGIN
[0m18:23:01.954087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:02.126751 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:23:02.126751 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:02.126751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:02.176778 [debug] [MainThread]: SQL status: SELECT 40 in 0.0 seconds
[0m18:23:02.182785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9BBDAA60>]}
[0m18:23:02.182785 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:02.205280 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:02.206360 [debug] [MainThread]: On master: BEGIN
[0m18:23:02.249824 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:23:02.250820 [debug] [MainThread]: On master: COMMIT
[0m18:23:02.251818 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:02.252819 [debug] [MainThread]: On master: COMMIT
[0m18:23:02.275043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:23:02.275043 [debug] [MainThread]: On master: Close
[0m18:23:02.276122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:02.278058 [info ] [MainThread]: 
[0m18:23:02.290461 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m18:23:02.291542 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m18:23:02.292480 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m18:23:02.292480 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m18:23:02.300476 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.303482 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 18:23:02.293542 => 18:23:02.303482
[0m18:23:02.303482 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m18:23:02.334476 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.336483 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.337478 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m18:23:02.337478 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:23:02.540272 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:02.541283 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.541283 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m18:23:02.568773 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:02.576052 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.576052 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m18:23:02.599159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:02.602159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.603159 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m18:23:02.625159 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:02.641076 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:23:02.642361 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.642620 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:23:02.671195 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:02.678839 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m18:23:02.683481 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:23:02.684004 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m18:23:02.726239 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:02.728860 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 18:23:02.304482 => 18:23:02.728860
[0m18:23:02.729860 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m18:23:02.730866 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C1AAD30>]}
[0m18:23:02.731860 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.44s]
[0m18:23:02.733939 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m18:23:02.734958 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:23:02.735958 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m18:23:02.738110 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m18:23:02.738110 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m18:23:02.742721 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:02.744998 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 18:23:02.738110 => 18:23:02.744998
[0m18:23:02.746009 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m18:23:02.755679 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:02.758568 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:02.760568 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m18:23:02.762070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:02.950188 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:02.951188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:02.951188 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m18:23:02.978907 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:02.982898 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:02.982898 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m18:23:03.006897 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:03.010869 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:03.011371 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m18:23:03.038045 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:03.041045 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:23:03.041045 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:03.041045 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:23:03.068584 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:03.071585 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m18:23:03.072585 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:23:03.073585 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m18:23:03.102194 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:03.105192 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 18:23:02.746009 => 18:23:03.105192
[0m18:23:03.106193 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m18:23:03.107192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9BF9DC70>]}
[0m18:23:03.108963 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.37s]
[0m18:23:03.110459 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:23:03.111705 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:23:03.112722 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m18:23:03.115204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m18:23:03.115204 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m18:23:03.121216 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:23:03.124817 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 18:23:03.116216 => 18:23:03.124316
[0m18:23:03.125881 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m18:23:03.134336 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:23:03.137687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:23:03.138962 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m18:23:03.139961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:03.336366 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:03.336508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:23:03.337509 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m18:23:03.365063 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:03.371819 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:23:03.372321 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m18:23:03.394489 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:03.396489 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:23:03.397488 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:23:03.397488 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:23:03.425493 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:03.428493 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m18:23:03.429493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:23:03.430488 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m18:23:03.452487 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:03.453486 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 18:23:03.126381 => 18:23:03.453486
[0m18:23:03.454497 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m18:23:03.455487 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C082D60>]}
[0m18:23:03.456487 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.34s]
[0m18:23:03.457487 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:23:03.457487 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:23:03.458487 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m18:23:03.459488 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m18:23:03.459488 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:23:03.462488 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:23:03.464488 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 18:23:03.460488 => 18:23:03.464488
[0m18:23:03.464488 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:23:03.469494 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:23:03.471487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:23:03.471487 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m18:23:03.472487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:03.661575 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:03.662575 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:23:03.662575 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m18:23:03.689620 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:03.694579 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:23:03.695574 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m18:23:03.718861 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:03.720861 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:23:03.720861 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:23:03.721861 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:23:03.749861 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:03.752861 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m18:23:03.753861 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:23:03.753861 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m18:23:03.776614 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:03.778607 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 18:23:03.465487 => 18:23:03.778607
[0m18:23:03.779607 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m18:23:03.780614 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9BFFD460>]}
[0m18:23:03.781615 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:03.782606 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:23:03.782606 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:23:03.783606 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m18:23:03.784607 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m18:23:03.784607 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m18:23:03.787612 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:23:03.789608 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 18:23:03.785612 => 18:23:03.789608
[0m18:23:03.789608 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m18:23:03.795177 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:23:03.798216 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:23:03.798216 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m18:23:03.799217 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:04.004034 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:04.005039 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:23:04.005039 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m18:23:04.033051 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:04.038198 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:23:04.039103 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m18:23:04.061232 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:04.063236 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:23:04.063735 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:23:04.064235 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:23:04.091228 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:04.095230 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m18:23:04.096728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:23:04.097730 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m18:23:04.119354 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:04.122879 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 18:23:03.790609 => 18:23:04.122355
[0m18:23:04.123858 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m18:23:04.125506 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C07EEE0>]}
[0m18:23:04.126931 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.34s]
[0m18:23:04.128429 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:23:04.129428 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:23:04.130934 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m18:23:04.132456 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m18:23:04.132929 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:23:04.137928 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:23:04.141182 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 18:23:04.133429 => 18:23:04.138954
[0m18:23:04.142200 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:23:04.148488 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:23:04.152188 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:23:04.153174 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m18:23:04.153674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:04.339763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:04.340764 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:23:04.340764 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m18:23:04.367763 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:04.371762 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:23:04.372763 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m18:23:04.394533 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:04.396534 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:23:04.397533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:23:04.397533 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:23:04.423545 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:04.426545 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m18:23:04.427533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:23:04.427533 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m18:23:04.449532 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:04.451533 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 18:23:04.142200 => 18:23:04.451533
[0m18:23:04.451533 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m18:23:04.452533 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C07EEE0>]}
[0m18:23:04.453544 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:04.454533 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:23:04.454533 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:23:04.455533 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m18:23:04.456534 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m18:23:04.457533 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m18:23:04.460533 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:23:04.462533 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 18:23:04.457533 => 18:23:04.462533
[0m18:23:04.463886 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m18:23:04.469897 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:23:04.472900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:23:04.473899 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m18:23:04.473899 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:04.676411 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:04.677181 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:23:04.677181 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m18:23:04.704757 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:04.709078 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:23:04.709648 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m18:23:04.732433 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:04.734432 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:23:04.735432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:23:04.735432 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:23:04.761438 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:04.766437 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m18:23:04.766437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:23:04.767437 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m18:23:04.790445 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:04.793437 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 18:23:04.464389 => 18:23:04.793437
[0m18:23:04.794433 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m18:23:04.795431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C070C70>]}
[0m18:23:04.796431 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.34s]
[0m18:23:04.797431 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:23:04.797431 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:23:04.798440 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m18:23:04.799444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m18:23:04.799444 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:23:04.802437 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:23:04.804438 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 18:23:04.800437 => 18:23:04.804438
[0m18:23:04.804438 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:23:04.811432 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:23:04.814434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:23:04.814434 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m18:23:04.815435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:05.011759 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:05.012611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:23:05.012611 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m18:23:05.040528 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:05.046167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:23:05.047192 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m18:23:05.068643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:05.070649 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:23:05.071649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:23:05.071649 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:23:05.098321 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:05.101319 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m18:23:05.102319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:23:05.103318 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m18:23:05.125320 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:05.128331 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 18:23:04.805443 => 18:23:05.127321
[0m18:23:05.129318 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m18:23:05.130334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C0C74F0>]}
[0m18:23:05.130334 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.33s]
[0m18:23:05.132319 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:23:05.133332 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:23:05.134319 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m18:23:05.135329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m18:23:05.135329 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m18:23:05.138334 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:23:05.140324 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 18:23:05.135329 => 18:23:05.140324
[0m18:23:05.141327 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m18:23:05.146325 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:23:05.148319 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:23:05.148319 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m18:23:05.149327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:05.334021 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:05.334021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:23:05.335022 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m18:23:05.361020 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:05.365553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:23:05.366575 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m18:23:05.388213 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:05.391899 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:23:05.392900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:23:05.393399 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:23:05.420975 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:05.425972 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m18:23:05.427963 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:23:05.427963 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m18:23:05.451287 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:05.452804 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 18:23:05.141327 => 18:23:05.452804
[0m18:23:05.453803 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m18:23:05.454804 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C0A5BE0>]}
[0m18:23:05.454804 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:05.455803 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:23:05.456804 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:23:05.456804 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m18:23:05.457803 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m18:23:05.458803 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:23:05.462802 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:23:05.465424 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 18:23:05.458803 => 18:23:05.464673
[0m18:23:05.465923 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:23:05.470450 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:23:05.472501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:23:05.472501 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m18:23:05.473896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:05.660883 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:05.661882 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:23:05.661882 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m18:23:05.688884 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:05.691884 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:23:05.692883 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m18:23:05.721249 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:05.724005 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:23:05.724506 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:23:05.724506 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:23:05.745588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:05.745588 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m18:23:05.745588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:23:05.745588 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m18:23:05.778781 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:05.779782 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 18:23:05.466435 => 18:23:05.779782
[0m18:23:05.780781 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m18:23:05.780781 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C04E070>]}
[0m18:23:05.781781 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:05.782782 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:23:05.782782 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:23:05.783782 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m18:23:05.784784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m18:23:05.784784 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m18:23:05.787782 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:23:05.789782 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 18:23:05.784784 => 18:23:05.788781
[0m18:23:05.789782 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m18:23:05.794362 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:23:05.796362 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:23:05.797362 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m18:23:05.797362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:05.978591 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:05.979592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:23:05.979592 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m18:23:06.007591 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:06.011600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:23:06.012596 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m18:23:06.034590 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:06.037591 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:23:06.037591 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:23:06.038591 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:23:06.066214 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:06.070032 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m18:23:06.071542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:23:06.071917 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m18:23:06.094138 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:06.096138 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 18:23:05.789782 => 18:23:06.096138
[0m18:23:06.096138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m18:23:06.098138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C151730>]}
[0m18:23:06.098620 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.31s]
[0m18:23:06.100636 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:23:06.100636 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:23:06.101636 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m18:23:06.102636 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m18:23:06.102636 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:23:06.107220 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:23:06.109220 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 18:23:06.103710 => 18:23:06.109220
[0m18:23:06.110220 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:23:06.115836 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:23:06.118095 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:23:06.119310 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m18:23:06.119310 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:06.310128 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:06.311128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:23:06.311128 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m18:23:06.339518 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:06.343018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:23:06.343524 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m18:23:06.366093 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:06.367661 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:23:06.368671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:23:06.368671 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:23:06.394663 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:06.398660 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m18:23:06.399666 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:23:06.399666 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m18:23:06.422050 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:06.423576 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 18:23:06.111220 => 18:23:06.423576
[0m18:23:06.423576 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m18:23:06.424575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C15FC70>]}
[0m18:23:06.425596 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:06.426857 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:23:06.427850 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:23:06.428871 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m18:23:06.429852 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m18:23:06.430852 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:23:06.434852 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:23:06.436852 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 18:23:06.430852 => 18:23:06.436852
[0m18:23:06.437852 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:23:06.444384 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:23:06.448137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:23:06.449193 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m18:23:06.450009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:06.639460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:06.640460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:23:06.641461 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_15min_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:23:06.673465 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:06.676465 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:23:06.677459 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m18:23:06.700661 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:06.700803 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m18:23:06.700803 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:23:06.700803 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m18:23:06.731333 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:06.734335 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m18:23:06.735336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:23:06.736336 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m18:23:06.759556 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:06.761547 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 18:23:06.437852 => 18:23:06.760555
[0m18:23:06.761547 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m18:23:06.762552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C120FA0>]}
[0m18:23:06.763547 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.33s]
[0m18:23:06.764554 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:23:06.765553 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:23:06.765553 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m18:23:06.766553 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m18:23:06.766553 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:23:06.770553 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:23:06.773555 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 18:23:06.767553 => 18:23:06.773555
[0m18:23:06.774824 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:23:06.779671 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:23:06.779671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:23:06.779671 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m18:23:06.779671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:06.977679 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:06.978678 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:23:06.978678 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_1hour_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:23:07.004530 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "wizetrading.v_btcusd_perp_1hour_history" does not exist
LINE 68:         FROM wizetrading.v_btcusd_perp_1hour_history
                      ^

[0m18:23:07.005530 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: ROLLBACK
[0m18:23:07.028427 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 18:23:06.775574 => 18:23:07.027487
[0m18:23:07.029429 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m18:23:07.034823 [debug] [Thread-1  ]: Database Error in model btc_perp_data_1h_current_and_history (models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_1hour_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_1hour_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:23:07.035821 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C1594F0>]}
[0m18:23:07.036823 [error] [Thread-1  ]: 14 of 17 ERROR creating sql view model wizetrading.btc_perp_data_1h_current_and_history  [[31mERROR[0m in 0.27s]
[0m18:23:07.037823 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:23:07.038829 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:23:07.038829 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m18:23:07.040837 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m18:23:07.040837 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:23:07.044822 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:23:07.047825 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 18:23:07.040837 => 18:23:07.047825
[0m18:23:07.048822 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:23:07.053834 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:23:07.056822 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:23:07.056822 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m18:23:07.057821 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:07.242766 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:07.243631 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:23:07.244644 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_1week_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:23:07.269656 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "wizetrading.v_btcusd_perp_1week_history" does not exist
LINE 68:         FROM wizetrading.v_btcusd_perp_1week_history
                      ^

[0m18:23:07.270667 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: ROLLBACK
[0m18:23:07.292807 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 18:23:07.048822 => 18:23:07.292807
[0m18:23:07.293806 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m18:23:07.295806 [debug] [Thread-1  ]: Database Error in model btc_perp_data_1w_current_and_history (models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_1week_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_1week_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m18:23:07.296807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C120FA0>]}
[0m18:23:07.297807 [error] [Thread-1  ]: 15 of 17 ERROR creating sql view model wizetrading.btc_perp_data_1w_current_and_history  [[31mERROR[0m in 0.26s]
[0m18:23:07.298807 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:23:07.298807 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:23:07.299952 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m18:23:07.301035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m18:23:07.301536 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:23:07.305548 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:23:07.308618 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 18:23:07.301536 => 18:23:07.308161
[0m18:23:07.309120 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:23:07.317712 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:23:07.320712 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:23:07.321721 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m18:23:07.322712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:07.530515 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:07.531667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:23:07.531667 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_4hour_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:23:07.558477 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "wizetrading.v_btcusd_perp_4hour_history" does not exist
LINE 68:         FROM wizetrading.v_btcusd_perp_4hour_history
                      ^

[0m18:23:07.558477 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: ROLLBACK
[0m18:23:07.581493 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 18:23:07.309120 => 18:23:07.580494
[0m18:23:07.581493 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m18:23:07.584799 [debug] [Thread-1  ]: Database Error in model btc_perp_data_4h_current_and_history (models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_4hour_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_4hour_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m18:23:07.584799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C0BF880>]}
[0m18:23:07.585800 [error] [Thread-1  ]: 16 of 17 ERROR creating sql view model wizetrading.btc_perp_data_4h_current_and_history  [[31mERROR[0m in 0.28s]
[0m18:23:07.586799 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:23:07.587799 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:23:07.587799 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m18:23:07.589306 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m18:23:07.589792 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:23:07.593803 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:23:07.596802 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 18:23:07.589792 => 18:23:07.595803
[0m18:23:07.596802 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:23:07.602210 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:23:07.615518 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:23:07.617001 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m18:23:07.617001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:23:07.823713 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:23:07.823713 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:23:07.824713 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_5min_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:23:07.857555 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:23:07.861158 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:23:07.861158 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m18:23:07.884158 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:23:07.886157 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:23:07.887157 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:23:07.888157 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:23:07.916160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:23:07.919166 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m18:23:07.920157 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:23:07.921156 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m18:23:07.943157 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:23:07.945157 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 18:23:07.597802 => 18:23:07.945157
[0m18:23:07.945653 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m18:23:07.946662 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f192638-6273-4bff-ad63-3ec8a5490681', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C268250>]}
[0m18:23:07.947775 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.36s]
[0m18:23:07.949287 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:23:07.950288 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:07.951287 [debug] [MainThread]: On master: BEGIN
[0m18:23:07.951287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:08.137093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:23:08.138095 [debug] [MainThread]: On master: COMMIT
[0m18:23:08.139093 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:08.139093 [debug] [MainThread]: On master: COMMIT
[0m18:23:08.162256 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:23:08.162879 [debug] [MainThread]: On master: Close
[0m18:23:08.164936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:08.165435 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m18:23:08.165435 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m18:23:08.166633 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m18:23:08.167134 [info ] [MainThread]: 
[0m18:23:08.168153 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 6.72 seconds (6.72s).
[0m18:23:08.172687 [debug] [MainThread]: Command end result
[0m18:23:08.196352 [info ] [MainThread]: 
[0m18:23:08.197353 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m18:23:08.198352 [info ] [MainThread]: 
[0m18:23:08.199349 [error] [MainThread]:   Database Error in model btc_perp_data_1h_current_and_history (models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_1hour_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_1hour_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:23:08.200348 [info ] [MainThread]: 
[0m18:23:08.201351 [error] [MainThread]:   Database Error in model btc_perp_data_1w_current_and_history (models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_1week_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_1week_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m18:23:08.202349 [info ] [MainThread]: 
[0m18:23:08.203349 [error] [MainThread]:   Database Error in model btc_perp_data_4h_current_and_history (models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_4hour_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_4hour_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m18:23:08.204348 [info ] [MainThread]: 
[0m18:23:08.205351 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m18:23:08.207351 [debug] [MainThread]: Command `dbt run` failed at 18:23:08.207351 after 7.38 seconds
[0m18:23:08.208361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E99060970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C19B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E9C19B5E0>]}
[0m18:23:08.208361 [debug] [MainThread]: Flushing usage events
[0m18:27:48.461891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCEF6109A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF1E62430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF1E62490>]}


============================== 18:27:48.467891 | df667337-6446-46c5-a20b-00763910733a ==============================
[0m18:27:48.467891 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:27:48.468997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:27:48.645037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCEFF1B850>]}
[0m18:27:48.725630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF1E0C700>]}
[0m18:27:48.726635 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m18:27:48.729993 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:27:48.842916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:27:48.843917 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m18:27:48.843917 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m18:27:48.844916 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m18:27:48.931864 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m18:27:48.954341 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m18:27:49.056877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m18:27:49.062386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2582760>]}
[0m18:27:49.086386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF240D100>]}
[0m18:27:49.086386 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:27:49.087386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF240DC10>]}
[0m18:27:49.089386 [info ] [MainThread]: 
[0m18:27:49.090437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:27:49.092388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m18:27:49.101386 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m18:27:49.102446 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m18:27:49.102446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:49.360245 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m18:27:49.362243 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m18:27:49.365244 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m18:27:49.374338 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:27:49.375347 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m18:27:49.375347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:49.553480 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:49.553480 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:27:49.554481 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m18:27:49.579358 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.0 seconds
[0m18:27:49.581358 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m18:27:49.602917 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m18:27:49.612793 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:49.612793 [debug] [MainThread]: On master: BEGIN
[0m18:27:49.612793 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:49.817438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:49.817438 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:49.818447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:49.852445 [debug] [MainThread]: SQL status: SELECT 43 in 0.0 seconds
[0m18:27:49.864002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2582820>]}
[0m18:27:49.864515 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:49.887061 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:49.888083 [debug] [MainThread]: On master: BEGIN
[0m18:27:49.932164 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:49.934243 [debug] [MainThread]: On master: COMMIT
[0m18:27:49.935247 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:49.936240 [debug] [MainThread]: On master: COMMIT
[0m18:27:49.959267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:49.960266 [debug] [MainThread]: On master: Close
[0m18:27:49.963267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:49.964264 [info ] [MainThread]: 
[0m18:27:49.984345 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m18:27:49.987342 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m18:27:49.990372 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m18:27:49.992317 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m18:27:50.003265 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.005274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 18:27:49.993321 => 18:27:50.005274
[0m18:27:50.007260 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m18:27:50.046327 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.049201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.049837 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m18:27:50.050262 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:27:50.234314 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:50.235302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.235302 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m18:27:50.263302 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:50.272938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.273959 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m18:27:50.297869 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:50.302862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.303862 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m18:27:50.327227 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:50.349499 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:27:50.350499 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.351500 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:27:50.381269 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:50.388185 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m18:27:50.392184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:27:50.393184 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m18:27:50.436286 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:50.438277 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 18:27:50.008270 => 18:27:50.438277
[0m18:27:50.439247 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m18:27:50.440287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2052EB0>]}
[0m18:27:50.440287 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.45s]
[0m18:27:50.441240 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m18:27:50.442207 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:27:50.443205 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m18:27:50.444204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m18:27:50.444204 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m18:27:50.448468 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.452466 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 18:27:50.445204 => 18:27:50.451484
[0m18:27:50.452466 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m18:27:50.460684 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.463232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.464714 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m18:27:50.465589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:50.650697 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:50.651627 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.652676 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m18:27:50.679628 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:50.685472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.686551 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m18:27:50.712226 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:50.718031 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.718923 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m18:27:50.743170 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:50.745164 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:27:50.746093 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.746093 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:27:50.775087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:50.779080 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m18:27:50.781080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:27:50.781080 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m18:27:50.815081 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:50.817081 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 18:27:50.453466 => 18:27:50.817081
[0m18:27:50.818081 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m18:27:50.819080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF262EFA0>]}
[0m18:27:50.820080 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.38s]
[0m18:27:50.821080 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:27:50.821080 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:27:50.822080 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m18:27:50.823080 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m18:27:50.824081 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m18:27:50.826085 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:27:50.828083 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 18:27:50.824081 => 18:27:50.828083
[0m18:27:50.829080 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m18:27:50.835081 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:27:50.837080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:27:50.838080 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m18:27:50.839079 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:51.021834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:51.022834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:27:51.022834 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m18:27:51.050258 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:51.055934 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:27:51.055934 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m18:27:51.078886 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:51.081184 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:27:51.081682 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:27:51.082182 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:27:51.111205 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:51.117203 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m18:27:51.118203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:27:51.119196 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m18:27:51.141197 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:51.143203 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 18:27:50.829080 => 18:27:51.143203
[0m18:27:51.144203 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m18:27:51.146197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF27F7CD0>]}
[0m18:27:51.147205 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.32s]
[0m18:27:51.148196 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:27:51.149198 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:27:51.150196 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m18:27:51.151197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m18:27:51.152212 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:27:51.156239 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:27:51.158891 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 18:27:51.152212 => 18:27:51.158391
[0m18:27:51.159689 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:27:51.166517 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:27:51.168785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:27:51.168785 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m18:27:51.169795 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:51.349193 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:51.350192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:27:51.350192 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m18:27:51.377382 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:51.383106 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:27:51.384112 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m18:27:51.406590 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:51.410106 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:27:51.410106 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:27:51.411108 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:27:51.443536 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:51.448004 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m18:27:51.449129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:27:51.449129 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m18:27:51.472122 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:51.475125 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 18:27:51.159770 => 18:27:51.474125
[0m18:27:51.475125 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m18:27:51.477125 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2626F10>]}
[0m18:27:51.477125 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m18:27:51.479119 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:27:51.479119 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:27:51.480128 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m18:27:51.481120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m18:27:51.482119 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m18:27:51.486544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:27:51.489537 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 18:27:51.482119 => 18:27:51.488538
[0m18:27:51.489537 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m18:27:51.497226 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:27:51.500594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:27:51.500594 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m18:27:51.501603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:51.684543 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:51.685542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:27:51.686542 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m18:27:51.714689 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:51.719264 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:27:51.720263 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m18:27:51.744110 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:51.745104 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:27:51.746105 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:27:51.746105 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:27:51.778233 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:51.783234 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m18:27:51.784235 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:27:51.784235 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m18:27:51.807234 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:51.811793 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 18:27:51.490538 => 18:27:51.811793
[0m18:27:51.813315 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m18:27:51.814775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF26EE550>]}
[0m18:27:51.815773 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.33s]
[0m18:27:51.816791 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:27:51.817791 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:27:51.818793 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m18:27:51.820790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m18:27:51.821791 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:27:51.828974 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:27:51.831404 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 18:27:51.821791 => 18:27:51.831404
[0m18:27:51.832863 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:27:51.839306 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:27:51.842307 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:27:51.842307 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m18:27:51.843316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:52.023721 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:52.024727 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:27:52.025227 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m18:27:52.054587 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:52.060782 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:27:52.061788 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m18:27:52.084652 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:52.087599 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:27:52.088139 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:27:52.088139 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:27:52.116870 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:52.121869 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m18:27:52.122869 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:27:52.123869 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m18:27:52.146870 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:52.148869 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 18:27:51.833291 => 18:27:52.148869
[0m18:27:52.149869 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m18:27:52.150869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF26EE550>]}
[0m18:27:52.150869 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.33s]
[0m18:27:52.151869 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:27:52.152869 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:27:52.153869 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m18:27:52.154869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m18:27:52.154869 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m18:27:52.158870 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:27:52.160868 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 18:27:52.154869 => 18:27:52.160868
[0m18:27:52.161869 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m18:27:52.167561 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:27:52.170560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:27:52.171560 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m18:27:52.171560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:52.369162 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:52.370169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:27:52.370169 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m18:27:52.399867 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:52.403866 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:27:52.405496 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m18:27:52.427426 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:52.429428 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:27:52.429428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:27:52.429428 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:27:52.457425 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:52.461427 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m18:27:52.462426 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:27:52.462426 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m18:27:52.485419 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:52.488420 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 18:27:52.161869 => 18:27:52.488420
[0m18:27:52.489420 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m18:27:52.490419 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF27F7CD0>]}
[0m18:27:52.491419 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.34s]
[0m18:27:52.492419 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:27:52.493485 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:27:52.494500 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m18:27:52.495517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m18:27:52.495517 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:27:52.499496 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:27:52.502419 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 18:27:52.496508 => 18:27:52.501432
[0m18:27:52.502419 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:27:52.509419 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:27:52.510425 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:27:52.511427 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m18:27:52.512425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:52.710601 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:52.711601 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:27:52.712600 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m18:27:52.739294 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:52.742878 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:27:52.743920 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m18:27:52.765673 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:52.767975 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:27:52.769038 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:27:52.770043 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:27:52.865174 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:52.869170 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m18:27:52.871170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:27:52.871170 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m18:27:52.897703 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:52.900582 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 18:27:52.502419 => 18:27:52.900081
[0m18:27:52.900582 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m18:27:52.902592 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF28025B0>]}
[0m18:27:52.902592 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.41s]
[0m18:27:52.904594 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:27:52.904594 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:27:52.905593 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m18:27:52.907592 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m18:27:52.907592 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m18:27:52.913210 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:27:52.915618 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 18:27:52.908592 => 18:27:52.915618
[0m18:27:52.916981 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m18:27:52.924050 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:27:52.926981 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:27:52.927981 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m18:27:52.927981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:53.135654 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:53.136659 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:27:53.136659 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m18:27:53.164652 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:53.168658 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:27:53.169657 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m18:27:53.192406 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:53.194407 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:27:53.195415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:27:53.195415 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:27:53.223407 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:53.228406 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m18:27:53.230407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:27:53.231406 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m18:27:53.253406 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:53.256406 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 18:27:52.916981 => 18:27:53.256406
[0m18:27:53.257407 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m18:27:53.259407 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF277D760>]}
[0m18:27:53.260407 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.35s]
[0m18:27:53.261407 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:27:53.261407 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:27:53.262406 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m18:27:53.263407 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m18:27:53.263407 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:27:53.267406 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:27:53.269407 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 18:27:53.264408 => 18:27:53.269407
[0m18:27:53.270407 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:27:53.276406 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:27:53.278407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:27:53.279406 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m18:27:53.279406 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:53.463901 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:53.464401 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:27:53.465421 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m18:27:53.492416 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:53.496413 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:27:53.496413 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m18:27:53.520417 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:53.523416 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:27:53.523416 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:27:53.524416 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:27:53.552421 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:53.558233 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m18:27:53.559756 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:27:53.560756 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m18:27:53.582964 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:53.586441 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 18:27:53.270407 => 18:27:53.585964
[0m18:27:53.587409 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m18:27:53.587909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF277D730>]}
[0m18:27:53.588925 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m18:27:53.590923 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:27:53.591924 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:27:53.592924 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m18:27:53.593924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m18:27:53.593924 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m18:27:53.598924 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:27:53.600999 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 18:27:53.594924 => 18:27:53.600999
[0m18:27:53.600999 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m18:27:53.606929 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:27:53.609932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:27:53.609932 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m18:27:53.610923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:53.795906 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:53.796923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:27:53.797899 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m18:27:53.824441 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:53.829442 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:27:53.830441 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m18:27:53.852897 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:53.855934 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:27:53.856432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:27:53.857443 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:27:53.884449 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:53.887443 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m18:27:53.888449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:27:53.889445 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m18:27:53.911448 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:53.913448 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 18:27:53.601990 => 18:27:53.913448
[0m18:27:53.913448 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m18:27:53.915452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2402910>]}
[0m18:27:53.916449 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.32s]
[0m18:27:53.917442 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:27:53.917442 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:27:53.918448 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m18:27:53.919451 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m18:27:53.919451 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:27:53.922442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:27:53.924444 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 18:27:53.919451 => 18:27:53.924444
[0m18:27:53.925442 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:27:53.930443 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:27:53.932443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:27:53.932443 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m18:27:53.933452 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:54.113707 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.114859 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:27:54.116105 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m18:27:54.142946 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:54.148413 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:27:54.149174 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m18:27:54.174076 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:54.176575 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:27:54.177075 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:27:54.177575 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:27:54.203089 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:54.208083 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m18:27:54.210089 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:27:54.210089 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m18:27:54.232823 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:54.235531 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 18:27:53.925442 => 18:27:54.235027
[0m18:27:54.235531 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m18:27:54.237305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF274A490>]}
[0m18:27:54.238324 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.32s]
[0m18:27:54.239325 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:27:54.239325 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:27:54.240323 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m18:27:54.241324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m18:27:54.242379 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:27:54.245897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:27:54.247891 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 18:27:54.242379 => 18:27:54.246897
[0m18:27:54.248898 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:27:54.254896 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:27:54.256890 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:27:54.257890 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m18:27:54.257890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:54.441720 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.441720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:27:54.442719 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_15min_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:27:54.476324 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:54.481297 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:27:54.482263 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m18:27:54.506267 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:54.509268 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m18:27:54.509268 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:27:54.510262 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m18:27:54.540268 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:54.544268 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m18:27:54.546273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:27:54.547262 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m18:27:54.570262 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:54.573268 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 18:27:54.248898 => 18:27:54.572268
[0m18:27:54.574269 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m18:27:54.575270 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2726400>]}
[0m18:27:54.576269 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.33s]
[0m18:27:54.577268 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:27:54.578269 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:27:54.578269 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m18:27:54.579271 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m18:27:54.579271 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:27:54.584262 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:27:54.587262 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 18:27:54.580271 => 18:27:54.587262
[0m18:27:54.588263 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:27:54.595820 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:27:54.598820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:27:54.598820 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m18:27:54.599820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:54.797618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.798618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:27:54.799618 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_1hour_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:27:54.823959 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "wizetrading.v_btcusd_perp_1hour_history" does not exist
LINE 68:         FROM wizetrading.v_btcusd_perp_1hour_history
                      ^

[0m18:27:54.826270 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: ROLLBACK
[0m18:27:54.850304 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 18:27:54.588263 => 18:27:54.849304
[0m18:27:54.851314 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m18:27:54.856305 [debug] [Thread-1  ]: Database Error in model btc_perp_data_1h_current_and_history (models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_1hour_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_1hour_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:27:54.857305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF27B69A0>]}
[0m18:27:54.858304 [error] [Thread-1  ]: 14 of 17 ERROR creating sql view model wizetrading.btc_perp_data_1h_current_and_history  [[31mERROR[0m in 0.28s]
[0m18:27:54.860305 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:27:54.861304 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:27:54.862304 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m18:27:54.863305 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m18:27:54.864311 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:27:54.870310 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:27:54.873305 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 18:27:54.864311 => 18:27:54.872303
[0m18:27:54.874584 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:27:54.881092 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:27:54.885683 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:27:54.886182 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m18:27:54.887273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:55.089760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.090768 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:27:55.091767 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:27:55.126762 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:55.134377 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:27:55.135610 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m18:27:55.160137 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:55.162135 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m18:27:55.163135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:27:55.163135 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m18:27:55.192139 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:55.197134 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m18:27:55.199135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:27:55.200135 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m18:27:55.222227 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:55.225208 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 18:27:54.875080 => 18:27:55.224135
[0m18:27:55.225208 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m18:27:55.227215 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2726400>]}
[0m18:27:55.227215 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.36s]
[0m18:27:55.229145 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:27:55.229145 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:27:55.230140 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m18:27:55.231140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m18:27:55.231140 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:27:55.235765 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:27:55.238759 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 18:27:55.231140 => 18:27:55.237759
[0m18:27:55.239760 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:27:55.245431 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:27:55.248429 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:27:55.249430 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m18:27:55.250430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:55.454959 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.455959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:27:55.456960 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:27:55.486953 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:55.491953 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:27:55.491953 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m18:27:55.514953 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:55.517954 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m18:27:55.518953 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:27:55.519954 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m18:27:55.556953 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:55.560959 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m18:27:55.562953 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:27:55.562953 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m18:27:55.585673 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:55.588690 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 18:27:55.239760 => 18:27:55.588690
[0m18:27:55.589690 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m18:27:55.590689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2775B20>]}
[0m18:27:55.591683 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.36s]
[0m18:27:55.593691 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:27:55.593691 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:27:55.594689 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m18:27:55.595692 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m18:27:55.595692 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:27:55.601690 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:27:55.603692 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 18:27:55.596689 => 18:27:55.603692
[0m18:27:55.604690 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:27:55.611689 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:27:55.614684 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:27:55.615684 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m18:27:55.615684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:27:55.819844 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.821840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:27:55.822840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM wizetrading.v_btcusd_perp_5min_history
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:27:55.856127 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:27:55.863132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:27:55.864126 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m18:27:55.888194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:27:55.891128 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:27:55.892128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:27:55.893158 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:27:55.920126 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:27:55.926140 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m18:27:55.928127 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:27:55.929137 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m18:27:55.952126 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:27:55.953133 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 18:27:55.605689 => 18:27:55.953133
[0m18:27:55.954133 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m18:27:55.955133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df667337-6446-46c5-a20b-00763910733a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF28D0FD0>]}
[0m18:27:55.955133 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.36s]
[0m18:27:55.956133 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:27:55.958127 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:55.958127 [debug] [MainThread]: On master: BEGIN
[0m18:27:55.959134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:56.138790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:56.139297 [debug] [MainThread]: On master: COMMIT
[0m18:27:56.140337 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:56.141341 [debug] [MainThread]: On master: COMMIT
[0m18:27:56.163218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:56.164233 [debug] [MainThread]: On master: Close
[0m18:27:56.165233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:56.166234 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m18:27:56.166234 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m18:27:56.166234 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m18:27:56.167233 [info ] [MainThread]: 
[0m18:27:56.168233 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 7.08 seconds (7.08s).
[0m18:27:56.171232 [debug] [MainThread]: Command end result
[0m18:27:56.187926 [info ] [MainThread]: 
[0m18:27:56.189426 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:27:56.190342 [info ] [MainThread]: 
[0m18:27:56.190650 [error] [MainThread]:   Database Error in model btc_perp_data_1h_current_and_history (models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql)
  relation "wizetrading.v_btcusd_perp_1hour_history" does not exist
  LINE 68:         FROM wizetrading.v_btcusd_perp_1hour_history
                        ^
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:27:56.191687 [info ] [MainThread]: 
[0m18:27:56.191687 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=1 SKIP=0 TOTAL=17
[0m18:27:56.193105 [debug] [MainThread]: Command `dbt run` failed at 18:27:56.193105 after 7.77 seconds
[0m18:27:56.194335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCEF6109A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF240DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCF2340070>]}
[0m18:27:56.194335 [debug] [MainThread]: Flushing usage events
[0m18:29:24.076529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB28B19A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5145430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5145490>]}


============================== 18:29:24.081529 | 24242ef2-6ae0-468e-83f3-324bfe47a690 ==============================
[0m18:29:24.081529 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:29:24.082529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:29:24.270705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB31BD880>]}
[0m18:29:24.342585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB512C700>]}
[0m18:29:24.343585 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m18:29:24.351585 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:29:24.475585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:29:24.475585 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m18:29:24.476585 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:29:24.476585 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:29:24.565798 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m18:29:24.581572 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m18:29:24.586644 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m18:29:24.700659 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m18:29:24.707383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB56C7400>]}
[0m18:29:24.729392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB55F7FD0>]}
[0m18:29:24.730392 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:29:24.731393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB55F7CA0>]}
[0m18:29:24.733391 [info ] [MainThread]: 
[0m18:29:24.734383 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:24.736432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m18:29:24.745022 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m18:29:24.746023 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m18:29:24.747035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:24.967852 [debug] [ThreadPool]: SQL status: SELECT 41 in 0.0 seconds
[0m18:29:24.970871 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m18:29:24.974851 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m18:29:24.983896 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:29:24.984896 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m18:29:24.984896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:25.167495 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:29:25.168490 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:29:25.169490 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m18:29:25.195123 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.0 seconds
[0m18:29:25.197838 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m18:29:25.213992 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m18:29:25.230520 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:25.230520 [debug] [MainThread]: On master: BEGIN
[0m18:29:25.230520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:25.446156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:25.446156 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:25.447168 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:25.481448 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m18:29:25.497149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5347820>]}
[0m18:29:25.497149 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:25.522398 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:25.524414 [debug] [MainThread]: On master: BEGIN
[0m18:29:25.567872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:25.568878 [debug] [MainThread]: On master: COMMIT
[0m18:29:25.568878 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:25.568878 [debug] [MainThread]: On master: COMMIT
[0m18:29:25.591221 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:29:25.591719 [debug] [MainThread]: On master: Close
[0m18:29:25.592217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:25.593227 [info ] [MainThread]: 
[0m18:29:25.601619 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:25.602123 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m18:29:25.602966 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m18:29:25.603466 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:25.614478 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:25.616478 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 18:29:25.603466 => 18:29:25.616478
[0m18:29:25.617479 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:25.647483 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:25.649486 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:25.650479 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m18:29:25.650479 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:29:25.841095 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:25.842439 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:25.842945 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m18:29:25.872954 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:25.883011 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:25.884012 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m18:29:25.906951 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:25.911564 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:25.911947 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m18:29:25.943152 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:25.968356 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:29:25.969373 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:25.970374 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m18:29:25.997395 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:26.009077 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m18:29:26.015663 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:26.016662 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m18:29:26.061875 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:26.064369 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 18:29:25.617479 => 18:29:26.063874
[0m18:29:26.064874 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m18:29:26.065874 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A9E610>]}
[0m18:29:26.066874 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.46s]
[0m18:29:26.067869 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:26.068370 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:26.069369 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m18:29:26.070378 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m18:29:26.070378 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:26.073368 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.075369 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 18:29:26.070874 => 18:29:26.074869
[0m18:29:26.075869 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:26.082980 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.085661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.086186 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m18:29:26.086719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:26.275963 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:26.276700 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.277202 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m18:29:26.304080 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:26.310067 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.311067 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m18:29:26.333970 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:26.338960 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.339959 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m18:29:26.363333 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:26.366266 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:29:26.367271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.367271 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m18:29:26.396267 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:26.402265 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m18:29:26.403271 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:26.404272 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m18:29:26.432154 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:26.434210 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 18:29:26.076434 => 18:29:26.434210
[0m18:29:26.434210 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m18:29:26.435220 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB593D8B0>]}
[0m18:29:26.436213 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.37s]
[0m18:29:26.437152 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:26.438221 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:26.439219 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m18:29:26.440195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m18:29:26.440195 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:26.444225 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:26.447160 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 18:29:26.441221 => 18:29:26.446150
[0m18:29:26.448171 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:26.454157 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:26.456159 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:26.456159 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m18:29:26.457152 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:26.640909 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:26.641841 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:26.642840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m18:29:26.670840 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:26.674840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:26.674840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m18:29:26.696840 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:26.699840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:29:26.699840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:26.700840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m18:29:26.738350 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:26.740356 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m18:29:26.741356 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:26.741356 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m18:29:26.764352 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:26.767351 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 18:29:26.448171 => 18:29:26.766351
[0m18:29:26.768351 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m18:29:26.769351 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB593DA00>]}
[0m18:29:26.770351 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.33s]
[0m18:29:26.771350 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:26.771350 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:26.772350 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m18:29:26.773574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m18:29:26.773574 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:26.773574 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:26.773574 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 18:29:26.773574 => 18:29:26.773574
[0m18:29:26.779905 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:26.788073 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:26.790307 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:26.790307 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m18:29:26.790307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:26.983377 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:26.984387 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:26.985383 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m18:29:27.012435 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:27.017377 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:27.017377 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m18:29:27.040448 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:27.043459 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:29:27.044451 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:27.045441 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m18:29:27.073367 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:27.076374 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m18:29:27.077374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:27.078374 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m18:29:27.100490 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:27.103442 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 18:29:26.779905 => 18:29:27.103442
[0m18:29:27.103975 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m18:29:27.106938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A9E610>]}
[0m18:29:27.107669 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m18:29:27.109145 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:27.109145 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:27.110980 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m18:29:27.112414 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m18:29:27.112414 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:27.117422 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:27.120423 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 18:29:27.113415 => 18:29:27.119425
[0m18:29:27.120423 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:27.127421 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:27.130415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:27.130415 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m18:29:27.131416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:27.315885 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:27.316385 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:27.317386 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m18:29:27.343544 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:27.349549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:27.350481 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m18:29:27.374180 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:27.377079 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:29:27.377846 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:27.378515 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m18:29:27.405932 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:27.409888 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m18:29:27.411632 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:27.412631 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m18:29:27.434842 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:27.437773 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 18:29:27.121421 => 18:29:27.437773
[0m18:29:27.438839 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m18:29:27.440846 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB59A3730>]}
[0m18:29:27.441841 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.33s]
[0m18:29:27.442772 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:27.443772 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:27.444770 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m18:29:27.445780 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m18:29:27.446781 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:27.453778 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:27.456774 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 18:29:27.447784 => 18:29:27.455778
[0m18:29:27.457771 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:27.465772 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:27.467772 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:27.468771 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m18:29:27.468771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:27.652865 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:27.653868 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:27.653868 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m18:29:27.680860 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:27.686867 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:27.688008 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m18:29:27.710557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:27.713645 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:29:27.713645 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:27.714644 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m18:29:27.741643 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:27.746998 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m18:29:27.748962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:27.748962 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m18:29:27.771388 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:27.775249 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 18:29:27.457771 => 18:29:27.774387
[0m18:29:27.775890 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m18:29:27.776949 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB58F1C10>]}
[0m18:29:27.777747 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.33s]
[0m18:29:27.779207 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:27.779528 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:27.780348 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m18:29:27.782701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m18:29:27.782701 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:27.788450 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:27.792971 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 18:29:27.783701 => 18:29:27.792971
[0m18:29:27.794171 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:27.801173 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:27.805178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:27.805178 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m18:29:27.805178 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:27.992158 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:27.993158 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:27.993158 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m18:29:28.021073 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:28.027076 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:28.028073 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m18:29:28.051146 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:28.054659 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:29:28.055303 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:28.055803 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m18:29:28.082760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:28.087876 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m18:29:28.089057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:28.090068 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m18:29:28.112816 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:28.116014 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 18:29:27.794171 => 18:29:28.115015
[0m18:29:28.116697 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m18:29:28.117847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A9E610>]}
[0m18:29:28.119920 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.34s]
[0m18:29:28.120855 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:28.121927 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:28.121927 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m18:29:28.123856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m18:29:28.123856 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:28.130855 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:28.134952 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 18:29:28.124932 => 18:29:28.133952
[0m18:29:28.135453 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:28.144108 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:28.146879 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:28.148367 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m18:29:28.149366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:28.332943 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:28.333953 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:28.333953 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m18:29:28.361221 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:28.365221 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:28.365221 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m18:29:28.387465 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:28.390467 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:29:28.391469 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:28.392466 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m18:29:28.418524 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:28.423618 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m18:29:28.425629 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:28.426646 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m18:29:28.449855 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:28.451254 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 18:29:28.136477 => 18:29:28.451254
[0m18:29:28.453816 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m18:29:28.455495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB58F4E50>]}
[0m18:29:28.455991 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.33s]
[0m18:29:28.455991 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:28.459505 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:28.460002 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m18:29:28.460002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m18:29:28.460002 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:28.467821 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:28.471819 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 18:29:28.460002 => 18:29:28.470815
[0m18:29:28.471819 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:28.482226 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:28.484736 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:28.485737 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m18:29:28.486737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:28.674068 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:28.674068 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:28.675129 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m18:29:28.702128 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:28.708130 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:28.709130 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m18:29:28.731135 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:28.734093 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:29:28.734093 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:28.735094 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m18:29:28.763831 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:28.768983 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m18:29:28.769989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:28.770990 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m18:29:28.792698 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:28.794705 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 18:29:28.473166 => 18:29:28.793707
[0m18:29:28.794705 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m18:29:28.795705 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB59A5BB0>]}
[0m18:29:28.796706 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.34s]
[0m18:29:28.797700 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:28.797700 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:28.798700 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m18:29:28.799701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m18:29:28.800700 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:28.805699 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:28.807699 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 18:29:28.801699 => 18:29:28.807699
[0m18:29:28.808699 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:28.816874 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:28.819716 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:28.820743 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m18:29:28.821743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:29.002553 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:29.003053 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:29.004153 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m18:29:29.034230 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:29.039309 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:29.040258 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m18:29:29.061286 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:29.063233 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:29:29.064232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:29.064232 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m18:29:29.090819 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:29.096719 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m18:29:29.098453 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:29.099737 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m18:29:29.122011 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:29.125011 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 18:29:28.809701 => 18:29:29.124005
[0m18:29:29.126005 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m18:29:29.127591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB58BFC10>]}
[0m18:29:29.128621 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m18:29:29.129634 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:29.130624 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:29.131623 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m18:29:29.133623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m18:29:29.133623 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:29.138622 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:29.141622 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 18:29:29.134623 => 18:29:29.140624
[0m18:29:29.141622 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:29.150227 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:29.153246 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:29.154293 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m18:29:29.155227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:29.354848 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:29.355915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:29.356852 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m18:29:29.383373 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:29.391372 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:29.392375 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m18:29:29.413688 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:29.417688 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:29:29.419688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:29.420688 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m18:29:29.448326 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:29.455127 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m18:29:29.456186 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:29.456186 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m18:29:29.479132 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:29.481131 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 18:29:29.142622 => 18:29:29.480131
[0m18:29:29.481131 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m18:29:29.483131 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A43160>]}
[0m18:29:29.485133 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.35s]
[0m18:29:29.486132 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:29.487131 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:29.487131 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m18:29:29.488131 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m18:29:29.488131 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:29.492131 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:29.493133 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 18:29:29.489131 => 18:29:29.493133
[0m18:29:29.494125 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:29.501126 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:29.503139 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:29.504126 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m18:29:29.505134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:29.698265 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:29.699265 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:29.700269 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m18:29:29.727259 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:29.731261 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:29.732259 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m18:29:29.754260 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:29.757260 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:29:29.757260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:29.758262 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m18:29:29.783260 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:29.788265 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m18:29:29.790260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:29.791263 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m18:29:29.813763 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:29.815763 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 18:29:29.494125 => 18:29:29.815763
[0m18:29:29.816763 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m18:29:29.817901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A43160>]}
[0m18:29:29.818918 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m18:29:29.820972 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:29.821917 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:29.822923 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m18:29:29.823923 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m18:29:29.824923 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:29.830916 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:29.834038 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 18:29:29.824923 => 18:29:29.834038
[0m18:29:29.835465 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:29.843608 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:29.847608 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:29.849048 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m18:29:29.849299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:30.034951 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:30.036131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:30.038145 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:29:30.069878 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:30.076934 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:30.076934 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m18:29:30.101157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:30.103162 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m18:29:30.104162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:30.104162 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m18:29:30.131163 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:30.135210 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m18:29:30.137209 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:30.137209 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m18:29:30.159449 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:30.161238 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 18:29:29.836510 => 18:29:30.161238
[0m18:29:30.162237 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m18:29:30.164237 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A7EB80>]}
[0m18:29:30.164237 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.34s]
[0m18:29:30.166241 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:30.167239 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:30.168382 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m18:29:30.169804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m18:29:30.170834 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:30.176994 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:30.181926 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 18:29:30.170834 => 18:29:30.180932
[0m18:29:30.182625 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:30.190663 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:30.195060 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:30.195638 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m18:29:30.196707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:30.398675 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:30.400025 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:30.401553 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:29:30.433900 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:30.438896 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:30.438896 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m18:29:30.464419 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:30.468112 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m18:29:30.469170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:30.470239 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m18:29:30.499477 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:30.502988 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m18:29:30.504988 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:30.504988 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m18:29:30.529241 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:30.531511 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 18:29:30.182625 => 18:29:30.531511
[0m18:29:30.532049 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m18:29:30.533668 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5AC3760>]}
[0m18:29:30.534706 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.36s]
[0m18:29:30.535768 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:30.536394 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:30.536917 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m18:29:30.538479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m18:29:30.539050 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:30.545392 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:30.548565 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 18:29:30.539050 => 18:29:30.548024
[0m18:29:30.549086 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:30.557504 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:30.561434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:30.562433 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m18:29:30.562433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:30.763944 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:30.764948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:30.765938 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:29:30.801261 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:30.807095 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:30.808029 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m18:29:30.832027 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:30.835028 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m18:29:30.836027 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:30.837028 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m18:29:30.868920 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:30.873926 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m18:29:30.874920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:30.875933 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m18:29:30.899920 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:30.902919 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 18:29:30.549607 => 18:29:30.902919
[0m18:29:30.903921 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m18:29:30.904929 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB52F2EB0>]}
[0m18:29:30.905934 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.37s]
[0m18:29:30.906926 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:30.907921 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:30.908921 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m18:29:30.909919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m18:29:30.910931 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:30.915620 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:30.918609 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 18:29:30.910931 => 18:29:30.918609
[0m18:29:30.919616 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:30.926609 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:30.929615 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:30.930609 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m18:29:30.930609 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:31.113928 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:31.114681 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:31.116022 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:29:31.148169 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:31.154142 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:31.155143 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m18:29:31.178285 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:31.182284 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m18:29:31.183284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:31.184285 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m18:29:31.211506 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:31.216501 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m18:29:31.218501 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:31.219504 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m18:29:31.241612 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:31.245620 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 18:29:30.919616 => 18:29:31.244618
[0m18:29:31.246618 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m18:29:31.247618 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB599AF70>]}
[0m18:29:31.248618 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.34s]
[0m18:29:31.250248 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:31.251262 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:31.252262 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m18:29:31.253264 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m18:29:31.254264 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:31.259264 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:31.262263 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 18:29:31.254264 => 18:29:31.262263
[0m18:29:31.263263 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:31.271816 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:31.274824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:31.275821 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m18:29:31.276819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:29:31.481487 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m18:29:31.482494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:31.483487 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m18:29:31.516934 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:31.520933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:31.520933 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m18:29:31.543937 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:31.546936 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:29:31.547941 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:31.548937 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m18:29:31.577007 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m18:29:31.580928 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m18:29:31.582935 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:31.582935 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m18:29:31.606927 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:31.608933 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 18:29:31.263263 => 18:29:31.608933
[0m18:29:31.609939 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m18:29:31.609939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24242ef2-6ae0-468e-83f3-324bfe47a690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB59ADD90>]}
[0m18:29:31.610934 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.36s]
[0m18:29:31.612942 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:31.614934 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:31.615934 [debug] [MainThread]: On master: BEGIN
[0m18:29:31.615934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:29:31.816738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:31.817737 [debug] [MainThread]: On master: COMMIT
[0m18:29:31.817737 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:31.817737 [debug] [MainThread]: On master: COMMIT
[0m18:29:31.839744 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:29:31.839744 [debug] [MainThread]: On master: Close
[0m18:29:31.840744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:31.840744 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m18:29:31.841744 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m18:29:31.841744 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m18:29:31.842747 [info ] [MainThread]: 
[0m18:29:31.842747 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m18:29:31.845744 [debug] [MainThread]: Command end result
[0m18:29:31.855815 [info ] [MainThread]: 
[0m18:29:31.855815 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:31.865271 [info ] [MainThread]: 
[0m18:29:31.866675 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m18:29:31.867672 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:31.867672 after 7.83 seconds
[0m18:29:31.868672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB28B19A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A0FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DB5A6A820>]}
[0m18:29:31.868672 [debug] [MainThread]: Flushing usage events
[0m18:29:43.607358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C057E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C2E0A580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C2E0AC10>]}


============================== 18:29:43.613358 | fdbe5417-6adb-487f-bb3a-9371658a4299 ==============================
[0m18:29:43.613358 [info ] [MainThread]: Running with dbt=1.7.11
[0m18:29:43.614357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:43.811457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdbe5417-6adb-487f-bb3a-9371658a4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C0E685B0>]}
[0m18:29:43.886229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdbe5417-6adb-487f-bb3a-9371658a4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C3093280>]}
[0m18:29:43.887230 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m18:29:43.896244 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m18:29:44.005539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:29:44.005539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:29:44.005539 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m18:29:44.021252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdbe5417-6adb-487f-bb3a-9371658a4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C33BE250>]}
[0m18:29:44.021252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdbe5417-6adb-487f-bb3a-9371658a4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C302CE20>]}
[0m18:29:44.021252 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:29:44.021252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdbe5417-6adb-487f-bb3a-9371658a4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C30FC8E0>]}
[0m18:29:44.021252 [info ] [MainThread]: 
[0m18:29:44.021252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:44.037049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m18:29:44.047397 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:29:44.048396 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m18:29:44.048396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:44.268997 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:29:44.268997 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m18:29:44.270003 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m18:29:44.298004 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m18:29:44.303003 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m18:29:44.325632 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m18:29:44.345632 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:44.346641 [debug] [MainThread]: On master: BEGIN
[0m18:29:44.346641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:44.534214 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:44.536213 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:44.536213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:44.570730 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m18:29:44.585135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdbe5417-6adb-487f-bb3a-9371658a4299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C33D5AC0>]}
[0m18:29:44.586137 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:44.608135 [debug] [MainThread]: On master: Close
[0m18:29:44.610136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:44.611128 [info ] [MainThread]: 
[0m18:29:44.620127 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:44.621137 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m18:29:44.622135 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:44.631300 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m18:29:44.631300 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 18:29:44.623135 => 18:29:44.631300
[0m18:29:44.631300 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:44.631300 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 18:29:44.631300 => 18:29:44.631300
[0m18:29:44.631300 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m18:29:44.631300 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:44.631300 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m18:29:44.631300 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:44.642423 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m18:29:44.645265 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 18:29:44.631300 => 18:29:44.644411
[0m18:29:44.645807 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:44.645807 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 18:29:44.645807 => 18:29:44.645807
[0m18:29:44.645807 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m18:29:44.645807 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:44.645807 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m18:29:44.645807 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:44.645807 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m18:29:44.645807 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 18:29:44.645807 => 18:29:44.645807
[0m18:29:44.645807 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:44.645807 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 18:29:44.645807 => 18:29:44.645807
[0m18:29:44.663199 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m18:29:44.664198 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:44.665261 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m18:29:44.665261 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:44.707206 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m18:29:44.710198 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 18:29:44.666307 => 18:29:44.710198
[0m18:29:44.711198 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:44.712198 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 18:29:44.712198 => 18:29:44.712198
[0m18:29:44.713197 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m18:29:44.713197 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:44.714205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m18:29:44.716204 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:44.725204 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m18:29:44.727204 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 18:29:44.717204 => 18:29:44.727204
[0m18:29:44.728204 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:44.728204 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 18:29:44.728204 => 18:29:44.728204
[0m18:29:44.729204 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m18:29:44.730203 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:44.731203 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m18:29:44.731203 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:44.735203 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m18:29:44.736204 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 18:29:44.731203 => 18:29:44.736204
[0m18:29:44.736204 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:44.737204 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 18:29:44.737204 => 18:29:44.737204
[0m18:29:44.738204 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m18:29:44.738204 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:44.739205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m18:29:44.740204 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:44.742203 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m18:29:44.743203 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 18:29:44.740204 => 18:29:44.743203
[0m18:29:44.744204 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:44.744204 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 18:29:44.744204 => 18:29:44.744204
[0m18:29:44.745200 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m18:29:44.746197 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:44.747204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m18:29:44.747204 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:44.750203 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m18:29:44.752205 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 18:29:44.748204 => 18:29:44.751204
[0m18:29:44.752205 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:44.753197 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 18:29:44.753197 => 18:29:44.753197
[0m18:29:44.754211 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m18:29:44.754211 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:44.755204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m18:29:44.756204 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:44.758204 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m18:29:44.760205 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 18:29:44.756204 => 18:29:44.760205
[0m18:29:44.761203 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:44.761203 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 18:29:44.761203 => 18:29:44.761203
[0m18:29:44.763205 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m18:29:44.763205 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:44.764204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m18:29:44.765204 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:44.767203 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m18:29:44.769197 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 18:29:44.765204 => 18:29:44.768203
[0m18:29:44.770080 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:44.770080 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 18:29:44.770080 => 18:29:44.770080
[0m18:29:44.772110 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m18:29:44.773123 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:44.775114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m18:29:44.775114 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:44.780113 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m18:29:44.782107 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 18:29:44.776114 => 18:29:44.781113
[0m18:29:44.782107 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:44.783108 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 18:29:44.783108 => 18:29:44.783108
[0m18:29:44.784114 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m18:29:44.785114 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:44.786117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m18:29:44.788114 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:44.792113 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m18:29:44.793113 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 18:29:44.788114 => 18:29:44.793113
[0m18:29:44.794114 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:44.795109 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 18:29:44.794114 => 18:29:44.795109
[0m18:29:44.796114 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m18:29:44.797114 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:44.797114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m18:29:44.798113 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:44.802113 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m18:29:44.805114 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 18:29:44.798113 => 18:29:44.804108
[0m18:29:44.805114 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:44.805114 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 18:29:44.805114 => 18:29:44.805114
[0m18:29:44.806108 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m18:29:44.807279 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:44.807428 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m18:29:44.808678 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:44.812258 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m18:29:44.814334 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 18:29:44.809093 => 18:29:44.813324
[0m18:29:44.814334 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:44.815008 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 18:29:44.815008 => 18:29:44.815008
[0m18:29:44.815517 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m18:29:44.815517 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:44.817141 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m18:29:44.817512 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:44.820546 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m18:29:44.822070 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 18:29:44.817587 => 18:29:44.822070
[0m18:29:44.822070 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:44.823078 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 18:29:44.822070 => 18:29:44.822070
[0m18:29:44.823078 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m18:29:44.824075 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:44.825074 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m18:29:44.825074 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:44.828074 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m18:29:44.830077 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 18:29:44.826074 => 18:29:44.830077
[0m18:29:44.830077 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:44.831074 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 18:29:44.831074 => 18:29:44.831074
[0m18:29:44.832232 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m18:29:44.832232 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:44.832232 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m18:29:44.832232 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:44.832232 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m18:29:44.832232 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 18:29:44.832232 => 18:29:44.832232
[0m18:29:44.832232 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:44.832232 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 18:29:44.832232 => 18:29:44.832232
[0m18:29:44.832232 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m18:29:44.832232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:44.832232 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m18:29:44.832232 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m18:29:44.832232 [debug] [MainThread]: Command end result
[0m18:29:44.866260 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:29:44.867245 [info ] [MainThread]: Building catalog
[0m18:29:44.871008 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m18:29:44.879377 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m18:29:44.879883 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m18:29:44.879883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:45.081936 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:29:45.082935 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m18:29:45.084935 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perptreated_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:29:45.158114 [debug] [ThreadPool]: SQL status: SELECT 570 in 0.0 seconds
[0m18:29:45.193327 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m18:29:45.214321 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m18:29:45.281626 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\target\catalog.json
[0m18:29:45.284663 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:29:45.284290 after 1.71 seconds
[0m18:29:45.284954 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:29:45.284954 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m18:29:45.285964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C057E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C30EEEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198C302CE20>]}
[0m18:29:45.285964 [debug] [MainThread]: Flushing usage events
[0m09:56:19.758527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025762FCEA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257658741F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025765874790>]}


============================== 09:56:19.771006 | b6d8eb97-38bd-4f1e-a704-2ee515ab9587 ==============================
[0m09:56:19.771006 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:56:19.779167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate --target-path docs/', 'target_path': 'docs/', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:56:20.044355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6d8eb97-38bd-4f1e-a704-2ee515ab9587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257658746A0>]}
[0m09:56:20.119121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6d8eb97-38bd-4f1e-a704-2ee515ab9587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025765D6C9A0>]}
[0m09:56:20.119121 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m09:56:20.129300 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:56:20.129300 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:56:20.129300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6d8eb97-38bd-4f1e-a704-2ee515ab9587', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025765E2AD90>]}
[0m09:56:20.932604 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m09:56:20.943924 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m09:56:20.943924 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m09:56:20.951987 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m09:56:20.954121 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m09:56:20.962155 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m09:56:20.964193 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m09:56:20.964193 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m09:56:20.964193 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m09:56:20.974363 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m09:56:20.974363 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m09:56:20.974363 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m09:56:20.974363 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m09:56:20.984537 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m09:56:20.984537 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m09:56:20.984537 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m09:56:20.984537 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m09:56:21.055524 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m09:56:21.055524 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named btc_perp_data_15m. Resources and their associated columns may only be described a single time. To fix this, remove one of the resource entries for btc_perp_data_15m in this file:
   - models\trading_perp_btc_data\schema.yml
  
[0m09:56:21.055524 [debug] [MainThread]: Command `dbt docs generate` failed at 09:56:21.055524 after 1.34 seconds
[0m09:56:21.055524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025762FCEA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002576611A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002576611A250>]}
[0m09:56:21.063639 [debug] [MainThread]: Flushing usage events
[0m09:57:53.020612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285932E9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285BB9A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285BB9ABE0>]}


============================== 09:57:53.028771 | 0d068b55-b03f-45a3-b27e-7647e8ed8bb2 ==============================
[0m09:57:53.028771 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:57:53.028771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --target-path docs/', 'target_path': 'docs/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:57:53.245824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d068b55-b03f-45a3-b27e-7647e8ed8bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022859C38AF0>]}
[0m09:57:53.316992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d068b55-b03f-45a3-b27e-7647e8ed8bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285BB42BE0>]}
[0m09:57:53.325054 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m09:57:53.327142 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:57:53.327142 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:57:53.335145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0d068b55-b03f-45a3-b27e-7647e8ed8bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285C176BB0>]}
[0m09:57:54.111700 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m09:57:54.123853 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m09:57:54.123853 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m09:57:54.131958 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m09:57:54.134049 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m09:57:54.142073 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m09:57:54.144154 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m09:57:54.144154 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m09:57:54.149987 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m09:57:54.152553 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m09:57:54.155069 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m09:57:54.155069 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m09:57:54.160285 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m09:57:54.162258 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m09:57:54.164289 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m09:57:54.164289 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m09:57:54.164289 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m09:57:54.233144 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m09:57:54.337092 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m09:57:54.347483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d068b55-b03f-45a3-b27e-7647e8ed8bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285C56E640>]}
[0m09:57:54.347483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d068b55-b03f-45a3-b27e-7647e8ed8bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285BBB8E80>]}
[0m09:57:54.355543 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:57:54.355543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d068b55-b03f-45a3-b27e-7647e8ed8bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285C1767C0>]}
[0m09:57:54.357557 [info ] [MainThread]: 
[0m09:57:54.358563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:54.361065 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m09:57:54.372755 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m09:57:54.373944 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m09:57:54.373944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:54.666053 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:57:54.666053 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m09:57:54.666053 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m09:57:54.697070 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m09:57:54.697070 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m09:57:54.725952 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m09:57:54.738465 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:54.738465 [debug] [MainThread]: On master: BEGIN
[0m09:57:54.738465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:54.934050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:57:54.935242 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:54.935242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:54.970329 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m09:57:54.977895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d068b55-b03f-45a3-b27e-7647e8ed8bb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285C5F4C10>]}
[0m09:57:54.977895 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:55.000797 [debug] [MainThread]: On master: Close
[0m09:57:55.001797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:55.002791 [info ] [MainThread]: 
[0m09:57:55.022060 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m09:57:55.022060 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m09:57:55.022060 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m09:57:55.029169 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m09:57:55.031267 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 09:57:55.022060 => 09:57:55.031267
[0m09:57:55.031267 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m09:57:55.031267 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 09:57:55.031267 => 09:57:55.031267
[0m09:57:55.035856 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m09:57:55.035856 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m09:57:55.036867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m09:57:55.036867 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m09:57:55.039861 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:57:55.041855 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 09:57:55.037864 => 09:57:55.041855
[0m09:57:55.041855 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m09:57:55.041855 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 09:57:55.041855 => 09:57:55.041855
[0m09:57:55.041855 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m09:57:55.041855 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m09:57:55.041855 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m09:57:55.041855 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m09:57:55.041855 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:57:55.050274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 09:57:55.041855 => 09:57:55.050274
[0m09:57:55.050274 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m09:57:55.050274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 09:57:55.050274 => 09:57:55.050274
[0m09:57:55.052535 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m09:57:55.052535 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:57:55.053547 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m09:57:55.054535 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:57:55.056535 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:57:55.058151 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 09:57:55.054535 => 09:57:55.058151
[0m09:57:55.058151 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:57:55.058151 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 09:57:55.058151 => 09:57:55.058151
[0m09:57:55.060801 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:57:55.060801 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m09:57:55.062829 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m09:57:55.062829 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m09:57:55.062829 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:57:55.062829 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 09:57:55.062829 => 09:57:55.062829
[0m09:57:55.062829 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m09:57:55.062829 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 09:57:55.062829 => 09:57:55.062829
[0m09:57:55.069361 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m09:57:55.069361 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:57:55.070422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m09:57:55.071350 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:57:55.073483 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:57:55.073483 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 09:57:55.071350 => 09:57:55.073483
[0m09:57:55.073483 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:57:55.073483 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 09:57:55.073483 => 09:57:55.073483
[0m09:57:55.073483 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:57:55.073483 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m09:57:55.073483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m09:57:55.073483 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m09:57:55.081519 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:57:55.083545 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 09:57:55.073483 => 09:57:55.083545
[0m09:57:55.083545 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m09:57:55.085904 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 09:57:55.085904 => 09:57:55.085904
[0m09:57:55.086969 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m09:57:55.086969 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:57:55.087985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m09:57:55.087985 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:57:55.090905 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:57:55.092905 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 09:57:55.087985 => 09:57:55.092905
[0m09:57:55.093906 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:57:55.093906 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 09:57:55.093906 => 09:57:55.093906
[0m09:57:55.094905 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:57:55.094905 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m09:57:55.094905 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m09:57:55.094905 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m09:57:55.094905 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:57:55.094905 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 09:57:55.094905 => 09:57:55.094905
[0m09:57:55.101952 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m09:57:55.101952 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 09:57:55.101952 => 09:57:55.101952
[0m09:57:55.102574 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m09:57:55.103639 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:57:55.104572 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m09:57:55.104572 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:57:55.107571 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:57:55.108571 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 09:57:55.104572 => 09:57:55.108571
[0m09:57:55.109571 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:57:55.109571 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 09:57:55.109571 => 09:57:55.109571
[0m09:57:55.110571 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:57:55.111571 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m09:57:55.111571 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m09:57:55.112571 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m09:57:55.114571 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:57:55.116578 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 09:57:55.112571 => 09:57:55.116578
[0m09:57:55.116578 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m09:57:55.117627 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 09:57:55.117627 => 09:57:55.117627
[0m09:57:55.118575 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m09:57:55.118575 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:57:55.119635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m09:57:55.119635 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:57:55.122699 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:57:55.124638 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 09:57:55.120693 => 09:57:55.123637
[0m09:57:55.124638 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:57:55.125648 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 09:57:55.124638 => 09:57:55.124638
[0m09:57:55.125648 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:57:55.126642 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:57:55.126642 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m09:57:55.127637 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:57:55.130636 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:57:55.133644 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 09:57:55.127637 => 09:57:55.133644
[0m09:57:55.133644 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:57:55.134637 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 09:57:55.134637 => 09:57:55.134637
[0m09:57:55.135637 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:57:55.135637 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:57:55.136722 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m09:57:55.136722 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:57:55.136722 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:57:55.143096 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 09:57:55.136722 => 09:57:55.143096
[0m09:57:55.143592 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:57:55.143592 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 09:57:55.143592 => 09:57:55.143592
[0m09:57:55.144612 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:57:55.144612 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:57:55.144612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m09:57:55.146604 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:57:55.150842 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:57:55.152838 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 09:57:55.146604 => 09:57:55.152838
[0m09:57:55.153339 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:57:55.153339 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 09:57:55.153339 => 09:57:55.153339
[0m09:57:55.154855 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:57:55.154855 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:57:55.154855 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m09:57:55.154855 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:57:55.154855 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:57:55.154855 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 09:57:55.154855 => 09:57:55.154855
[0m09:57:55.154855 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:57:55.162885 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 09:57:55.162885 => 09:57:55.162885
[0m09:57:55.162885 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:57:55.162885 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:57:55.164898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m09:57:55.164898 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:57:55.164898 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:57:55.164898 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 09:57:55.164898 => 09:57:55.164898
[0m09:57:55.164898 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:57:55.164898 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 09:57:55.164898 => 09:57:55.164898
[0m09:57:55.164898 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:57:55.172991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:57:55.172991 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m09:57:55.172991 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m09:57:55.175164 [debug] [MainThread]: Command end result
[0m09:57:55.195690 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m09:57:55.195690 [info ] [MainThread]: Building catalog
[0m09:57:55.203908 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m09:57:55.206162 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m09:57:55.206162 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m09:57:55.206162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:55.409508 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:57:55.409508 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m09:57:55.409508 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perptreated_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_current_and_history')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m09:57:55.483101 [debug] [ThreadPool]: SQL status: SELECT 570 in 0.0 seconds
[0m09:57:55.513777 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m09:57:55.534358 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m09:57:55.570890 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\dbt-wizetrading-demo\docs\catalog.json
[0m09:57:55.572911 [debug] [MainThread]: Command `dbt docs generate` succeeded at 09:57:55.571831 after 2.59 seconds
[0m09:57:55.572911 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m09:57:55.572911 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m09:57:55.573889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285932E9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022859C38AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002285BB42BE0>]}
[0m09:57:55.573889 [debug] [MainThread]: Flushing usage events
[0m09:59:31.810613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A9F5629A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA1DF6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA1DF6490>]}


============================== 09:59:31.810613 | 42d30579-51ba-4140-af9b-c79d724a8c00 ==============================
[0m09:59:31.810613 [info ] [MainThread]: Running with dbt=1.7.11
[0m09:59:31.818756 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:32.030270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A9FE537F0>]}
[0m09:59:32.115002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA1DD4700>]}
[0m09:59:32.116003 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m09:59:32.124944 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m09:59:32.229437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:59:32.229437 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m09:59:32.250285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m09:59:32.258421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA26967F0>]}
[0m09:59:32.312198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA23A5D30>]}
[0m09:59:32.312198 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m09:59:32.320268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA23C7190>]}
[0m09:59:32.322059 [info ] [MainThread]: 
[0m09:59:32.323060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:59:32.326054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m09:59:32.336055 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m09:59:32.337054 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m09:59:32.337054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:32.558551 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m09:59:32.560708 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m09:59:32.563707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m09:59:32.568799 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m09:59:32.568799 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m09:59:32.569797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:32.773564 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:59:32.773564 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m09:59:32.774563 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m09:59:32.800042 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m09:59:32.800042 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m09:59:32.820891 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m09:59:32.841626 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:32.841626 [debug] [MainThread]: On master: BEGIN
[0m09:59:32.841626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:33.047678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:59:33.047678 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:33.047678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:59:33.086875 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m09:59:33.089109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA25B5FD0>]}
[0m09:59:33.089109 [debug] [MainThread]: On master: ROLLBACK
[0m09:59:33.109921 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:33.109921 [debug] [MainThread]: On master: BEGIN
[0m09:59:33.162348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:59:33.162348 [debug] [MainThread]: On master: COMMIT
[0m09:59:33.162348 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:33.163361 [debug] [MainThread]: On master: COMMIT
[0m09:59:33.185582 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:59:33.186574 [debug] [MainThread]: On master: Close
[0m09:59:33.187572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:59:33.188498 [info ] [MainThread]: 
[0m09:59:33.192918 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m09:59:33.200981 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m09:59:33.201083 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m09:59:33.201083 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m09:59:33.208740 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.211282 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 09:59:33.201083 => 09:59:33.211282
[0m09:59:33.211282 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m09:59:33.242296 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.244385 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.244385 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m09:59:33.244385 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m09:59:33.448162 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:33.448162 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.449161 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m09:59:33.476342 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:33.484342 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.484342 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m09:59:33.509278 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:33.511336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.512351 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m09:59:33.530005 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:33.550678 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m09:59:33.550678 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.550678 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m09:59:33.581739 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:33.592119 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m09:59:33.592119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m09:59:33.592119 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m09:59:33.643847 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:33.643847 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 09:59:33.211282 => 09:59:33.643847
[0m09:59:33.643847 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m09:59:33.643847 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2816730>]}
[0m09:59:33.652052 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.44s]
[0m09:59:33.652052 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m09:59:33.654236 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m09:59:33.654236 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m09:59:33.654236 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m09:59:33.654236 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m09:59:33.654236 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:33.654236 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 09:59:33.654236 => 09:59:33.654236
[0m09:59:33.662329 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m09:59:33.666016 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:33.668025 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:33.668025 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m09:59:33.669113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:33.880671 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:33.880671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:33.880671 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m09:59:33.907656 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:33.911655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:33.911655 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m09:59:33.928795 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:33.939093 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:33.939093 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m09:59:33.959805 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:33.968005 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m09:59:33.968005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:33.968005 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m09:59:33.990868 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:34.001206 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m09:59:34.001206 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m09:59:34.001206 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m09:59:34.033616 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:34.035620 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 09:59:33.662329 => 09:59:34.035620
[0m09:59:34.035620 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m09:59:34.035620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2686220>]}
[0m09:59:34.037934 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.38s]
[0m09:59:34.038702 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m09:59:34.039210 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m09:59:34.039709 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m09:59:34.040216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m09:59:34.041550 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m09:59:34.042077 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:59:34.042077 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 09:59:34.041634 => 09:59:34.042077
[0m09:59:34.042077 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m09:59:34.049556 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:59:34.052871 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:59:34.052871 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m09:59:34.053517 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:34.266397 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:34.266939 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:59:34.267454 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m09:59:34.294127 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:34.297134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:59:34.298133 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m09:59:34.318740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:34.322616 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m09:59:34.323230 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:59:34.323230 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m09:59:34.350772 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:34.353032 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m09:59:34.354032 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m09:59:34.355031 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m09:59:34.377084 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:34.379090 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 09:59:34.042077 => 09:59:34.378094
[0m09:59:34.379090 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m09:59:34.380092 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA275A3D0>]}
[0m09:59:34.380092 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.34s]
[0m09:59:34.381090 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m09:59:34.382091 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:59:34.382091 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m09:59:34.383844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m09:59:34.383907 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:59:34.386914 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:59:34.387916 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 09:59:34.383907 => 09:59:34.387916
[0m09:59:34.387916 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:59:34.392573 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:59:34.393571 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:59:34.394572 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m09:59:34.394572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:34.596952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:34.596952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:59:34.596952 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m09:59:34.626044 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:34.626044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:59:34.626044 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m09:59:34.646477 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:34.658673 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m09:59:34.658821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:59:34.658821 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m09:59:34.688442 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:34.689956 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m09:59:34.691999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m09:59:34.691999 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m09:59:34.709674 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:34.709674 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 09:59:34.388920 => 09:59:34.709674
[0m09:59:34.709674 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m09:59:34.709674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2816730>]}
[0m09:59:34.717726 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m09:59:34.717726 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m09:59:34.719762 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m09:59:34.719762 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m09:59:34.719762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m09:59:34.719762 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m09:59:34.719762 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:59:34.719762 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 09:59:34.719762 => 09:59:34.719762
[0m09:59:34.719762 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m09:59:34.731004 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:59:34.733018 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:59:34.733018 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m09:59:34.733018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:34.934775 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:34.934775 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:59:34.934775 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m09:59:34.965845 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:34.976248 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:59:34.976248 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m09:59:35.005154 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:35.007359 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m09:59:35.007359 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:59:35.007359 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m09:59:35.037319 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:35.037319 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m09:59:35.045387 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m09:59:35.045387 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m09:59:35.078175 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:35.086379 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 09:59:34.719762 => 09:59:35.086379
[0m09:59:35.086379 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m09:59:35.086379 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2816730>]}
[0m09:59:35.088588 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.37s]
[0m09:59:35.088588 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m09:59:35.088588 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:59:35.088588 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m09:59:35.088588 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m09:59:35.088588 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:59:35.102185 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:59:35.103637 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 09:59:35.088588 => 09:59:35.103637
[0m09:59:35.104665 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:59:35.108778 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:59:35.108778 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:59:35.108778 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m09:59:35.108778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:35.341542 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:35.343602 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:59:35.343602 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m09:59:35.372210 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:35.374249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:59:35.374249 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m09:59:35.394484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:35.394484 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m09:59:35.394484 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:59:35.394484 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m09:59:35.430606 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:35.433946 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m09:59:35.433946 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m09:59:35.433946 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m09:59:35.458264 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:35.458264 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 09:59:35.104759 => 09:59:35.458264
[0m09:59:35.458264 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m09:59:35.458264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA275A3D0>]}
[0m09:59:35.458264 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.37s]
[0m09:59:35.458264 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m09:59:35.458264 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m09:59:35.458264 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m09:59:35.464997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m09:59:35.464997 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m09:59:35.467201 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:59:35.467201 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 09:59:35.464997 => 09:59:35.467201
[0m09:59:35.467201 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m09:59:35.475256 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:59:35.477330 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:59:35.477330 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m09:59:35.477330 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:35.714324 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:35.715321 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:59:35.716316 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m09:59:35.743216 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:35.747473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:59:35.747473 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m09:59:35.763491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:35.771743 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m09:59:35.771743 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:59:35.773470 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m09:59:35.794126 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:35.802175 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m09:59:35.804217 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m09:59:35.804217 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m09:59:35.824515 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:35.824515 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 09:59:35.467201 => 09:59:35.824515
[0m09:59:35.824515 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m09:59:35.824515 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2606F40>]}
[0m09:59:35.832584 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.36s]
[0m09:59:35.832584 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m09:59:35.832584 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:59:35.834612 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m09:59:35.834612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m09:59:35.834612 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:59:35.842214 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:59:35.845213 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 09:59:35.834612 => 09:59:35.844217
[0m09:59:35.845213 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:59:35.851669 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:59:35.853865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:59:35.854868 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m09:59:35.855886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:36.066096 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:36.067104 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:59:36.068104 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m09:59:36.094895 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:36.098730 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:59:36.098730 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m09:59:36.121708 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:36.122716 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m09:59:36.123709 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:59:36.123709 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m09:59:36.150502 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:36.154276 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m09:59:36.155275 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m09:59:36.155275 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m09:59:36.178903 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:36.179902 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 09:59:35.846212 => 09:59:36.179902
[0m09:59:36.180896 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m09:59:36.181908 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2795F70>]}
[0m09:59:36.182902 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.35s]
[0m09:59:36.183897 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m09:59:36.183897 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m09:59:36.184896 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m09:59:36.184896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m09:59:36.185902 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m09:59:36.188902 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:59:36.190897 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 09:59:36.185902 => 09:59:36.190897
[0m09:59:36.191897 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m09:59:36.195895 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:59:36.197905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:59:36.198897 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m09:59:36.198897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:36.397053 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:36.397549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:59:36.398046 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m09:59:36.424040 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:36.428022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:59:36.428559 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m09:59:36.452157 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:36.454324 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m09:59:36.454857 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:59:36.455362 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m09:59:36.481512 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:36.481512 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m09:59:36.481512 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m09:59:36.481512 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m09:59:36.507997 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:36.507997 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 09:59:36.191897 => 09:59:36.507997
[0m09:59:36.507997 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m09:59:36.507997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2793A60>]}
[0m09:59:36.507997 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.32s]
[0m09:59:36.507997 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m09:59:36.507997 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:59:36.507997 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m09:59:36.507997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m09:59:36.507997 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:59:36.507997 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:59:36.507997 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 09:59:36.507997 => 09:59:36.507997
[0m09:59:36.507997 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:59:36.524408 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:59:36.524408 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:59:36.524408 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m09:59:36.524408 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:36.724669 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:36.724669 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:59:36.724669 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m09:59:36.757900 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:36.757900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:59:36.757900 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m09:59:36.774780 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:36.774780 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m09:59:36.774780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:59:36.774780 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m09:59:36.808094 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:36.824940 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m09:59:36.824940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m09:59:36.824940 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m09:59:36.841469 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:36.841469 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 09:59:36.507997 => 09:59:36.841469
[0m09:59:36.841469 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m09:59:36.857598 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA27C5DF0>]}
[0m09:59:36.858164 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.35s]
[0m09:59:36.858164 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m09:59:36.858164 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m09:59:36.858164 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m09:59:36.858164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m09:59:36.858164 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m09:59:36.858164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:59:36.858164 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 09:59:36.858164 => 09:59:36.858164
[0m09:59:36.858164 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m09:59:36.858164 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:59:36.858164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:59:36.858164 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m09:59:36.858164 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:37.067029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:37.067029 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:59:37.067029 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m09:59:37.095597 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:37.095597 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:59:37.095597 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m09:59:37.124585 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:37.126849 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m09:59:37.126849 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:59:37.126849 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m09:59:37.149774 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:37.160360 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m09:59:37.160360 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m09:59:37.160360 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m09:59:37.181201 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:37.181201 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 09:59:36.858164 => 09:59:37.181201
[0m09:59:37.181201 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m09:59:37.189393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA27E6E20>]}
[0m09:59:37.191294 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.33s]
[0m09:59:37.191799 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m09:59:37.191799 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:59:37.191799 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m09:59:37.191799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m09:59:37.191799 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:59:37.191799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:59:37.199564 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 09:59:37.191799 => 09:59:37.199564
[0m09:59:37.199564 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:59:37.201750 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:59:37.201750 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:59:37.201750 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m09:59:37.201750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:37.399633 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:37.399633 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:59:37.399633 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m09:59:37.429712 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:37.437950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:59:37.437950 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m09:59:37.460829 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:37.460829 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m09:59:37.460829 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:59:37.460829 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m09:59:37.489855 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:37.492050 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m09:59:37.492050 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m09:59:37.492050 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m09:59:37.512797 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:37.520984 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 09:59:37.199564 => 09:59:37.520984
[0m09:59:37.520984 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m09:59:37.523192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA27EED00>]}
[0m09:59:37.523192 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m09:59:37.523192 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m09:59:37.523192 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:59:37.523192 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m09:59:37.523192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m09:59:37.523192 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:59:37.531378 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:59:37.533547 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 09:59:37.523192 => 09:59:37.533547
[0m09:59:37.533547 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:59:37.533547 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:59:37.533547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:59:37.533547 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m09:59:37.533547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:37.738452 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:37.738452 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:59:37.738452 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m09:59:37.777809 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:37.780005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:59:37.780005 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m09:59:37.800562 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:37.808777 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m09:59:37.810985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:59:37.810985 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m09:59:37.839717 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:37.841938 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m09:59:37.841938 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m09:59:37.841938 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m09:59:37.862655 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:37.870849 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 09:59:37.533547 => 09:59:37.870849
[0m09:59:37.870849 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m09:59:37.873047 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA27F4A90>]}
[0m09:59:37.873047 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.35s]
[0m09:59:37.873047 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m09:59:37.873047 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:59:37.873047 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m09:59:37.873047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m09:59:37.873047 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:59:37.882489 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:59:37.883847 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 09:59:37.873047 => 09:59:37.883847
[0m09:59:37.884860 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:59:37.885719 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:59:37.891489 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:59:37.892845 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m09:59:37.893366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:38.083590 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:38.083590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:59:38.085680 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m09:59:38.116788 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:38.116788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:59:38.124856 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m09:59:38.145606 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:38.147817 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m09:59:38.147817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:59:38.147817 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m09:59:38.178922 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:38.178922 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m09:59:38.187021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m09:59:38.189209 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m09:59:38.209887 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:38.209887 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 09:59:37.884860 => 09:59:38.209887
[0m09:59:38.209887 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m09:59:38.218084 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA27F4AC0>]}
[0m09:59:38.218084 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.35s]
[0m09:59:38.220284 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m09:59:38.220284 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:59:38.220284 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m09:59:38.220284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m09:59:38.220284 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:59:38.220284 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:59:38.228432 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 09:59:38.220284 => 09:59:38.228432
[0m09:59:38.229689 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:59:38.233168 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:59:38.233168 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:59:38.233168 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m09:59:38.233168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:38.432905 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:38.432905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:59:38.435116 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m09:59:38.464083 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:38.464083 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:59:38.464083 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m09:59:38.492218 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:38.492310 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m09:59:38.492310 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:59:38.494324 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m09:59:38.522684 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:38.525323 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m09:59:38.525323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m09:59:38.526866 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m09:59:38.547208 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:38.547208 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 09:59:38.229689 => 09:59:38.547208
[0m09:59:38.547208 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m09:59:38.551606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA27F4A90>]}
[0m09:59:38.552284 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.33s]
[0m09:59:38.552980 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m09:59:38.553586 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:59:38.554185 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m09:59:38.554791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m09:59:38.554791 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:59:38.558626 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:59:38.560819 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 09:59:38.555379 => 09:59:38.560296
[0m09:59:38.561222 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:59:38.566518 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:59:38.568660 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:59:38.569189 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m09:59:38.569734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:38.793245 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:38.793245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:59:38.793245 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m09:59:38.824507 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:38.834909 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:59:38.834909 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m09:59:38.855671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:38.855671 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m09:59:38.863841 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:59:38.863841 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m09:59:38.886863 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:38.897352 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m09:59:38.897352 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m09:59:38.897352 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m09:59:38.918090 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:38.918090 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 09:59:38.561222 => 09:59:38.918090
[0m09:59:38.918090 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m09:59:38.918090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA26FBEE0>]}
[0m09:59:38.918090 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.36s]
[0m09:59:38.926206 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m09:59:38.926206 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:59:38.928422 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m09:59:38.928422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m09:59:38.928422 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:59:38.928422 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:59:38.928422 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 09:59:38.928422 => 09:59:38.928422
[0m09:59:38.928422 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:59:38.938777 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:59:38.938777 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:59:38.938777 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m09:59:38.938777 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:59:39.152583 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m09:59:39.154780 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:59:39.154780 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m09:59:39.185773 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:59:39.196316 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:59:39.196316 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m09:59:39.217101 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:59:39.217101 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m09:59:39.217101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:59:39.225212 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m09:59:39.248169 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m09:59:39.248169 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m09:59:39.256393 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m09:59:39.256393 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m09:59:39.276963 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m09:59:39.279180 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 09:59:38.928422 => 09:59:39.279180
[0m09:59:39.279180 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m09:59:39.279180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42d30579-51ba-4140-af9b-c79d724a8c00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2878850>]}
[0m09:59:39.279180 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.35s]
[0m09:59:39.279180 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m09:59:39.279180 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:39.287214 [debug] [MainThread]: On master: BEGIN
[0m09:59:39.287214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:39.467061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:59:39.467061 [debug] [MainThread]: On master: COMMIT
[0m09:59:39.467061 [debug] [MainThread]: Using postgres connection "master"
[0m09:59:39.467061 [debug] [MainThread]: On master: COMMIT
[0m09:59:39.487783 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:59:39.495974 [debug] [MainThread]: On master: Close
[0m09:59:39.495974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:39.498170 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m09:59:39.498170 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m09:59:39.498170 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m09:59:39.498170 [info ] [MainThread]: 
[0m09:59:39.498170 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m09:59:39.506264 [debug] [MainThread]: Command end result
[0m09:59:39.518507 [info ] [MainThread]: 
[0m09:59:39.518507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:39.518507 [info ] [MainThread]: 
[0m09:59:39.518507 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m09:59:39.518507 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:39.518507 after 7.76 seconds
[0m09:59:39.518507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015A9F5629A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA28166D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AA2816700>]}
[0m09:59:39.526070 [debug] [MainThread]: Flushing usage events
[0m10:11:29.519590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A22F8609D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2320F94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2320F9520>]}


============================== 10:11:29.530051 | cbbe4e70-8320-411c-ab66-72c9b0786a63 ==============================
[0m10:11:29.530051 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:11:29.530051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:11:29.735092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A230156BE0>]}
[0m10:11:29.815529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A232387580>]}
[0m10:11:29.815529 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m10:11:29.817699 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:11:29.842900 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:11:29.842900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23244A8B0>]}
[0m10:11:30.585950 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m10:11:30.598303 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m10:11:30.598303 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m10:11:30.598303 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m10:11:30.608557 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m10:11:30.608557 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m10:11:30.608557 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m10:11:30.608557 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m10:11:30.618998 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m10:11:30.618998 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m10:11:30.618998 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m10:11:30.627103 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m10:11:30.629293 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m10:11:30.629293 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m10:11:30.629293 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m10:11:30.637506 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m10:11:30.639752 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m10:11:30.701345 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m10:11:30.798809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_wizetrading.example
[0m10:11:30.804805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2327B8C10>]}
[0m10:11:30.823158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2327FCFD0>]}
[0m10:11:30.823158 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:11:30.824174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2327FC2E0>]}
[0m10:11:30.825171 [info ] [MainThread]: 
[0m10:11:30.826165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:11:30.829799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m10:11:30.837806 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m10:11:30.838805 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m10:11:30.838805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:31.140989 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m10:11:31.143172 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m10:11:31.143172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m10:11:31.151369 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m10:11:31.151369 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m10:11:31.151369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:11:31.360063 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:11:31.360063 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m10:11:31.360063 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m10:11:31.388845 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m10:11:31.391052 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m10:11:31.411834 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m10:11:31.422048 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:31.422048 [debug] [MainThread]: On master: BEGIN
[0m10:11:31.422048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:11:31.630389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:11:31.630389 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:31.630389 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:11:31.671770 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m10:11:31.679888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23291BBE0>]}
[0m10:11:31.681895 [debug] [MainThread]: On master: ROLLBACK
[0m10:11:31.702640 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:31.702640 [debug] [MainThread]: On master: BEGIN
[0m10:11:31.743794 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:11:31.743794 [debug] [MainThread]: On master: COMMIT
[0m10:11:31.743794 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:31.743794 [debug] [MainThread]: On master: COMMIT
[0m10:11:31.764577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:11:31.764577 [debug] [MainThread]: On master: Close
[0m10:11:31.764577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:11:31.772696 [info ] [MainThread]: 
[0m10:11:31.774892 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m10:11:31.774892 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m10:11:31.774892 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m10:11:31.774892 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m10:11:31.787082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:31.787082 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 10:11:31.782703 => 10:11:31.787082
[0m10:11:31.787082 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m10:11:31.816324 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:31.824370 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:31.824370 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m10:11:31.824370 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:11:32.014066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:32.015128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:32.015128 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m10:11:32.039652 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:32.041854 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:32.041854 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m10:11:32.070677 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:32.072894 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:32.072894 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m10:11:32.093570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:32.103840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m10:11:32.103840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:32.103840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m10:11:32.134195 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:32.144241 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m10:11:32.144241 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:11:32.144241 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m10:11:32.193899 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:32.195526 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 10:11:31.787082 => 10:11:32.195526
[0m10:11:32.196069 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m10:11:32.197156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A232B66B20>]}
[0m10:11:32.197704 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.42s]
[0m10:11:32.198860 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m10:11:32.199380 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m10:11:32.199931 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m10:11:32.201048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m10:11:32.201566 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m10:11:32.204719 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.206289 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 10:11:32.202114 => 10:11:32.205786
[0m10:11:32.206301 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m10:11:32.210525 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.211593 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.212107 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m10:11:32.212615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:32.387779 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:32.387779 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.387779 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m10:11:32.418734 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:32.418734 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.418734 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m10:11:32.447697 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:32.449892 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.449892 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m10:11:32.470571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:32.478668 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m10:11:32.478668 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.478668 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m10:11:32.501583 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:32.501583 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m10:11:32.501583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:11:32.509760 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m10:11:32.532550 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:32.532550 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 10:11:32.206829 => 10:11:32.532550
[0m10:11:32.532550 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m10:11:32.532550 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A232B5CCA0>]}
[0m10:11:32.540716 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.33s]
[0m10:11:32.541731 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m10:11:32.541731 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m10:11:32.542698 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m10:11:32.542698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m10:11:32.542698 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m10:11:32.542698 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:11:32.547601 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 10:11:32.542698 => 10:11:32.547601
[0m10:11:32.548663 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m10:11:32.552659 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:11:32.553661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:11:32.554603 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m10:11:32.554603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:32.747304 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:32.747304 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:11:32.747304 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m10:11:32.778409 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:32.819790 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:11:32.819790 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m10:11:32.840473 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:32.840473 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m10:11:32.840473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:11:32.840473 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m10:11:32.871641 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:32.871641 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m10:11:32.871641 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:11:32.871641 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m10:11:32.892337 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:32.900526 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 10:11:32.548663 => 10:11:32.900526
[0m10:11:32.900526 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m10:11:32.900526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2329F8FA0>]}
[0m10:11:32.902667 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.36s]
[0m10:11:32.902667 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m10:11:32.902667 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:11:32.902667 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m10:11:32.902667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m10:11:32.902667 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:11:32.902667 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:11:32.902667 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 10:11:32.902667 => 10:11:32.902667
[0m10:11:32.902667 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:11:32.913795 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:11:32.915616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:11:32.916472 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m10:11:32.916472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:33.099855 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:33.099855 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:11:33.099855 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m10:11:33.128942 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:33.128942 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:11:33.128942 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m10:11:33.157892 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:33.157892 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m10:11:33.157892 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:11:33.160087 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m10:11:33.180801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:33.188985 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m10:11:33.188985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:11:33.188985 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m10:11:33.211861 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:33.211861 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 10:11:32.910805 => 10:11:33.211861
[0m10:11:33.211861 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m10:11:33.211861 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2329F2C40>]}
[0m10:11:33.211861 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.31s]
[0m10:11:33.211861 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:11:33.211861 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m10:11:33.211861 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m10:11:33.211861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m10:11:33.219929 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m10:11:33.222194 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:11:33.222194 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 10:11:33.220030 => 10:11:33.222194
[0m10:11:33.222194 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m10:11:33.222194 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:11:33.230232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:11:33.230232 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m10:11:33.230232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:33.416957 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:33.416957 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:11:33.416957 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m10:11:33.448046 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:33.448046 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:11:33.448046 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m10:11:33.468722 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:33.476837 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m10:11:33.485023 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:11:33.485023 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m10:11:33.510052 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:33.510052 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m10:11:33.510052 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:11:33.510052 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m10:11:33.530774 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:33.538875 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 10:11:33.222194 => 10:11:33.538875
[0m10:11:33.538875 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m10:11:33.540952 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23297FFD0>]}
[0m10:11:33.541098 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.33s]
[0m10:11:33.541098 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m10:11:33.541098 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:11:33.541098 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m10:11:33.541098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m10:11:33.541098 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:11:33.541098 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:11:33.541098 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 10:11:33.541098 => 10:11:33.541098
[0m10:11:33.549146 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:11:33.551345 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:11:33.551345 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:11:33.551345 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m10:11:33.551345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:33.745169 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:33.746169 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:11:33.746169 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m10:11:33.772195 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:33.775415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:11:33.776414 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m10:11:33.798794 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:33.799804 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m10:11:33.800801 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:11:33.800801 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m10:11:33.827299 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:33.830083 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m10:11:33.831092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:11:33.831092 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m10:11:33.850463 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:33.850463 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 10:11:33.549146 => 10:11:33.850463
[0m10:11:33.850463 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m10:11:33.850463 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2329DBFA0>]}
[0m10:11:33.857526 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.31s]
[0m10:11:33.857526 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:11:33.857526 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m10:11:33.859576 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m10:11:33.859576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m10:11:33.859576 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m10:11:33.859576 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:11:33.866127 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 10:11:33.859576 => 10:11:33.866127
[0m10:11:33.867126 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m10:11:33.871132 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:11:33.871132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:11:33.871132 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m10:11:33.871132 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:34.070241 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:34.071249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:11:34.071249 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m10:11:34.098163 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:34.101088 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:11:34.102137 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m10:11:34.122566 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:34.124566 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m10:11:34.124566 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:11:34.125561 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m10:11:34.152334 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:34.155333 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m10:11:34.156333 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:11:34.156333 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m10:11:34.183411 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:34.184409 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 10:11:33.867126 => 10:11:34.184409
[0m10:11:34.185409 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m10:11:34.185409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A232780700>]}
[0m10:11:34.186409 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.33s]
[0m10:11:34.187403 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m10:11:34.187403 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:11:34.188410 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m10:11:34.189411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m10:11:34.189411 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:11:34.192372 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:11:34.193365 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 10:11:34.190244 => 10:11:34.193365
[0m10:11:34.194366 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:11:34.198729 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:11:34.199636 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:11:34.200637 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m10:11:34.200637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:34.400779 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:34.401273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:11:34.401779 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m10:11:34.428136 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:34.431664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:11:34.432712 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m10:11:34.454020 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:34.456028 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m10:11:34.456028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:11:34.457028 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m10:11:34.482588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:34.486124 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m10:11:34.486596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:11:34.487595 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m10:11:34.508446 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:34.510333 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 10:11:34.194366 => 10:11:34.509447
[0m10:11:34.510333 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m10:11:34.511338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2327273A0>]}
[0m10:11:34.511338 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.32s]
[0m10:11:34.513341 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:11:34.513341 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m10:11:34.513341 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m10:11:34.514336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m10:11:34.515339 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m10:11:34.518296 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:11:34.519309 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 10:11:34.515595 => 10:11:34.519309
[0m10:11:34.520299 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m10:11:34.524303 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:11:34.525297 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:11:34.526373 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m10:11:34.526373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:34.702245 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:34.703245 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:11:34.703245 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m10:11:34.730542 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:34.734081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:11:34.735082 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m10:11:34.755449 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:34.755449 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m10:11:34.755449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:11:34.755449 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m10:11:34.786941 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:34.788941 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m10:11:34.789940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:11:34.790940 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m10:11:34.814586 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:34.816207 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 10:11:34.520299 => 10:11:34.816207
[0m10:11:34.816758 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m10:11:34.816758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2326D3BB0>]}
[0m10:11:34.817737 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.30s]
[0m10:11:34.818731 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m10:11:34.818731 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:11:34.819737 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m10:11:34.820730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m10:11:34.820730 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:11:34.823123 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:11:34.825116 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 10:11:34.820730 => 10:11:34.825116
[0m10:11:34.826125 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:11:34.829121 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:11:34.831115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:11:34.831115 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m10:11:34.832125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:35.033102 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:35.033102 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:11:35.034112 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m10:11:35.060743 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:35.063742 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:11:35.064742 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m10:11:35.086255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:35.088263 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m10:11:35.088263 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:11:35.089262 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m10:11:35.119386 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:35.122386 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m10:11:35.123387 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:11:35.123387 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m10:11:35.145660 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:35.146659 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 10:11:34.826125 => 10:11:35.146659
[0m10:11:35.147659 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m10:11:35.147659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2329C0DF0>]}
[0m10:11:35.148659 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m10:11:35.150017 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:11:35.150560 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m10:11:35.151569 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m10:11:35.152561 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m10:11:35.152561 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m10:11:35.155568 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:11:35.156561 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 10:11:35.152561 => 10:11:35.156561
[0m10:11:35.157562 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m10:11:35.161567 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:11:35.162560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:11:35.162560 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m10:11:35.163571 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:35.385260 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:35.386260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:11:35.386260 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m10:11:35.412934 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:35.416561 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:11:35.416561 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m10:11:35.440382 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:35.441382 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m10:11:35.441382 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:11:35.442382 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m10:11:35.467804 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:35.470111 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m10:11:35.471119 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:11:35.471119 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m10:11:35.494031 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:35.495186 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 10:11:35.157562 => 10:11:35.495186
[0m10:11:35.495186 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m10:11:35.496185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2329C0520>]}
[0m10:11:35.496185 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.34s]
[0m10:11:35.498190 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m10:11:35.498190 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:11:35.498190 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m10:11:35.500089 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m10:11:35.500089 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:11:35.502308 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:11:35.504310 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 10:11:35.500089 => 10:11:35.504310
[0m10:11:35.504310 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:11:35.508315 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:11:35.510323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:11:35.510323 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m10:11:35.511316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:35.691405 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:35.692405 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:11:35.692405 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m10:11:35.718858 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:35.718858 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:11:35.718858 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m10:11:35.745394 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:35.746394 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m10:11:35.747394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:11:35.747394 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m10:11:35.774202 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:35.776210 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m10:11:35.777209 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:11:35.778209 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m10:11:35.805311 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:35.806311 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 10:11:35.505321 => 10:11:35.806311
[0m10:11:35.806311 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m10:11:35.807320 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A232A6FAC0>]}
[0m10:11:35.808319 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.31s]
[0m10:11:35.809313 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:11:35.809313 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:11:35.810319 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m10:11:35.811321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m10:11:35.811321 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:11:35.814456 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:11:35.817368 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 10:11:35.811321 => 10:11:35.816884
[0m10:11:35.817368 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:11:35.821378 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:11:35.822378 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:11:35.822378 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m10:11:35.822378 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:36.022973 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:36.022973 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:11:36.023972 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:11:36.054941 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:36.058940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:11:36.058940 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m10:11:36.081996 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:36.083894 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m10:11:36.083894 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:11:36.084903 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m10:11:36.110202 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:36.113200 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m10:11:36.114200 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:11:36.114200 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m10:11:36.136224 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:36.138223 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 10:11:35.817368 => 10:11:36.137224
[0m10:11:36.138223 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m10:11:36.139229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A232B3D6D0>]}
[0m10:11:36.139757 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.33s]
[0m10:11:36.140282 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:11:36.141287 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:11:36.141287 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m10:11:36.142285 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m10:11:36.143286 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:11:36.146282 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:11:36.148277 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 10:11:36.143286 => 10:11:36.148277
[0m10:11:36.148277 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:11:36.153323 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:11:36.153323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:11:36.153323 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m10:11:36.153323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:36.355809 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:36.355809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:11:36.356808 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:11:36.388008 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:36.392109 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:11:36.393109 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m10:11:36.414817 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:36.416826 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m10:11:36.417364 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:11:36.417440 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m10:11:36.445079 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:36.447150 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m10:11:36.448150 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:11:36.449147 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m10:11:36.472058 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:36.473058 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 10:11:36.149285 => 10:11:36.473058
[0m10:11:36.474065 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m10:11:36.475059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2329ABFA0>]}
[0m10:11:36.475059 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.33s]
[0m10:11:36.476060 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:11:36.477059 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:11:36.477059 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m10:11:36.478134 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m10:11:36.478134 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:11:36.482141 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:11:36.484741 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 10:11:36.479134 => 10:11:36.484274
[0m10:11:36.484741 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:11:36.487981 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:11:36.487981 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:11:36.487981 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m10:11:36.487981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:36.678189 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:36.678272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:11:36.679281 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:11:36.712516 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:36.716515 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:11:36.716515 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m10:11:36.739379 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:36.741379 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m10:11:36.741379 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:11:36.742383 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m10:11:36.767828 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:36.767828 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m10:11:36.767828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:11:36.775389 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m10:11:36.796283 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:36.798145 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 10:11:36.484741 => 10:11:36.798145
[0m10:11:36.798145 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m10:11:36.799153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23250B460>]}
[0m10:11:36.800152 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.32s]
[0m10:11:36.801308 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:11:36.801308 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:11:36.802318 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m10:11:36.803319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m10:11:36.803319 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:11:36.807174 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:11:36.809166 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 10:11:36.803319 => 10:11:36.808166
[0m10:11:36.809166 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:11:36.814288 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:11:36.816166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:11:36.816166 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m10:11:36.816166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:36.996191 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:36.997191 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:11:36.997994 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:11:37.031534 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:37.034450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:11:37.035461 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m10:11:37.058738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:37.060731 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m10:11:37.060731 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:11:37.061731 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m10:11:37.088046 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:37.091045 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m10:11:37.092047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:11:37.093046 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m10:11:37.114107 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:37.115107 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 10:11:36.809166 => 10:11:37.115107
[0m10:11:37.116107 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m10:11:37.117107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2329ABFA0>]}
[0m10:11:37.117849 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.31s]
[0m10:11:37.118659 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:11:37.118659 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:11:37.119669 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m10:11:37.120671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m10:11:37.120671 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:11:37.124667 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:11:37.126621 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 10:11:37.120671 => 10:11:37.126621
[0m10:11:37.126621 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:11:37.130628 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:11:37.132622 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:11:37.133625 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m10:11:37.133625 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:11:37.346145 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:11:37.346145 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:11:37.347144 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:11:37.377463 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:11:37.377463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:11:37.377463 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m10:11:37.398205 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:11:37.406456 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m10:11:37.406456 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:11:37.406456 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m10:11:37.429521 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:11:37.437707 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m10:11:37.437707 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:11:37.437707 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m10:11:37.460578 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:11:37.460578 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 10:11:37.127623 => 10:11:37.460578
[0m10:11:37.460578 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m10:11:37.460578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cbbe4e70-8320-411c-ab66-72c9b0786a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2327283D0>]}
[0m10:11:37.460578 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.34s]
[0m10:11:37.460578 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:11:37.460578 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:37.460578 [debug] [MainThread]: On master: BEGIN
[0m10:11:37.460578 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:11:37.653999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:11:37.655008 [debug] [MainThread]: On master: COMMIT
[0m10:11:37.655008 [debug] [MainThread]: Using postgres connection "master"
[0m10:11:37.655008 [debug] [MainThread]: On master: COMMIT
[0m10:11:37.676315 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:11:37.677315 [debug] [MainThread]: On master: Close
[0m10:11:37.678308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:11:37.678768 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m10:11:37.678768 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m10:11:37.678768 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m10:11:37.679776 [info ] [MainThread]: 
[0m10:11:37.680769 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 6.85 seconds (6.85s).
[0m10:11:37.682775 [debug] [MainThread]: Command end result
[0m10:11:37.698090 [info ] [MainThread]: 
[0m10:11:37.698090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:11:37.699090 [info ] [MainThread]: 
[0m10:11:37.700091 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m10:11:37.701900 [debug] [MainThread]: Command `dbt run` succeeded at 10:11:37.701836 after 8.22 seconds
[0m10:11:37.702576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A22F8609D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2323D8A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2323444F0>]}
[0m10:11:37.703127 [debug] [MainThread]: Flushing usage events
[0m10:13:56.834663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025950A829D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259532D94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259532D9520>]}


============================== 10:13:56.836852 | e62cf1e7-7454-4324-9696-07b6fafd0893 ==============================
[0m10:13:56.836852 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:13:56.836852 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:13:57.043221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025951371BE0>]}
[0m10:13:57.125831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259535A6580>]}
[0m10:13:57.125831 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m10:13:57.136100 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:13:57.154634 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:13:57.154634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953669850>]}
[0m10:13:57.887608 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m10:13:57.908117 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m10:13:57.908117 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m10:13:57.908117 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m10:13:57.918502 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m10:13:57.918502 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m10:13:57.918502 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m10:13:57.926592 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m10:13:57.928770 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m10:13:57.928770 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m10:13:57.928770 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m10:13:57.936960 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m10:13:57.939141 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m10:13:57.939141 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m10:13:57.939141 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m10:13:57.947265 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m10:13:57.949469 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m10:13:58.022123 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m10:13:58.130004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259539DAC10>]}
[0m10:13:58.147436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953A20DF0>]}
[0m10:13:58.147436 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:13:58.147436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953A20370>]}
[0m10:13:58.147436 [info ] [MainThread]: 
[0m10:13:58.147436 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:13:58.156734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m10:13:58.165925 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m10:13:58.165925 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m10:13:58.167669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:58.415622 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m10:13:58.415622 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m10:13:58.423694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m10:13:58.425863 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m10:13:58.425863 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m10:13:58.425863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:58.629737 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:13:58.629737 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m10:13:58.629737 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m10:13:58.649791 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.0 seconds
[0m10:13:58.657996 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m10:13:58.680674 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m10:13:58.690784 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:58.690784 [debug] [MainThread]: On master: BEGIN
[0m10:13:58.690784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:58.894399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:13:58.894399 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:58.894399 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:13:58.927445 [debug] [MainThread]: SQL status: SELECT 47 in 0.0 seconds
[0m10:13:58.937705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953B35BE0>]}
[0m10:13:58.937705 [debug] [MainThread]: On master: ROLLBACK
[0m10:13:58.958388 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:58.958388 [debug] [MainThread]: On master: BEGIN
[0m10:13:58.999662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:13:58.999662 [debug] [MainThread]: On master: COMMIT
[0m10:13:58.999662 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:58.999662 [debug] [MainThread]: On master: COMMIT
[0m10:13:59.019907 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:13:59.019907 [debug] [MainThread]: On master: Close
[0m10:13:59.019907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:13:59.019907 [info ] [MainThread]: 
[0m10:13:59.029984 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m10:13:59.029984 [info ] [Thread-1  ]: 1 of 17 START sql table model wizetrading.btc_perptreated_data ................. [RUN]
[0m10:13:59.029984 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m10:13:59.029984 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m10:13:59.042465 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.042465 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 10:13:59.037582 => 10:13:59.042465
[0m10:13:59.042465 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m10:13:59.080741 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.086022 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.086775 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m10:13:59.086775 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:13:59.286189 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:13:59.286189 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.286189 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
  
  
    as
  
  (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
  
[0m10:13:59.386643 [debug] [Thread-1  ]: SQL status: SELECT 10122 in 0.0 seconds
[0m10:13:59.388824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.388824 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m10:13:59.417650 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:13:59.419814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.419814 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m10:13:59.440486 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:13:59.461140 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m10:13:59.461140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.461140 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m10:13:59.481861 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:13:59.492228 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m10:13:59.492228 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:13:59.492228 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m10:13:59.543826 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:13:59.543826 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 10:13:59.042465 => 10:13:59.543826
[0m10:13:59.551912 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m10:13:59.551912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953D6FD90>]}
[0m10:13:59.551912 [info ] [Thread-1  ]: 1 of 17 OK created sql table model wizetrading.btc_perptreated_data ............ [[32mSELECT 10122[0m in 0.52s]
[0m10:13:59.554064 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m10:13:59.554064 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m10:13:59.554064 [info ] [Thread-1  ]: 2 of 17 START sql table model wizetrading.raw_data_btc_perp .................... [RUN]
[0m10:13:59.554064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m10:13:59.554064 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m10:13:59.554064 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.554064 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 10:13:59.554064 => 10:13:59.554064
[0m10:13:59.554064 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m10:13:59.565241 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.567167 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.567167 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m10:13:59.568425 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:13:59.748703 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:13:59.748703 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.748703 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  
    

  create  table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
  
  
    as
  
  (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
  
[0m10:13:59.790142 [debug] [Thread-1  ]: SQL status: SELECT 10122 in 0.0 seconds
[0m10:13:59.798325 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.800407 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m10:13:59.821241 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:13:59.821241 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.821241 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m10:13:59.841980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:13:59.850085 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m10:13:59.850085 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.850939 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m10:13:59.882948 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:13:59.882948 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m10:13:59.882948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:13:59.882948 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m10:13:59.913877 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:13:59.913877 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 10:13:59.562147 => 10:13:59.913877
[0m10:13:59.913877 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m10:13:59.913877 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953DAD250>]}
[0m10:13:59.913877 [info ] [Thread-1  ]: 2 of 17 OK created sql table model wizetrading.raw_data_btc_perp ............... [[32mSELECT 10122[0m in 0.36s]
[0m10:13:59.913877 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m10:13:59.921956 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m10:13:59.921956 [info ] [Thread-1  ]: 3 of 17 START sql table model wizetrading.btc_perp_data_15m .................... [RUN]
[0m10:13:59.921956 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m10:13:59.924129 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m10:13:59.924129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:13:59.924129 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 10:13:59.924129 => 10:13:59.924129
[0m10:13:59.924129 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m10:13:59.934430 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:13:59.936707 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:13:59.936707 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m10:13:59.936707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:00.118912 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:00.118912 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:14:00.118912 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
  
[0m10:14:00.160518 [debug] [Thread-1  ]: SQL status: SELECT 1687 in 0.0 seconds
[0m10:14:00.168697 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:14:00.168697 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m10:14:00.189384 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:00.191553 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m10:14:00.191553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:14:00.191553 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m10:14:00.222580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:00.222580 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m10:14:00.222580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:14:00.222580 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m10:14:00.243207 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:00.251271 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 10:13:59.924129 => 10:14:00.243207
[0m10:14:00.251409 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m10:14:00.251409 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953BFE970>]}
[0m10:14:00.251409 [info ] [Thread-1  ]: 3 of 17 OK created sql table model wizetrading.btc_perp_data_15m ............... [[32mSELECT 1687[0m in 0.33s]
[0m10:14:00.253641 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m10:14:00.253641 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:14:00.253641 [info ] [Thread-1  ]: 4 of 17 START sql table model wizetrading.btc_perp_data_15m_history ............ [RUN]
[0m10:14:00.253641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m10:14:00.253641 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:14:00.253641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:14:00.253641 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 10:14:00.253641 => 10:14:00.253641
[0m10:14:00.253641 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:14:00.264667 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:14:00.266667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:14:00.266667 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m10:14:00.267920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:00.445455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:00.445455 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:14:00.447620 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
  
[0m10:14:01.124737 [debug] [Thread-1  ]: SQL status: SELECT 1687 in 1.0 seconds
[0m10:14:01.132930 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:14:01.132930 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m10:14:01.153761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:01.155932 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m10:14:01.155932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:14:01.155932 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m10:14:01.382109 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:01.382109 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m10:14:01.382109 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:14:01.382109 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m10:14:01.402255 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:01.402255 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 10:14:00.253641 => 10:14:01.402255
[0m10:14:01.410284 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m10:14:01.410284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953D6FD90>]}
[0m10:14:01.410284 [info ] [Thread-1  ]: 4 of 17 OK created sql table model wizetrading.btc_perp_data_15m_history ....... [[32mSELECT 1687[0m in 1.16s]
[0m10:14:01.412304 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:14:01.412304 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m10:14:01.412304 [info ] [Thread-1  ]: 5 of 17 START sql table model wizetrading.btc_perp_data_1h ..................... [RUN]
[0m10:14:01.412304 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m10:14:01.412304 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m10:14:01.412304 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:14:01.420323 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 10:14:01.412304 => 10:14:01.420323
[0m10:14:01.420323 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m10:14:01.473417 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:14:01.481460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:14:01.481460 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m10:14:01.481460 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:01.674657 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:01.674657 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:14:01.674657 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
  
[0m10:14:01.721407 [debug] [Thread-1  ]: SQL status: SELECT 1687 in 0.0 seconds
[0m10:14:01.724407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:14:01.725407 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m10:14:01.745489 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:01.745489 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m10:14:01.745489 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:14:01.745489 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m10:14:01.775653 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:01.783679 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m10:14:01.783679 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:14:01.785702 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m10:14:01.805978 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:01.805978 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 10:14:01.420323 => 10:14:01.805978
[0m10:14:01.805978 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m10:14:01.805978 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953DC1E80>]}
[0m10:14:01.805978 [info ] [Thread-1  ]: 5 of 17 OK created sql table model wizetrading.btc_perp_data_1h ................ [[32mSELECT 1687[0m in 0.39s]
[0m10:14:01.814071 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m10:14:01.814071 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:14:01.816173 [info ] [Thread-1  ]: 6 of 17 START sql table model wizetrading.btc_perp_data_1h_history ............. [RUN]
[0m10:14:01.816173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m10:14:01.816173 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:14:01.816173 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:14:01.816173 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 10:14:01.816173 => 10:14:01.816173
[0m10:14:01.816173 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:14:01.826282 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:14:01.826282 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:14:01.826282 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m10:14:01.826282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:02.017830 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:02.019920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:14:02.020445 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
  
[0m10:14:02.060234 [debug] [Thread-1  ]: SQL status: SELECT 1687 in 0.0 seconds
[0m10:14:02.063234 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:14:02.064234 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m10:14:02.085262 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:02.087232 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m10:14:02.087232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:14:02.088242 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m10:14:02.111642 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:02.119692 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m10:14:02.119692 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:14:02.119692 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m10:14:02.142779 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:02.142779 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 10:14:01.816173 => 10:14:02.142779
[0m10:14:02.142779 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m10:14:02.142779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953BA1EE0>]}
[0m10:14:02.142779 [info ] [Thread-1  ]: 6 of 17 OK created sql table model wizetrading.btc_perp_data_1h_history ........ [[32mSELECT 1687[0m in 0.33s]
[0m10:14:02.142779 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:14:02.142779 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m10:14:02.142779 [info ] [Thread-1  ]: 7 of 17 START sql table model wizetrading.btc_perp_data_1w ..................... [RUN]
[0m10:14:02.142779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m10:14:02.142779 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m10:14:02.150955 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:14:02.153153 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 10:14:02.142779 => 10:14:02.153153
[0m10:14:02.153153 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m10:14:02.153153 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:14:02.153153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:14:02.153153 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m10:14:02.161282 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:02.342278 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:02.342278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:14:02.343278 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
  
[0m10:14:02.398599 [debug] [Thread-1  ]: SQL status: SELECT 1686 in 0.0 seconds
[0m10:14:02.398599 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:14:02.398599 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m10:14:02.427386 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:02.429568 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m10:14:02.429568 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:14:02.429568 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m10:14:02.450245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:02.458486 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m10:14:02.460671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:14:02.460671 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m10:14:02.481348 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:02.481348 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 10:14:02.153153 => 10:14:02.481348
[0m10:14:02.481348 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m10:14:02.481348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953C3DBE0>]}
[0m10:14:02.481348 [info ] [Thread-1  ]: 7 of 17 OK created sql table model wizetrading.btc_perp_data_1w ................ [[32mSELECT 1686[0m in 0.34s]
[0m10:14:02.481348 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m10:14:02.481348 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:14:02.481348 [info ] [Thread-1  ]: 8 of 17 START sql table model wizetrading.btc_perp_data_1w_history ............. [RUN]
[0m10:14:02.489906 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m10:14:02.490456 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:14:02.492373 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:14:02.492373 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 10:14:02.490456 => 10:14:02.492373
[0m10:14:02.492373 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:14:02.492373 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:14:02.499560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:14:02.499560 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m10:14:02.499560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:02.697066 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:02.705133 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:14:02.705133 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
  
[0m10:14:02.747545 [debug] [Thread-1  ]: SQL status: SELECT 1686 in 0.0 seconds
[0m10:14:02.747545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:14:02.747545 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m10:14:02.767690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:02.775751 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m10:14:02.777763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:14:02.777763 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m10:14:02.808179 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:02.808179 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m10:14:02.808179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:14:02.808179 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m10:14:02.828331 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:02.828331 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 10:14:02.492373 => 10:14:02.828331
[0m10:14:02.836377 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m10:14:02.836377 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953D52CD0>]}
[0m10:14:02.836377 [info ] [Thread-1  ]: 8 of 17 OK created sql table model wizetrading.btc_perp_data_1w_history ........ [[32mSELECT 1686[0m in 0.35s]
[0m10:14:02.838420 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:14:02.838420 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m10:14:02.838420 [info ] [Thread-1  ]: 9 of 17 START sql table model wizetrading.btc_perp_data_4h ..................... [RUN]
[0m10:14:02.838420 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m10:14:02.838420 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m10:14:02.838420 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:14:02.838420 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 10:14:02.838420 => 10:14:02.838420
[0m10:14:02.846448 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m10:14:02.848484 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:14:02.848484 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:14:02.848484 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m10:14:02.848484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:03.052749 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:03.053749 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:14:03.053749 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
  
[0m10:14:03.093955 [debug] [Thread-1  ]: SQL status: SELECT 1687 in 0.0 seconds
[0m10:14:03.093955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:14:03.093955 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m10:14:03.114616 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:03.114616 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m10:14:03.114616 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:14:03.114616 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m10:14:03.145389 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:03.153494 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m10:14:03.153494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:14:03.155660 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m10:14:03.176435 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:03.176435 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 10:14:02.846448 => 10:14:03.176435
[0m10:14:03.176435 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m10:14:03.176435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953C89DC0>]}
[0m10:14:03.176435 [info ] [Thread-1  ]: 9 of 17 OK created sql table model wizetrading.btc_perp_data_4h ................ [[32mSELECT 1687[0m in 0.34s]
[0m10:14:03.176435 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m10:14:03.176435 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:14:03.176435 [info ] [Thread-1  ]: 10 of 17 START sql table model wizetrading.btc_perp_data_4h_history ............ [RUN]
[0m10:14:03.176435 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m10:14:03.176435 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:14:03.186679 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:14:03.186805 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 10:14:03.176435 => 10:14:03.186805
[0m10:14:03.186805 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:14:03.186805 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:14:03.186805 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:14:03.186805 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m10:14:03.186805 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:03.391340 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:03.391340 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:14:03.391340 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
  
[0m10:14:03.438714 [debug] [Thread-1  ]: SQL status: SELECT 1687 in 0.0 seconds
[0m10:14:03.443125 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:14:03.443125 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m10:14:03.463815 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:03.463815 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m10:14:03.463815 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:14:03.463815 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m10:14:03.494792 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:03.494792 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m10:14:03.494792 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:14:03.494792 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m10:14:03.515538 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:03.515538 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 10:14:03.186805 => 10:14:03.515538
[0m10:14:03.523720 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m10:14:03.523720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953DAD250>]}
[0m10:14:03.523720 [info ] [Thread-1  ]: 10 of 17 OK created sql table model wizetrading.btc_perp_data_4h_history ....... [[32mSELECT 1687[0m in 0.35s]
[0m10:14:03.525860 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:14:03.525860 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m10:14:03.525860 [info ] [Thread-1  ]: 11 of 17 START sql table model wizetrading.btc_perp_data_5m .................... [RUN]
[0m10:14:03.525860 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m10:14:03.525860 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m10:14:03.525860 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:14:03.525860 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 10:14:03.525860 => 10:14:03.525860
[0m10:14:03.525860 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m10:14:03.537125 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:14:03.538266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:14:03.539711 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m10:14:03.539734 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:03.721473 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:03.721473 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:14:03.721473 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
  
[0m10:14:03.762797 [debug] [Thread-1  ]: SQL status: SELECT 1688 in 0.0 seconds
[0m10:14:03.770895 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:14:03.770895 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m10:14:03.793631 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:03.793734 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m10:14:03.793734 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:14:03.793734 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m10:14:03.814419 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:03.822622 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m10:14:03.824808 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:14:03.824808 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m10:14:03.845483 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:03.845483 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 10:14:03.525860 => 10:14:03.845483
[0m10:14:03.845483 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m10:14:03.845483 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953DC13D0>]}
[0m10:14:03.845483 [info ] [Thread-1  ]: 11 of 17 OK created sql table model wizetrading.btc_perp_data_5m ............... [[32mSELECT 1688[0m in 0.32s]
[0m10:14:03.845483 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m10:14:03.845483 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:14:03.845483 [info ] [Thread-1  ]: 12 of 17 START sql table model wizetrading.btc_perp_data_5m_history ............ [RUN]
[0m10:14:03.845483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m10:14:03.845483 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:14:03.855768 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:14:03.855768 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 10:14:03.853582 => 10:14:03.855768
[0m10:14:03.855768 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:14:03.855768 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:14:03.863858 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:14:03.863858 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m10:14:03.863858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:04.061296 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:04.061296 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:14:04.061296 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
  
  
    as
  
  (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
  
[0m10:14:04.102865 [debug] [Thread-1  ]: SQL status: SELECT 1688 in 0.0 seconds
[0m10:14:04.107232 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:14:04.107232 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m10:14:04.128924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:04.129947 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m10:14:04.129947 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:14:04.129947 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m10:14:04.156753 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:04.156753 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m10:14:04.164858 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:14:04.164858 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m10:14:04.187707 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:04.187707 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 10:14:03.855768 => 10:14:04.187707
[0m10:14:04.187707 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m10:14:04.187707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953C89DC0>]}
[0m10:14:04.187707 [info ] [Thread-1  ]: 12 of 17 OK created sql table model wizetrading.btc_perp_data_5m_history ....... [[32mSELECT 1688[0m in 0.34s]
[0m10:14:04.187707 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:14:04.187707 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:14:04.187707 [info ] [Thread-1  ]: 13 of 17 START sql table model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m10:14:04.187707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m10:14:04.187707 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:14:04.197949 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:14:04.198084 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 10:14:04.187707 => 10:14:04.198084
[0m10:14:04.198084 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:14:04.198084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:14:04.206123 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:14:04.206123 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m10:14:04.206123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:04.393611 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:04.393611 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:14:04.393611 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
  
  
    as
  
  (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
  
[0m10:16:07.216175 [debug] [Thread-1  ]: SQL status: SELECT 1685 in 123.0 seconds
[0m10:16:07.226483 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:16:07.226483 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m10:16:07.247200 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:16:07.255394 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m10:16:07.255394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:16:07.257597 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m10:16:07.544006 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:16:07.554060 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m10:16:07.554060 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:16:07.554060 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m10:16:07.576434 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:16:07.576434 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 10:14:04.198084 => 10:16:07.576434
[0m10:16:07.576434 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m10:16:07.576434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953D750D0>]}
[0m10:16:07.576434 [info ] [Thread-1  ]: 13 of 17 OK created sql table model wizetrading.btc_perp_data_15m_current_and_history  [[32mSELECT 1685[0m in 123.39s]
[0m10:16:07.576434 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:16:07.576434 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:16:07.576434 [info ] [Thread-1  ]: 14 of 17 START sql table model wizetrading.btc_perp_data_1h_current_and_history  [RUN]
[0m10:16:07.584481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m10:16:07.584481 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:16:07.587843 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:16:07.589980 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 10:16:07.585123 => 10:16:07.589460
[0m10:16:07.590508 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:16:07.595386 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:16:07.597494 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:16:07.598022 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m10:16:07.598022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:16:07.792208 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:16:07.792208 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:16:07.792208 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
  
  
    as
  
  (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
  
[0m10:18:22.149992 [debug] [Thread-1  ]: SQL status: SELECT 1687 in 134.0 seconds
[0m10:18:22.151469 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:18:22.151469 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m10:18:22.177870 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:18:22.177870 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m10:18:22.177870 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:18:22.177870 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m10:18:22.400744 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:18:22.400744 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m10:18:22.408933 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:18:22.408933 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop table if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m10:18:22.431946 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:18:22.434121 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 10:16:07.590508 => 10:18:22.434121
[0m10:18:22.434121 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m10:18:22.434121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953737BB0>]}
[0m10:18:22.434121 [info ] [Thread-1  ]: 14 of 17 OK created sql table model wizetrading.btc_perp_data_1h_current_and_history  [[32mSELECT 1687[0m in 134.86s]
[0m10:18:22.434121 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:18:22.434121 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:18:22.434121 [info ] [Thread-1  ]: 15 of 17 START sql table model wizetrading.btc_perp_data_1w_current_and_history  [RUN]
[0m10:18:22.434121 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m10:18:22.434121 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:18:22.442230 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:18:22.444410 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 10:18:22.434121 => 10:18:22.444410
[0m10:18:22.444410 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:18:22.444410 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:18:22.444410 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:18:22.452448 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m10:18:22.452564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:18:22.925587 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:18:22.935155 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:18:22.935155 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
  
  
    as
  
  (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
  
[0m10:19:07.243756 [debug] [Thread-1  ]: Postgres adapter: Postgres error: SSL connection has been closed unexpectedly

[0m10:19:07.243756 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: ROLLBACK
[0m10:19:07.264264 [debug] [Thread-1  ]: Failed to rollback 'model.dbt_wizetrading.btc_perp_data_1w_current_and_history'
[0m10:19:07.266309 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 10:18:22.444410 => 10:19:07.264264
[0m10:19:07.266309 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m10:19:07.266309 [debug] [Thread-1  ]: Database Error in model btc_perp_data_1w_current_and_history (models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql)
  SSL connection has been closed unexpectedly
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m10:19:07.266309 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953BA5C10>]}
[0m10:19:07.266309 [error] [Thread-1  ]: 15 of 17 ERROR creating sql table model wizetrading.btc_perp_data_1w_current_and_history  [[31mERROR[0m in 44.83s]
[0m10:19:07.274396 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:19:07.274396 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:19:07.274396 [info ] [Thread-1  ]: 16 of 17 START sql table model wizetrading.btc_perp_data_4h_current_and_history  [RUN]
[0m10:19:07.276480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m10:19:07.276480 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:19:07.276480 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:19:07.276480 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 10:19:07.276480 => 10:19:07.276480
[0m10:19:07.276480 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:19:07.286633 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:19:07.288568 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:19:07.289568 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m10:19:07.289568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:19:07.484067 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:19:07.484067 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:19:07.484067 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
  
  
    as
  
  (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
  
[0m10:19:07.524754 [debug] [Thread-1  ]: Postgres adapter: Postgres error: permission denied for schema wizetrading

[0m10:19:07.525756 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: ROLLBACK
[0m10:19:07.548004 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 10:19:07.276480 => 10:19:07.547076
[0m10:19:07.548004 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m10:19:07.550003 [debug] [Thread-1  ]: Database Error in model btc_perp_data_4h_current_and_history (models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql)
  permission denied for schema wizetrading
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m10:19:07.550003 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953C89DC0>]}
[0m10:19:07.551003 [error] [Thread-1  ]: 16 of 17 ERROR creating sql table model wizetrading.btc_perp_data_4h_current_and_history  [[31mERROR[0m in 0.27s]
[0m10:19:07.552004 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:19:07.552004 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:19:07.553003 [info ] [Thread-1  ]: 17 of 17 START sql table model wizetrading.btc_perp_data_5m_current_and_history  [RUN]
[0m10:19:07.553379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m10:19:07.554443 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:19:07.558385 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:19:07.560383 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 10:19:07.554443 => 10:19:07.559379
[0m10:19:07.560383 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:19:07.564381 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:19:07.565382 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:19:07.566382 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m10:19:07.566382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:19:07.761574 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:19:07.761574 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:19:07.761574 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  
    

  create  table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
  
  
    as
  
  (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
  
[0m10:19:07.792637 [debug] [Thread-1  ]: Postgres adapter: Postgres error: permission denied for schema wizetrading

[0m10:19:07.792637 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: ROLLBACK
[0m10:19:07.813341 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 10:19:07.560383 => 10:19:07.813341
[0m10:19:07.813341 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m10:19:07.821459 [debug] [Thread-1  ]: Database Error in model btc_perp_data_5m_current_and_history (models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql)
  permission denied for schema wizetrading
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m10:19:07.821459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e62cf1e7-7454-4324-9696-07b6fafd0893', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953DB4040>]}
[0m10:19:07.823566 [error] [Thread-1  ]: 17 of 17 ERROR creating sql table model wizetrading.btc_perp_data_5m_current_and_history  [[31mERROR[0m in 0.27s]
[0m10:19:07.823566 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:19:07.823566 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:07.823566 [debug] [MainThread]: On master: BEGIN
[0m10:19:07.823566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:08.026364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:08.026899 [debug] [MainThread]: On master: COMMIT
[0m10:19:08.026899 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.027705 [debug] [MainThread]: On master: COMMIT
[0m10:19:08.047799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:08.048799 [debug] [MainThread]: On master: Close
[0m10:19:08.048799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:08.049792 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m10:19:08.049792 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m10:19:08.049792 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m10:19:08.050799 [info ] [MainThread]: 
[0m10:19:08.050799 [info ] [MainThread]: Finished running 17 table models in 0 hours 5 minutes and 9.90 seconds (309.90s).
[0m10:19:08.054580 [debug] [MainThread]: Command end result
[0m10:19:08.067591 [info ] [MainThread]: 
[0m10:19:08.068585 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:19:08.070110 [info ] [MainThread]: 
[0m10:19:08.070110 [error] [MainThread]:   Database Error in model btc_perp_data_1w_current_and_history (models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql)
  SSL connection has been closed unexpectedly
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m10:19:08.072111 [info ] [MainThread]: 
[0m10:19:08.072111 [error] [MainThread]:   Database Error in model btc_perp_data_4h_current_and_history (models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql)
  permission denied for schema wizetrading
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m10:19:08.073117 [info ] [MainThread]: 
[0m10:19:08.073117 [error] [MainThread]:   Database Error in model btc_perp_data_5m_current_and_history (models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql)
  permission denied for schema wizetrading
  compiled Code at target\run\dbt_wizetrading\models\trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m10:19:08.074110 [info ] [MainThread]: 
[0m10:19:08.075054 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=3 SKIP=0 TOTAL=17
[0m10:19:08.075054 [debug] [MainThread]: Command `dbt run` failed at 10:19:08.075054 after 311.28 seconds
[0m10:19:08.075054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025950A829D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953B600A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025953BF3FD0>]}
[0m10:19:08.075054 [debug] [MainThread]: Flushing usage events
[0m10:25:16.250572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207660809D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207689194F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020768919520>]}


============================== 10:25:16.257572 | e5e0e070-7b34-42a1-84c2-b4ca3bb07c54 ==============================
[0m10:25:16.257572 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:25:16.258573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:25:16.467794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5e0e070-7b34-42a1-84c2-b4ca3bb07c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020766971BE0>]}
[0m10:25:16.541794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5e0e070-7b34-42a1-84c2-b4ca3bb07c54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020768BAD580>]}
[0m10:25:16.542794 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m10:25:16.550788 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:25:16.659013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:25:16.662012 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m10:25:16.766232 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m10:25:16.781239 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m10:25:16.784238 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m10:25:16.787238 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m10:25:16.790233 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m10:25:16.793233 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m10:25:16.796238 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m10:25:16.799238 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m10:25:16.802238 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m10:25:16.805238 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m10:25:16.808238 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m10:25:16.811348 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m10:25:16.821438 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m10:25:16.824438 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m10:25:16.826438 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m10:25:16.829438 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m10:25:16.831438 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m10:25:16.918616 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m10:25:16.985672 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\trading_perp_btc_data\schema.yml @ sources: {'name': 'raw_data_btc_perp', 'description': 'btc data captured from broker', 'database': 'aoavfbel', 'schema': 'wizetrading', 'views': [{'name': 'raw_data', 'description': 'data collectée depuis binance'}]} - at path []: Additional properties are not allowed ('views' was unexpected)
[0m10:25:16.987672 [debug] [MainThread]: Command `dbt run` failed at 10:25:16.987672 after 0.78 seconds
[0m10:25:16.988672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207660809D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020768FB2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020768DF6E80>]}
[0m10:25:16.988672 [debug] [MainThread]: Flushing usage events
[0m10:27:48.522562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028494A62970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284972F53D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284972F5A60>]}


============================== 10:27:48.528561 | a211a2d7-c6ab-4e87-9052-672ea31a5433 ==============================
[0m10:27:48.528561 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:27:48.529556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:48.734559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a211a2d7-c6ab-4e87-9052-672ea31a5433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028495354CD0>]}
[0m10:27:48.811597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a211a2d7-c6ab-4e87-9052-672ea31a5433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028497586520>]}
[0m10:27:48.813676 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m10:27:48.822857 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:27:48.834283 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:27:48.835277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a211a2d7-c6ab-4e87-9052-672ea31a5433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284974A5430>]}
[0m10:27:49.605936 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m10:27:49.619930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m10:27:49.622930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m10:27:49.624930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m10:27:49.627930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m10:27:49.630930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m10:27:49.632930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m10:27:49.635930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m10:27:49.638932 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m10:27:49.640930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m10:27:49.643930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m10:27:49.646923 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m10:27:49.648930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m10:27:49.651930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m10:27:49.654923 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m10:27:49.656923 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m10:27:49.659930 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m10:27:49.722899 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m10:27:49.791901 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models\trading_perp_btc_data\schema.yml @ sources: {'name': 'raw_data_btc_perp', 'description': 'btc data captured from broker', 'database': 'aoavfbel', 'schema': 'wizetrading', 'views': [{'name': 'raw_data', 'description': 'data collectée depuis binance'}]} - at path []: Additional properties are not allowed ('views' was unexpected)
[0m10:27:49.793904 [debug] [MainThread]: Command `dbt run` failed at 10:27:49.793904 after 1.31 seconds
[0m10:27:49.794900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028494A62970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002849790D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002849790D040>]}
[0m10:27:49.794900 [debug] [MainThread]: Flushing usage events
[0m10:33:43.605652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017009C519D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700C4E94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700C4E9520>]}


============================== 10:33:43.611652 | d949a926-4dc6-4144-afca-2214fb13be86 ==============================
[0m10:33:43.611652 [info ] [MainThread]: Running with dbt=1.7.11
[0m10:33:43.612651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:33:43.816630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700A541BE0>]}
[0m10:33:43.899652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700C777580>]}
[0m10:33:43.901652 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m10:33:43.909651 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m10:33:43.920651 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:33:43.920651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700C839850>]}
[0m10:33:44.690151 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m10:33:44.704502 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m10:33:44.707496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m10:33:44.709502 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m10:33:44.712502 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m10:33:44.715502 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m10:33:44.718496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m10:33:44.720496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m10:33:44.723496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m10:33:44.726496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m10:33:44.728497 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m10:33:44.731496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m10:33:44.734496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m10:33:44.737496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m10:33:44.740496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m10:33:44.742496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m10:33:44.745496 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m10:33:44.810494 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m10:33:44.912489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CB08AC0>]}
[0m10:33:44.931500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CBF2EB0>]}
[0m10:33:44.931500 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:33:44.932498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CBF2790>]}
[0m10:33:44.934492 [info ] [MainThread]: 
[0m10:33:44.935490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:44.938494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m10:33:44.948494 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m10:33:44.948494 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m10:33:44.948494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:45.181025 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.0 seconds
[0m10:33:45.182025 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m10:33:45.185025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m10:33:45.190025 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m10:33:45.190025 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m10:33:45.190025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:45.390144 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:33:45.391144 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m10:33:45.391144 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m10:33:45.417143 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:33:45.419143 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m10:33:45.441143 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m10:33:45.453142 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:45.453142 [debug] [MainThread]: On master: BEGIN
[0m10:33:45.454143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:45.655640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:33:45.656640 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:45.657640 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:45.690760 [debug] [MainThread]: SQL status: SELECT 10 in 0.0 seconds
[0m10:33:45.692760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CC2B940>]}
[0m10:33:45.692760 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:45.714759 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:45.715759 [debug] [MainThread]: On master: BEGIN
[0m10:33:45.760712 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:33:45.761712 [debug] [MainThread]: On master: COMMIT
[0m10:33:45.762712 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:45.762712 [debug] [MainThread]: On master: COMMIT
[0m10:33:45.784712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:33:45.785712 [debug] [MainThread]: On master: Close
[0m10:33:45.786712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:33:45.788711 [info ] [MainThread]: 
[0m10:33:45.798711 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m10:33:45.799711 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m10:33:45.800759 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m10:33:45.800759 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m10:33:45.808771 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m10:33:45.810771 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 10:33:45.801771 => 10:33:45.810771
[0m10:33:45.811771 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m10:33:45.844770 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m10:33:45.847772 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:33:45.847772 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m10:33:45.848770 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m10:33:46.035224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:46.035750 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:33:46.036354 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m10:33:46.063027 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:46.069406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:33:46.069988 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m10:33:46.092548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:46.107173 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m10:33:46.107195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:33:46.107195 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m10:33:46.137230 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:46.145327 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m10:33:46.147448 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m10:33:46.147448 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m10:33:46.172979 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:46.173959 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 10:33:45.811771 => 10:33:46.173959
[0m10:33:46.174958 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m10:33:46.174958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CF2B280>]}
[0m10:33:46.175983 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.38s]
[0m10:33:46.176901 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m10:33:46.176901 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m10:33:46.177968 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m10:33:46.178901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m10:33:46.178901 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m10:33:46.181908 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:33:46.182905 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 10:33:46.178901 => 10:33:46.182905
[0m10:33:46.183906 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m10:33:46.186907 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:33:46.187905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:33:46.188906 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m10:33:46.188906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:46.383147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:46.384153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:33:46.384153 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m10:33:46.411146 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:46.414152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:33:46.414152 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m10:33:46.437151 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:46.439144 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m10:33:46.439144 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:33:46.439144 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m10:33:46.466144 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:46.469207 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m10:33:46.470206 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m10:33:46.470206 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m10:33:46.605280 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:46.607285 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 10:33:46.183906 => 10:33:46.607285
[0m10:33:46.607285 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m10:33:46.608284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CF3B1F0>]}
[0m10:33:46.609284 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.43s]
[0m10:33:46.610284 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m10:33:46.610284 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m10:33:46.611284 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m10:33:46.612284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m10:33:46.612284 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m10:33:46.615284 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:33:46.616284 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 10:33:46.612284 => 10:33:46.616284
[0m10:33:46.617340 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m10:33:46.620338 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:33:46.621284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:33:46.622284 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m10:33:46.622284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:46.822892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:46.822892 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:33:46.823892 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m10:33:46.850892 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:46.853891 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:33:46.853891 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m10:33:46.875890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:46.876890 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m10:33:46.877890 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:33:46.877890 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m10:33:46.904891 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:46.907889 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m10:33:46.908890 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m10:33:46.908890 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m10:33:46.930884 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:46.931890 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 10:33:46.617340 => 10:33:46.931890
[0m10:33:46.932887 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m10:33:46.932887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CE67970>]}
[0m10:33:46.933887 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.32s]
[0m10:33:46.934885 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m10:33:46.935890 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:33:46.935890 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m10:33:46.936889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m10:33:46.937887 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:33:46.939888 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:33:46.942883 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 10:33:46.937887 => 10:33:46.941888
[0m10:33:46.942883 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:33:46.946889 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:33:46.948885 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:33:46.948885 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m10:33:46.949884 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:47.149724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:47.150723 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:33:47.150723 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m10:33:47.177723 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:47.180722 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:33:47.181723 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m10:33:47.202721 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:47.204722 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m10:33:47.204722 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:33:47.205721 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m10:33:47.236721 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:47.238720 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m10:33:47.239722 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m10:33:47.240720 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m10:33:47.261720 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:47.262724 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 10:33:46.943889 => 10:33:47.262724
[0m10:33:47.263720 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m10:33:47.264719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CE59820>]}
[0m10:33:47.264719 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m10:33:47.265720 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m10:33:47.266717 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m10:33:47.266717 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m10:33:47.267717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m10:33:47.268717 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m10:33:47.271718 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:33:47.272717 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 10:33:47.268717 => 10:33:47.272717
[0m10:33:47.273717 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m10:33:47.277721 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:33:47.278718 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:33:47.279718 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m10:33:47.279718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:47.478429 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:47.479429 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:33:47.479429 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m10:33:47.506425 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:47.510426 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:33:47.510426 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m10:33:47.532424 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:47.534424 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m10:33:47.534424 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:33:47.534424 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m10:33:47.561424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:47.603447 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m10:33:47.605026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m10:33:47.605532 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m10:33:47.627543 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:47.628543 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 10:33:47.273717 => 10:33:47.628543
[0m10:33:47.629543 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m10:33:47.630543 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CEACBE0>]}
[0m10:33:47.630543 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.36s]
[0m10:33:47.631544 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m10:33:47.632541 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:33:47.632541 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m10:33:47.633542 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m10:33:47.634543 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:33:47.637541 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:33:47.638541 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 10:33:47.634543 => 10:33:47.638541
[0m10:33:47.639538 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:33:47.643740 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:33:47.644744 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:33:47.644744 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m10:33:47.645744 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:47.837973 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:47.837973 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:33:47.838978 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m10:33:47.864976 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:47.867976 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:33:47.868975 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m10:33:47.889975 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:47.891975 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m10:33:47.891975 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:33:47.891975 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m10:33:47.917974 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:47.919974 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m10:33:47.920974 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m10:33:47.921974 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m10:33:47.943974 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:47.945976 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 10:33:47.639538 => 10:33:47.944973
[0m10:33:47.945976 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m10:33:47.946974 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CDAFE20>]}
[0m10:33:47.946974 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.31s]
[0m10:33:47.947974 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m10:33:47.948968 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m10:33:47.948968 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m10:33:47.949968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m10:33:47.950968 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m10:33:47.952968 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:33:47.954969 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 10:33:47.950968 => 10:33:47.954969
[0m10:33:47.954969 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m10:33:47.958973 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:33:47.960967 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:33:47.960967 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m10:33:47.961967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:48.162350 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:48.162350 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:33:48.163350 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m10:33:48.190352 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:48.194349 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:33:48.194349 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m10:33:48.216577 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:48.217634 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m10:33:48.218633 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:33:48.219172 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m10:33:48.245620 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:48.248917 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m10:33:48.249900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m10:33:48.249900 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m10:33:48.272610 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:48.274389 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 10:33:47.955974 => 10:33:48.274389
[0m10:33:48.274936 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m10:33:48.275449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CF21790>]}
[0m10:33:48.276523 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.33s]
[0m10:33:48.277597 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m10:33:48.278111 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:33:48.278637 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m10:33:48.279740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m10:33:48.279740 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:33:48.283027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:33:48.284646 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 10:33:48.280283 => 10:33:48.284134
[0m10:33:48.284646 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:33:48.290637 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:33:48.292638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:33:48.292638 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m10:33:48.293639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:48.506134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:48.507137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:33:48.507137 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m10:33:48.534133 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:48.537133 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:33:48.537133 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m10:33:48.559133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:48.560132 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m10:33:48.561132 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:33:48.561132 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m10:33:48.589035 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:48.592034 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m10:33:48.593035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m10:33:48.593035 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m10:33:48.614034 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:48.616216 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 10:33:48.285211 => 10:33:48.616216
[0m10:33:48.616216 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m10:33:48.617221 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CB9B5B0>]}
[0m10:33:48.618221 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.34s]
[0m10:33:48.619214 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m10:33:48.619214 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m10:33:48.619214 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m10:33:48.620220 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m10:33:48.621221 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m10:33:48.623221 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:33:48.625214 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 10:33:48.621221 => 10:33:48.625214
[0m10:33:48.625214 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m10:33:48.628667 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:33:48.630671 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:33:48.630671 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m10:33:48.631750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:48.830699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:48.830699 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:33:48.831700 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m10:33:48.858699 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:48.862699 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:33:48.862699 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m10:33:48.884698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:48.886697 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m10:33:48.886697 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:33:48.886697 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m10:33:48.913697 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:48.915697 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m10:33:48.916696 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m10:33:48.917697 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m10:33:48.938696 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:48.940697 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 10:33:48.625214 => 10:33:48.939696
[0m10:33:48.940697 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m10:33:48.941696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CB18910>]}
[0m10:33:48.941696 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.32s]
[0m10:33:48.943689 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m10:33:48.943689 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:33:48.944696 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m10:33:48.945691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m10:33:48.945691 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:33:48.948691 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:33:48.949690 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 10:33:48.945691 => 10:33:48.949690
[0m10:33:48.950704 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:33:48.953695 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:33:48.955695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:33:48.956691 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m10:33:48.956691 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:49.156356 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:49.157361 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:33:49.158361 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m10:33:49.185351 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:49.191342 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:33:49.191342 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m10:33:49.214289 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:49.215289 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m10:33:49.216289 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:33:49.216289 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m10:33:49.247288 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:49.250282 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m10:33:49.251288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m10:33:49.252288 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m10:33:49.273287 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:49.275287 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 10:33:48.950704 => 10:33:49.275287
[0m10:33:49.275287 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m10:33:49.276289 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CB18BE0>]}
[0m10:33:49.277287 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.33s]
[0m10:33:49.278282 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m10:33:49.278282 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m10:33:49.279281 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m10:33:49.279281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m10:33:49.280281 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m10:33:49.283282 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:33:49.284283 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 10:33:49.280281 => 10:33:49.284283
[0m10:33:49.285281 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m10:33:49.289674 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:33:49.290688 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:33:49.291678 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m10:33:49.291678 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:49.483210 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:49.484210 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:33:49.484210 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m10:33:49.511209 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:49.514209 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:33:49.515210 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m10:33:49.537215 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:49.538208 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m10:33:49.539208 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:33:49.539208 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m10:33:49.570208 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:49.573207 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m10:33:49.574207 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m10:33:49.574207 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m10:33:49.596100 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:49.598095 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 10:33:49.285281 => 10:33:49.597095
[0m10:33:49.598095 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m10:33:49.599094 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CB1E7F0>]}
[0m10:33:49.599094 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.32s]
[0m10:33:49.601090 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m10:33:49.601090 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:33:49.602089 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m10:33:49.603090 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m10:33:49.603090 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:33:49.606090 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:33:49.607089 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 10:33:49.603090 => 10:33:49.607089
[0m10:33:49.608102 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:33:49.613096 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:33:49.615096 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:33:49.615096 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m10:33:49.616348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:49.795553 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:49.796553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:33:49.796553 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m10:33:49.824546 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:49.827554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:33:49.827554 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m10:33:49.849553 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:49.850554 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m10:33:49.851553 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:33:49.851553 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m10:33:49.878551 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:49.880550 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m10:33:49.881550 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m10:33:49.882551 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m10:33:49.905550 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:49.907549 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 10:33:49.609088 => 10:33:49.906552
[0m10:33:49.907549 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m10:33:49.908549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CB1E7F0>]}
[0m10:33:49.908549 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.31s]
[0m10:33:49.909549 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m10:33:49.910551 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:33:49.910551 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m10:33:49.911549 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m10:33:49.912544 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:33:49.916544 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:33:49.918543 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 10:33:49.912544 => 10:33:49.918543
[0m10:33:49.919544 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:33:49.923543 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:33:49.925544 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:33:49.925544 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m10:33:49.925544 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:50.111134 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:50.111134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:33:50.112139 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:33:50.143138 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:50.147138 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:33:50.147138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m10:33:50.170137 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:50.171137 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m10:33:50.172137 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:33:50.172137 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m10:33:50.200139 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:50.203137 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m10:33:50.204140 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m10:33:50.204140 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m10:33:50.226136 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:50.228136 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 10:33:49.919544 => 10:33:50.228136
[0m10:33:50.228136 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m10:33:50.229136 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CF31190>]}
[0m10:33:50.230135 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.32s]
[0m10:33:50.231129 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m10:33:50.231129 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:33:50.232136 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m10:33:50.233129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m10:33:50.233129 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:33:50.237130 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:33:50.239146 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 10:33:50.234130 => 10:33:50.239146
[0m10:33:50.239146 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:33:50.244135 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:33:50.246129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:33:50.246129 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m10:33:50.246129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:50.441819 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:50.441819 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:33:50.442820 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:33:50.474862 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:50.477862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:33:50.478862 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m10:33:50.501488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:50.502487 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m10:33:50.503487 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:33:50.503487 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m10:33:50.531487 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:50.536487 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m10:33:50.537486 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m10:33:50.538486 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m10:33:50.560543 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:50.561541 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 10:33:50.240136 => 10:33:50.561541
[0m10:33:50.561541 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m10:33:50.562542 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CF31700>]}
[0m10:33:50.563538 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.33s]
[0m10:33:50.564518 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m10:33:50.564518 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:33:50.564518 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m10:33:50.565481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m10:33:50.565481 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:33:50.569505 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:33:50.574543 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 10:33:50.566573 => 10:33:50.574543
[0m10:33:50.575551 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:33:50.578580 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:33:50.580573 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:33:50.580573 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m10:33:50.580573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:50.786765 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:50.786765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:33:50.787766 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:33:50.818761 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:50.822761 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:33:50.822761 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m10:33:50.844760 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:50.846760 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m10:33:50.846760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:33:50.847763 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m10:33:50.875760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:50.878759 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m10:33:50.879760 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m10:33:50.879760 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m10:33:50.902759 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:50.903759 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 10:33:50.575551 => 10:33:50.903759
[0m10:33:50.903759 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m10:33:50.904759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CF4C820>]}
[0m10:33:50.905759 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.34s]
[0m10:33:50.906793 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m10:33:50.906793 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:33:50.907760 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m10:33:50.908753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m10:33:50.908753 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:33:50.912753 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:33:50.914752 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 10:33:50.909754 => 10:33:50.914752
[0m10:33:50.914752 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:33:50.918753 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:33:50.920752 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:33:50.920752 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m10:33:50.921753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:51.133135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:51.133135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:33:51.134137 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:33:51.165138 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:51.169135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:33:51.169135 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m10:33:51.192133 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:51.193136 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m10:33:51.193136 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:33:51.194135 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m10:33:51.221131 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:51.224134 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m10:33:51.225134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m10:33:51.226138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m10:33:51.247192 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:51.249134 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 10:33:50.914752 => 10:33:51.249134
[0m10:33:51.250138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m10:33:51.251138 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700C8BB5B0>]}
[0m10:33:51.252136 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.34s]
[0m10:33:51.253217 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m10:33:51.254196 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:33:51.255131 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m10:33:51.256130 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m10:33:51.257129 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:33:51.261129 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:33:51.263459 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 10:33:51.257129 => 10:33:51.263459
[0m10:33:51.264468 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:33:51.268497 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:33:51.270006 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:33:51.271002 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m10:33:51.271257 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:33:51.470855 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:33:51.471855 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:33:51.472849 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m10:33:51.504910 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:33:51.510913 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:33:51.511906 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m10:33:51.535931 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:33:51.538925 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m10:33:51.539907 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:33:51.540941 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m10:33:51.567921 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:33:51.573901 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m10:33:51.574910 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m10:33:51.575924 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m10:33:51.598425 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:33:51.599168 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 10:33:51.264468 => 10:33:51.599168
[0m10:33:51.600172 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m10:33:51.600172 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd949a926-4dc6-4144-afca-2214fb13be86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700C8BC250>]}
[0m10:33:51.601172 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.34s]
[0m10:33:51.602453 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m10:33:51.603963 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:51.603963 [debug] [MainThread]: On master: BEGIN
[0m10:33:51.604849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:51.783607 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:33:51.784602 [debug] [MainThread]: On master: COMMIT
[0m10:33:51.784602 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:51.784602 [debug] [MainThread]: On master: COMMIT
[0m10:33:51.805607 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:33:51.806601 [debug] [MainThread]: On master: Close
[0m10:33:51.806601 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:51.807608 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m10:33:51.807608 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m10:33:51.807608 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m10:33:51.808608 [info ] [MainThread]: 
[0m10:33:51.808608 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 6.87 seconds (6.87s).
[0m10:33:51.811600 [debug] [MainThread]: Command end result
[0m10:33:51.824600 [info ] [MainThread]: 
[0m10:33:51.825601 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:51.825601 [info ] [MainThread]: 
[0m10:33:51.826680 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m10:33:51.827602 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:51.827602 after 8.26 seconds
[0m10:33:51.828671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017009C519D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700CAC3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001700C742940>]}
[0m10:33:51.828671 [debug] [MainThread]: Flushing usage events
[0m14:11:03.454646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BA1DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E2C94C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E2C9550>]}


============================== 14:11:03.474646 | 5eb6c6eb-8b79-4f9c-8d38-02aab14ea743 ==============================
[0m14:11:03.474646 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:11:03.476659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:11:03.871688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5eb6c6eb-8b79-4f9c-8d38-02aab14ea743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0C329EE0>]}
[0m14:11:03.970831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5eb6c6eb-8b79-4f9c-8d38-02aab14ea743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E62DC10>]}
[0m14:11:03.972899 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:11:03.996112 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:11:05.066784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:05.068782 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m14:11:05.094788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5eb6c6eb-8b79-4f9c-8d38-02aab14ea743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E907850>]}
[0m14:11:05.177985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5eb6c6eb-8b79-4f9c-8d38-02aab14ea743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E6391F0>]}
[0m14:11:05.179355 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:11:05.180865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5eb6c6eb-8b79-4f9c-8d38-02aab14ea743', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E5F6790>]}
[0m14:11:05.183864 [info ] [MainThread]: 
[0m14:11:05.185619 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:11:05.186722 [debug] [MainThread]: Command end result
[0m14:11:05.205261 [debug] [MainThread]: Command `dbt test` succeeded at 14:11:05.205261 after 1.83 seconds
[0m14:11:05.206259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0BA1DA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E61E9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA0E6391F0>]}
[0m14:11:05.207271 [debug] [MainThread]: Flushing usage events
[0m14:24:12.277041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6C7519A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6EFE6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6EFE6490>]}


============================== 14:24:12.285350 | b00d0687-8f9a-454c-bd0d-cddb5901f1a8 ==============================
[0m14:24:12.285350 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:24:12.287444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:12.525912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6D0487F0>]}
[0m14:24:12.604027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6EFCC730>]}
[0m14:24:12.606027 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:24:12.613024 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:24:12.721682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:12.722682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:12.728681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F5A0250>]}
[0m14:24:12.747477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F378E20>]}
[0m14:24:12.748479 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:24:12.749479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F545F70>]}
[0m14:24:12.750546 [info ] [MainThread]: 
[0m14:24:12.751482 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:12.754477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m14:24:12.763474 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m14:24:12.763474 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m14:24:12.764474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:13.029738 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.0 seconds
[0m14:24:13.031739 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m14:24:13.037740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m14:24:13.047672 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:24:13.047672 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m14:24:13.048672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:13.245247 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:24:13.246232 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:24:13.246232 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m14:24:13.277148 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:24:13.279205 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m14:24:13.300212 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m14:24:13.312148 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:13.313149 [debug] [MainThread]: On master: BEGIN
[0m14:24:13.314151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:13.503489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:13.504498 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:13.504498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:13.540702 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m14:24:13.588910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F190880>]}
[0m14:24:13.589842 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:13.615793 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:13.616363 [debug] [MainThread]: On master: BEGIN
[0m14:24:13.659762 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:13.660777 [debug] [MainThread]: On master: COMMIT
[0m14:24:13.660777 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:13.661775 [debug] [MainThread]: On master: COMMIT
[0m14:24:13.683460 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:13.684393 [debug] [MainThread]: On master: Close
[0m14:24:13.684393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:13.685393 [info ] [MainThread]: 
[0m14:24:13.701392 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m14:24:13.702392 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m14:24:13.704394 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m14:24:13.704394 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m14:24:13.712460 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:13.714393 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 14:24:13.705393 => 14:24:13.714393
[0m14:24:13.715431 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m14:24:13.747396 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:13.749391 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:13.750392 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m14:24:13.750392 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:24:13.939873 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:13.940875 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:13.941874 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m14:24:13.956588 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:13.972214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:13.972214 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m14:24:13.987840 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:14.003464 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:14.007705 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m14:24:14.028868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:14.044987 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:24:14.044987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:14.044987 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:24:14.060880 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:14.076573 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m14:24:14.076573 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:24:14.076573 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m14:24:14.135370 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:14.138369 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 14:24:13.715431 => 14:24:14.137366
[0m14:24:14.138369 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m14:24:14.139365 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F678460>]}
[0m14:24:14.140365 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.44s]
[0m14:24:14.141939 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m14:24:14.141939 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:24:14.143945 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m14:24:14.144945 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m14:24:14.144945 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m14:24:14.147946 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.149946 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 14:24:14.145946 => 14:24:14.149946
[0m14:24:14.150946 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m14:24:14.154860 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.156412 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.156412 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m14:24:14.156412 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:14.341198 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:14.342197 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.343197 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m14:24:14.370268 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:14.375196 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.376195 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m14:24:14.405193 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:14.410468 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.411468 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m14:24:14.434739 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:14.439692 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:24:14.440714 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.441699 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:24:14.472506 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:14.476448 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m14:24:14.477449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:24:14.477449 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m14:24:14.506226 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:14.507726 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 14:24:14.150946 => 14:24:14.507726
[0m14:24:14.508226 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m14:24:14.509226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F79A4C0>]}
[0m14:24:14.509727 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.37s]
[0m14:24:14.511728 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:24:14.512802 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:24:14.514036 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m14:24:14.516222 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m14:24:14.516746 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m14:24:14.519694 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:24:14.521576 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 14:24:14.517268 => 14:24:14.521576
[0m14:24:14.522577 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m14:24:14.529097 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:24:14.532154 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:24:14.532693 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m14:24:14.533220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:14.735480 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:14.736479 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:24:14.737481 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m14:24:14.764584 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:14.771173 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:24:14.772187 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m14:24:14.799323 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:14.801325 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:24:14.802324 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:24:14.802324 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:24:14.831327 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:14.835322 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m14:24:14.837323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:24:14.837323 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m14:24:14.859324 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:14.861323 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 14:24:14.522577 => 14:24:14.861323
[0m14:24:14.862323 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m14:24:14.863324 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F672730>]}
[0m14:24:14.863324 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.35s]
[0m14:24:14.864324 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:24:14.865325 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:24:14.866324 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m14:24:14.866324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m14:24:14.867323 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:24:14.870323 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:24:14.872322 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 14:24:14.867323 => 14:24:14.871322
[0m14:24:14.873379 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:24:14.877405 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:24:14.879323 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:24:14.879323 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m14:24:14.880324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:15.098004 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:15.099004 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:24:15.099004 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m14:24:15.127008 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:15.133005 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:24:15.134006 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m14:24:15.157381 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:15.160379 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:24:15.161381 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:24:15.162380 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:24:15.190155 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:15.195094 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m14:24:15.197095 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:24:15.198096 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m14:24:15.221097 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:15.224096 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 14:24:14.873379 => 14:24:15.224096
[0m14:24:15.225095 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m14:24:15.227096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F6DEFA0>]}
[0m14:24:15.232486 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.36s]
[0m14:24:15.234097 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:24:15.235154 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:24:15.236094 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m14:24:15.237701 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m14:24:15.238764 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m14:24:15.244137 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:24:15.247138 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 14:24:15.238764 => 14:24:15.247138
[0m14:24:15.248138 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m14:24:15.255137 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:24:15.257146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:24:15.258138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m14:24:15.259264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:15.474083 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:15.475082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:24:15.476082 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m14:24:15.503081 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:15.508081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:24:15.508081 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m14:24:15.533081 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:15.535082 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:24:15.536082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:24:15.536082 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:24:15.565081 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:15.569081 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m14:24:15.570082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:24:15.571082 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m14:24:15.593083 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:15.596083 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 14:24:15.249138 => 14:24:15.595083
[0m14:24:15.596083 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m14:24:15.597082 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F7988E0>]}
[0m14:24:15.598082 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.36s]
[0m14:24:15.599081 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:24:15.600081 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:24:15.601082 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m14:24:15.602081 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m14:24:15.603122 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:24:15.607082 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:24:15.610082 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 14:24:15.603122 => 14:24:15.609082
[0m14:24:15.610082 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:24:15.615271 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:24:15.617270 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:24:15.618270 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m14:24:15.618270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:15.830459 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:15.831590 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:24:15.831590 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m14:24:15.859906 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:15.874534 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:24:15.875141 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m14:24:15.896961 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:15.898671 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:24:15.899302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:24:15.899873 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:24:15.930594 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:15.936911 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m14:24:15.937785 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:24:15.937785 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m14:24:15.961267 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:15.962270 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 14:24:15.611083 => 14:24:15.962270
[0m14:24:15.963274 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m14:24:15.963274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F672EB0>]}
[0m14:24:15.964268 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.36s]
[0m14:24:15.965267 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:24:15.966270 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:24:15.966270 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m14:24:15.967267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m14:24:15.968329 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m14:24:15.971330 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:24:15.973268 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 14:24:15.968329 => 14:24:15.973268
[0m14:24:15.973268 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m14:24:15.977324 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:24:15.979272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:24:15.979272 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m14:24:15.980268 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:16.190546 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:16.191508 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:24:16.192505 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m14:24:16.221323 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:16.227834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:24:16.227834 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m14:24:16.250784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:16.253740 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:24:16.254739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:24:16.255738 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:24:16.283398 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:16.288398 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m14:24:16.289399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:24:16.290404 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m14:24:16.313397 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:16.314407 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 14:24:15.974316 => 14:24:16.314407
[0m14:24:16.314407 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m14:24:16.315399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F672EB0>]}
[0m14:24:16.316398 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.35s]
[0m14:24:16.317398 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:24:16.317398 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:24:16.318398 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m14:24:16.319396 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m14:24:16.319396 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:24:16.322459 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:24:16.324396 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 14:24:16.320403 => 14:24:16.324396
[0m14:24:16.325453 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:24:16.329481 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:24:16.330397 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:24:16.331395 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m14:24:16.331395 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:16.519135 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:16.519135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:24:16.520138 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m14:24:16.555005 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:16.561986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:24:16.562986 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m14:24:16.586588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:16.588597 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:24:16.589597 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:24:16.589597 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:24:16.628591 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:16.632592 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m14:24:16.633592 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:24:16.634593 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m14:24:16.656695 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:16.658693 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 14:24:16.325453 => 14:24:16.657693
[0m14:24:16.658693 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m14:24:16.659693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F6DEFA0>]}
[0m14:24:16.659693 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.34s]
[0m14:24:16.661426 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:24:16.661426 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:24:16.662437 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m14:24:16.663532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m14:24:16.664988 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m14:24:16.670038 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:24:16.672007 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 14:24:16.665416 => 14:24:16.670821
[0m14:24:16.672521 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m14:24:16.677367 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:24:16.679113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:24:16.679113 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m14:24:16.679113 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:16.880334 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:16.880851 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:24:16.881857 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m14:24:16.909709 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:16.912736 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:24:16.912736 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m14:24:16.944208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:16.945260 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:24:16.945260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:24:16.946267 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:24:16.972226 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:16.976200 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m14:24:16.978201 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:24:16.979201 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m14:24:17.002281 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:17.004199 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 14:24:16.673134 => 14:24:17.004199
[0m14:24:17.004199 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m14:24:17.005199 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F6BD0A0>]}
[0m14:24:17.006199 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.34s]
[0m14:24:17.007564 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:24:17.007564 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:24:17.008574 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m14:24:17.009577 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m14:24:17.009577 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:24:17.012576 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:24:17.013577 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 14:24:17.009577 => 14:24:17.013577
[0m14:24:17.014578 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:24:17.018576 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:24:17.020394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:24:17.020394 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m14:24:17.020394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:17.235256 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:17.236247 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:24:17.236247 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m14:24:17.264726 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:17.270129 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:24:17.270129 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m14:24:17.293202 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:17.296205 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:24:17.296205 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:24:17.297193 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:24:17.326117 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:17.330117 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m14:24:17.331117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:24:17.331117 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m14:24:17.353121 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:17.356125 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 14:24:17.014578 => 14:24:17.356125
[0m14:24:17.357195 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m14:24:17.359178 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F62DAF0>]}
[0m14:24:17.360184 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.35s]
[0m14:24:17.362178 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:24:17.362178 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:24:17.363173 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m14:24:17.364118 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m14:24:17.365183 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m14:24:17.368117 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:24:17.370119 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 14:24:17.365183 => 14:24:17.370119
[0m14:24:17.371118 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m14:24:17.378117 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:24:17.380357 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:24:17.381359 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m14:24:17.381359 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:17.585154 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:17.587158 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:24:17.587158 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m14:24:17.615699 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:17.622703 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:24:17.623690 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m14:24:17.646633 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:17.650715 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:24:17.652689 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:24:17.653700 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:24:17.685165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:17.688166 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m14:24:17.688166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:24:17.689165 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m14:24:17.712665 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:17.714665 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 14:24:17.372118 => 14:24:17.714665
[0m14:24:17.715665 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m14:24:17.716665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F61B2B0>]}
[0m14:24:17.717665 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.35s]
[0m14:24:17.718665 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:24:17.719668 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:24:17.719668 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m14:24:17.720666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m14:24:17.721669 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:24:17.723668 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:24:17.725668 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 14:24:17.721669 => 14:24:17.725668
[0m14:24:17.725668 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:24:17.731665 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:24:17.734664 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:24:17.734664 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m14:24:17.735665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:17.931721 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:17.932722 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:24:17.933736 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m14:24:17.967909 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:17.977644 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:24:17.977644 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m14:24:18.001484 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:18.003482 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:24:18.004482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:24:18.005488 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:24:18.032817 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:18.036306 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m14:24:18.036865 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:24:18.037482 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m14:24:18.071980 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:18.074980 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 14:24:17.725668 => 14:24:18.073981
[0m14:24:18.074980 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m14:24:18.076981 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F73AE20>]}
[0m14:24:18.076981 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.36s]
[0m14:24:18.078996 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:24:18.080000 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:24:18.080000 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m14:24:18.080983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m14:24:18.080983 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:24:18.084982 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:24:18.088590 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 14:24:18.081981 => 14:24:18.088096
[0m14:24:18.089091 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:24:18.092660 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:24:18.095588 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:24:18.096588 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m14:24:18.097588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:18.296926 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:18.297915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:24:18.297915 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:24:18.330935 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:18.336861 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:24:18.337862 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m14:24:18.362854 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:18.364854 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:24:18.365853 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:24:18.365853 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:24:18.399852 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:18.403856 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m14:24:18.405852 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:24:18.405852 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m14:24:18.430852 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:18.433852 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 14:24:18.089091 => 14:24:18.432852
[0m14:24:18.434852 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m14:24:18.435852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F6A15B0>]}
[0m14:24:18.437852 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.35s]
[0m14:24:18.439006 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:24:18.439506 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:24:18.439506 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m14:24:18.440517 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m14:24:18.441515 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:24:18.444514 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:24:18.447579 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 14:24:18.441515 => 14:24:18.447579
[0m14:24:18.448593 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:24:18.453603 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:24:18.456600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:24:18.457521 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m14:24:18.458514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:18.681998 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:18.683007 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:24:18.683953 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:24:18.719588 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:18.723587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:24:18.723587 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m14:24:18.747675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:18.749659 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:24:18.750662 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:24:18.750662 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:24:18.781654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:18.787655 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m14:24:18.789667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:24:18.790655 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m14:24:18.823653 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:18.825647 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 14:24:18.448593 => 14:24:18.825647
[0m14:24:18.825647 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m14:24:18.826652 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F715D60>]}
[0m14:24:18.826652 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.39s]
[0m14:24:18.827656 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:24:18.828649 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:24:18.828649 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m14:24:18.829647 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m14:24:18.829647 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:24:18.833648 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:24:18.835589 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 14:24:18.830652 => 14:24:18.835589
[0m14:24:18.835589 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:24:18.840607 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:24:18.842687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:24:18.842687 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m14:24:18.843697 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:19.071625 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:19.072204 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:24:19.072806 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:24:19.105437 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:19.108437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:24:19.109438 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m14:24:19.134387 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:19.137307 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:24:19.137307 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:24:19.138307 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:24:19.168302 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:19.170302 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m14:24:19.171302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:24:19.171302 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m14:24:19.194303 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:19.196300 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 14:24:18.836649 => 14:24:19.196300
[0m14:24:19.197301 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m14:24:19.198301 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F7BE670>]}
[0m14:24:19.199300 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.37s]
[0m14:24:19.200292 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:24:19.200793 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:24:19.201801 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m14:24:19.201801 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m14:24:19.202804 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:24:19.205804 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:24:19.207801 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 14:24:19.202804 => 14:24:19.207801
[0m14:24:19.208800 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:24:19.214323 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:24:19.216322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:24:19.217324 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m14:24:19.218323 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:19.420117 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:19.421179 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:24:19.422186 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:24:19.464115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:19.469178 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:24:19.469178 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m14:24:19.493519 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:19.494497 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:24:19.495488 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:24:19.495488 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:24:19.528873 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:19.534878 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m14:24:19.535866 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:24:19.536897 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m14:24:19.563658 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:19.566651 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 14:24:19.208800 => 14:24:19.565651
[0m14:24:19.566651 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m14:24:19.568652 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F62DAF0>]}
[0m14:24:19.569648 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.37s]
[0m14:24:19.570589 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:24:19.571588 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:24:19.571588 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m14:24:19.573593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m14:24:19.573593 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:24:19.577590 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:24:19.580589 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 14:24:19.573593 => 14:24:19.579589
[0m14:24:19.580589 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:24:19.586590 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:24:19.588587 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:24:19.589588 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m14:24:19.589588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:24:19.789956 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:24:19.790951 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:24:19.791954 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:24:19.826960 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:19.833953 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:24:19.834965 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m14:24:19.858973 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:19.861952 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:24:19.862977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:24:19.863959 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:24:19.890957 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:24:19.893946 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m14:24:19.894987 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:24:19.894987 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m14:24:19.917718 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:19.920735 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 14:24:19.580589 => 14:24:19.920735
[0m14:24:19.921721 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m14:24:19.923724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b00d0687-8f9a-454c-bd0d-cddb5901f1a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F705D60>]}
[0m14:24:19.924717 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.35s]
[0m14:24:19.926732 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:24:19.928720 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:19.928720 [debug] [MainThread]: On master: BEGIN
[0m14:24:19.928720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:20.118403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:20.119403 [debug] [MainThread]: On master: COMMIT
[0m14:24:20.120402 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:20.121402 [debug] [MainThread]: On master: COMMIT
[0m14:24:20.143401 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:20.143401 [debug] [MainThread]: On master: Close
[0m14:24:20.144503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:20.145693 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m14:24:20.145693 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m14:24:20.146678 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m14:24:20.146678 [info ] [MainThread]: 
[0m14:24:20.147678 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m14:24:20.150679 [debug] [MainThread]: Command end result
[0m14:24:20.166357 [info ] [MainThread]: 
[0m14:24:20.167365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:20.168357 [info ] [MainThread]: 
[0m14:24:20.168357 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m14:24:20.170360 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:20.169359 after 7.94 seconds
[0m14:24:20.170360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6C7519A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F378F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C6F7060A0>]}
[0m14:24:20.170360 [debug] [MainThread]: Flushing usage events
[0m14:26:10.290559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021975A7F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197832A580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197832AC10>]}


============================== 14:26:10.296542 | f7d9c114-b844-4294-94b3-ab69536646a9 ==============================
[0m14:26:10.296542 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:26:10.297477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:26:10.518990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7d9c114-b844-4294-94b3-ab69536646a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197639B580>]}
[0m14:26:10.616016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7d9c114-b844-4294-94b3-ab69536646a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219785B2280>]}
[0m14:26:10.617668 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:26:10.626502 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:26:10.727825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:26:10.729881 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m14:26:10.824821 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m14:26:10.936004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7d9c114-b844-4294-94b3-ab69536646a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219788B64F0>]}
[0m14:26:10.943069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7d9c114-b844-4294-94b3-ab69536646a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197853D640>]}
[0m14:26:10.944008 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:26:10.944944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7d9c114-b844-4294-94b3-ab69536646a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021978942730>]}
[0m14:26:10.947453 [info ] [MainThread]: 
[0m14:26:10.948455 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:26:10.951451 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m14:26:10.963336 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:26:10.963336 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m14:26:10.964297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:11.188509 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:26:11.189486 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:26:11.191483 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m14:26:11.218475 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:26:11.221499 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m14:26:11.244621 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m14:26:11.253656 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:11.254623 [debug] [MainThread]: On master: BEGIN
[0m14:26:11.254623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:11.454457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:26:11.454457 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:11.455458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:26:11.492387 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m14:26:11.498339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7d9c114-b844-4294-94b3-ab69536646a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021978584550>]}
[0m14:26:11.498339 [debug] [MainThread]: On master: ROLLBACK
[0m14:26:11.525806 [debug] [MainThread]: On master: Close
[0m14:26:11.526800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:26:11.528176 [info ] [MainThread]: 
[0m14:26:11.537223 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m14:26:11.538224 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m14:26:11.538224 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m14:26:11.547691 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:26:11.550126 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 14:26:11.538224 => 14:26:11.549034
[0m14:26:11.551126 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m14:26:11.551126 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 14:26:11.551126 => 14:26:11.551126
[0m14:26:11.552126 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m14:26:11.553126 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:26:11.554127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m14:26:11.554127 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m14:26:11.559598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:26:11.562599 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 14:26:11.555066 => 14:26:11.561599
[0m14:26:11.562599 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m14:26:11.564320 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 14:26:11.563598 => 14:26:11.563598
[0m14:26:11.564820 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:26:11.565828 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:26:11.566828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m14:26:11.567828 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m14:26:11.572840 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:26:11.576507 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 14:26:11.568828 => 14:26:11.575619
[0m14:26:11.577522 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m14:26:11.578455 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 14:26:11.577956 => 14:26:11.577956
[0m14:26:11.580471 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:26:11.581505 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:26:11.582466 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m14:26:11.583002 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:26:11.585985 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:26:11.594748 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 14:26:11.583002 => 14:26:11.594285
[0m14:26:11.596355 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:26:11.597095 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 14:26:11.596783 => 14:26:11.596783
[0m14:26:11.598334 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:26:11.599346 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:26:11.600345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m14:26:11.600345 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m14:26:11.603346 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:26:11.606381 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 14:26:11.601348 => 14:26:11.605793
[0m14:26:11.606381 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m14:26:11.607397 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 14:26:11.607397 => 14:26:11.607397
[0m14:26:11.609400 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:26:11.610402 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:26:11.610402 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m14:26:11.611401 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:26:11.615398 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:26:11.617413 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 14:26:11.611401 => 14:26:11.616399
[0m14:26:11.617413 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:26:11.618399 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 14:26:11.617413 => 14:26:11.617413
[0m14:26:11.619398 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:26:11.619398 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:26:11.620399 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m14:26:11.620399 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m14:26:11.625398 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:26:11.628120 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 14:26:11.621399 => 14:26:11.627345
[0m14:26:11.628120 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m14:26:11.629137 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 14:26:11.628120 => 14:26:11.629137
[0m14:26:11.630150 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:26:11.631138 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:26:11.631138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m14:26:11.632155 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:26:11.636137 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:26:11.637137 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 14:26:11.632155 => 14:26:11.637137
[0m14:26:11.638137 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:26:11.639149 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 14:26:11.638137 => 14:26:11.638137
[0m14:26:11.640140 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:26:11.640140 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:26:11.641139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m14:26:11.642138 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m14:26:11.645140 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:26:11.647140 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 14:26:11.642138 => 14:26:11.647140
[0m14:26:11.647140 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m14:26:11.648143 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 14:26:11.648143 => 14:26:11.648143
[0m14:26:11.649140 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:26:11.649140 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:26:11.650138 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m14:26:11.650138 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:26:11.654140 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:26:11.656323 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 14:26:11.651140 => 14:26:11.656323
[0m14:26:11.657324 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:26:11.658346 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 14:26:11.658346 => 14:26:11.658346
[0m14:26:11.659325 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:26:11.660323 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:26:11.660323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m14:26:11.661323 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m14:26:11.664324 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:26:11.666486 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 14:26:11.661323 => 14:26:11.665977
[0m14:26:11.666517 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m14:26:11.667050 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 14:26:11.667050 => 14:26:11.667050
[0m14:26:11.668292 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:26:11.668821 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:26:11.669404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m14:26:11.670023 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:26:11.673605 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:26:11.675205 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 14:26:11.670023 => 14:26:11.674676
[0m14:26:11.676241 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:26:11.676898 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 14:26:11.676393 => 14:26:11.676393
[0m14:26:11.677581 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:26:11.678191 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:26:11.679344 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m14:26:11.679995 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:26:11.683552 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:26:11.685900 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 14:26:11.680501 => 14:26:11.685389
[0m14:26:11.686920 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:26:11.687642 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 14:26:11.687137 => 14:26:11.687137
[0m14:26:11.688504 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:26:11.689008 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:26:11.689508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m14:26:11.690008 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:26:11.694213 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:26:11.696671 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 14:26:11.690503 => 14:26:11.696207
[0m14:26:11.697167 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:26:11.697669 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 14:26:11.697669 => 14:26:11.697669
[0m14:26:11.698670 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:26:11.699168 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:26:11.699668 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m14:26:11.700169 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:26:11.704169 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:26:11.706167 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 14:26:11.700668 => 14:26:11.705667
[0m14:26:11.706667 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:26:11.707170 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 14:26:11.707170 => 14:26:11.707170
[0m14:26:11.708166 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:26:11.708666 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:26:11.709667 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m14:26:11.710167 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:26:11.715351 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:26:11.717994 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 14:26:11.710668 => 14:26:11.717468
[0m14:26:11.718514 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:26:11.719035 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 14:26:11.719035 => 14:26:11.719035
[0m14:26:11.720092 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:26:11.720617 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:26:11.721670 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m14:26:11.722194 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:26:11.723864 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:26:11.728726 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 14:26:11.722706 => 14:26:11.723864
[0m14:26:11.729982 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:26:11.731152 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 14:26:11.730621 => 14:26:11.730689
[0m14:26:11.732563 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:26:11.734243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:11.734785 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m14:26:11.735285 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m14:26:11.738322 [debug] [MainThread]: Command end result
[0m14:26:11.931007 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:26:11.932014 [info ] [MainThread]: Building catalog
[0m14:26:11.936005 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m14:26:11.943815 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m14:26:11.943815 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m14:26:11.944818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:12.154217 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:26:12.155213 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m14:26:12.156227 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perptreated_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_current_and_history')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:26:12.233334 [debug] [ThreadPool]: SQL status: SELECT 570 in 0.0 seconds
[0m14:26:12.263787 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m14:26:12.293801 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m14:26:12.338253 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\dbt-wizetrading-demo\target\catalog.json
[0m14:26:12.341252 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:26:12.340251 after 2.09 seconds
[0m14:26:12.341252 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:26:12.342073 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m14:26:12.342581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021975A7F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197639B580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219785B2280>]}
[0m14:26:12.342581 [debug] [MainThread]: Flushing usage events
[0m14:39:14.619016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F674ADE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6773894F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677389520>]}


============================== 14:39:14.627905 | 92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff ==============================
[0m14:39:14.627905 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:39:14.630100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:14.897493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6753E8BE0>]}
[0m14:39:14.985188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67761E580>]}
[0m14:39:14.987188 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:39:15.001322 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:39:15.121042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:15.121042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:15.128036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677945160>]}
[0m14:39:15.159697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677817D60>]}
[0m14:39:15.160697 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:39:15.162698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6778E5EE0>]}
[0m14:39:15.165782 [info ] [MainThread]: 
[0m14:39:15.167792 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:15.172791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m14:39:15.189791 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m14:39:15.190779 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m14:39:15.191771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:15.453660 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.0 seconds
[0m14:39:15.458657 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m14:39:15.463678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m14:39:15.472873 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:39:15.473876 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m14:39:15.474874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:15.684896 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:39:15.687409 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:39:15.687910 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m14:39:15.714960 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:39:15.718961 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m14:39:15.741959 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m14:39:15.757262 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:15.758263 [debug] [MainThread]: On master: BEGIN
[0m14:39:15.758263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:15.951041 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:39:15.951934 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:15.952967 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:15.991053 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m14:39:16.065216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F67797D3A0>]}
[0m14:39:16.066217 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:16.089293 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:16.090266 [debug] [MainThread]: On master: BEGIN
[0m14:39:16.134284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:39:16.135225 [debug] [MainThread]: On master: COMMIT
[0m14:39:16.136308 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:16.137449 [debug] [MainThread]: On master: COMMIT
[0m14:39:16.160556 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:39:16.162541 [debug] [MainThread]: On master: Close
[0m14:39:16.164542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:16.167478 [info ] [MainThread]: 
[0m14:39:16.182339 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m14:39:16.183579 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m14:39:16.185156 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m14:39:16.186254 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m14:39:16.195635 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.198620 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 14:39:16.186254 => 14:39:16.197635
[0m14:39:16.200077 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m14:39:16.244552 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.247572 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.248550 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m14:39:16.249553 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:39:16.440724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:16.441703 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.442737 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m14:39:16.470712 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:16.480636 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.481658 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m14:39:16.505488 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:16.512606 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.513594 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m14:39:16.536745 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:16.563995 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:39:16.563995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.564994 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:39:16.594035 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:16.609056 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m14:39:16.615007 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:39:16.615998 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m14:39:16.663629 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:16.667989 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 14:39:16.200077 => 14:39:16.667418
[0m14:39:16.667989 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m14:39:16.670087 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6779B43A0>]}
[0m14:39:16.670087 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.48s]
[0m14:39:16.672099 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m14:39:16.672099 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:39:16.673096 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m14:39:16.674113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m14:39:16.675089 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m14:39:16.678091 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:16.681912 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 14:39:16.675089 => 14:39:16.681277
[0m14:39:16.682476 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m14:39:16.691787 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:16.695768 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:16.697271 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m14:39:16.698297 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:16.917938 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:16.919439 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:16.920935 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m14:39:16.948395 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:16.957607 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:16.958977 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m14:39:16.983460 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:16.991461 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:16.993460 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m14:39:17.016968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:17.021232 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:39:17.021787 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:17.022836 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:39:17.048725 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:17.056556 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m14:39:17.057825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:39:17.059016 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m14:39:17.089041 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:17.092990 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 14:39:16.683474 => 14:39:17.091993
[0m14:39:17.092990 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m14:39:17.094990 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677B2AFA0>]}
[0m14:39:17.094990 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.42s]
[0m14:39:17.096984 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:39:17.097982 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:39:17.098992 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m14:39:17.100984 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m14:39:17.101989 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m14:39:17.105987 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:39:17.107983 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 14:39:17.102983 => 14:39:17.107983
[0m14:39:17.108982 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m14:39:17.113996 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:39:17.115981 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:39:17.117401 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m14:39:17.117401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:17.325836 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:17.326860 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:39:17.327862 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m14:39:17.363287 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:17.374405 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:39:17.374405 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m14:39:17.398964 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:17.401360 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:39:17.402525 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:39:17.403526 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:39:17.432332 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:17.438067 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m14:39:17.440066 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:39:17.443009 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m14:39:17.467520 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:17.470918 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 14:39:17.108982 => 14:39:17.470033
[0m14:39:17.470918 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m14:39:17.473249 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677A56A60>]}
[0m14:39:17.474256 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.37s]
[0m14:39:17.475312 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:39:17.476322 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:39:17.477269 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m14:39:17.479254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m14:39:17.480300 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:39:17.484694 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:39:17.487996 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 14:39:17.481160 => 14:39:17.487007
[0m14:39:17.489000 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:39:17.495001 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:39:17.497995 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:39:17.497995 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m14:39:17.498995 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:17.692202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:17.693199 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:39:17.694233 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m14:39:17.722074 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:17.729071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:39:17.729071 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m14:39:17.753090 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:17.757071 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:39:17.758080 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:39:17.758080 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:39:17.789012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:17.794183 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m14:39:17.795184 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:39:17.796173 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m14:39:17.819096 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:17.822714 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 14:39:17.489000 => 14:39:17.822714
[0m14:39:17.823840 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m14:39:17.825994 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6779B43A0>]}
[0m14:39:17.827225 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.35s]
[0m14:39:17.832209 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:39:17.833470 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:39:17.834431 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m14:39:17.837072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m14:39:17.838245 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m14:39:17.845456 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:39:17.849954 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 14:39:17.839184 => 14:39:17.848854
[0m14:39:17.851402 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m14:39:17.860402 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:39:17.864757 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:39:17.865924 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m14:39:17.866820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:18.080389 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:18.080997 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:39:18.081678 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m14:39:18.110643 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:18.119836 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:39:18.120837 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m14:39:18.144930 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:18.147924 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:39:18.148922 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:39:18.149926 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:39:18.179505 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:18.186285 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m14:39:18.188277 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:39:18.189277 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m14:39:18.213167 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:18.215161 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 14:39:17.852229 => 14:39:18.215161
[0m14:39:18.216160 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m14:39:18.217161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677A2ED90>]}
[0m14:39:18.219181 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.38s]
[0m14:39:18.221159 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:39:18.223159 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:39:18.225165 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m14:39:18.228176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m14:39:18.229169 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:39:18.234163 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:39:18.237117 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 14:39:18.230163 => 14:39:18.236319
[0m14:39:18.239219 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:39:18.248196 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:39:18.252195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:39:18.253195 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m14:39:18.254670 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:18.464637 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:18.466102 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:39:18.467274 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m14:39:18.496599 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:18.501594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:39:18.502594 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m14:39:18.552767 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:18.557818 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:39:18.558817 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:39:18.559764 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:39:18.590769 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:18.597970 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m14:39:18.599996 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:39:18.600976 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m14:39:18.625169 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:18.627155 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 14:39:18.239219 => 14:39:18.627155
[0m14:39:18.628172 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m14:39:18.629180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6779B43A0>]}
[0m14:39:18.631170 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.40s]
[0m14:39:18.633095 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:39:18.634087 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:39:18.635091 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m14:39:18.637097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m14:39:18.637097 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m14:39:18.647310 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:39:18.652616 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 14:39:18.638661 => 14:39:18.651377
[0m14:39:18.653935 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m14:39:18.663836 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:39:18.666835 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:39:18.666835 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m14:39:18.668771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:18.857588 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:18.858570 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:39:18.859638 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m14:39:18.886625 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:18.893626 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:39:18.895626 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m14:39:18.919698 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:18.922695 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:39:18.923665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:39:18.923665 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:39:18.953641 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:18.959799 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m14:39:18.962441 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:39:18.963433 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m14:39:18.987072 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:18.990223 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 14:39:18.655116 => 14:39:18.989181
[0m14:39:18.991206 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m14:39:18.992673 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677A62B20>]}
[0m14:39:18.993722 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.36s]
[0m14:39:18.996258 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:39:18.996258 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:39:18.997381 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m14:39:18.998926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m14:39:19.000034 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:39:19.004054 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:39:19.008249 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 14:39:19.000034 => 14:39:19.006945
[0m14:39:19.009061 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:39:19.020049 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:39:19.024049 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:39:19.026046 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m14:39:19.027048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:19.241962 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:19.242956 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:39:19.243954 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m14:39:19.273455 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:19.278291 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:39:19.278869 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m14:39:19.302884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:19.308107 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:39:19.309097 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:39:19.309097 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:39:19.339486 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:19.345484 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m14:39:19.347486 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:39:19.348484 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m14:39:19.371485 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:19.376481 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 14:39:19.009061 => 14:39:19.375480
[0m14:39:19.377482 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m14:39:19.379481 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677A62B20>]}
[0m14:39:19.380481 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.38s]
[0m14:39:19.382481 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:39:19.383483 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:39:19.385482 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m14:39:19.387482 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m14:39:19.389126 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m14:39:19.398179 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:39:19.402205 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 14:39:19.390116 => 14:39:19.401047
[0m14:39:19.403197 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m14:39:19.414697 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:39:19.417696 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:39:19.419698 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m14:39:19.421198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:19.627459 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:19.628477 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:39:19.629477 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m14:39:19.657804 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:19.662788 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:39:19.663790 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m14:39:19.687712 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:19.691716 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:39:19.692816 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:39:19.692816 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:39:19.721717 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:19.727710 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m14:39:19.728725 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:39:19.729784 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m14:39:19.753372 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:19.757439 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 14:39:19.403696 => 14:39:19.756431
[0m14:39:19.758447 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m14:39:19.760454 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677A2ED90>]}
[0m14:39:19.761446 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.37s]
[0m14:39:19.764450 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:39:19.765474 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:39:19.766450 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m14:39:19.769448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m14:39:19.771447 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:39:19.777537 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:39:19.781217 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 14:39:19.771447 => 14:39:19.780119
[0m14:39:19.782513 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:39:19.796581 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:39:19.801581 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:39:19.803581 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m14:39:19.805769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:19.998875 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:20.000864 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:39:20.001867 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m14:39:20.030363 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:20.038406 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:39:20.040440 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m14:39:20.063538 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:20.065832 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:39:20.066935 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:39:20.066935 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:39:20.095262 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:20.100243 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m14:39:20.102187 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:39:20.102187 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m14:39:20.126162 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:20.129227 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 14:39:19.782513 => 14:39:20.128237
[0m14:39:20.130243 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m14:39:20.133235 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677A7ABE0>]}
[0m14:39:20.134226 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.36s]
[0m14:39:20.137559 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:39:20.138619 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:39:20.139680 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m14:39:20.140674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m14:39:20.141673 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m14:39:20.145688 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:39:20.148709 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 14:39:20.142675 => 14:39:20.147678
[0m14:39:20.149608 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m14:39:20.158405 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:39:20.161965 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:39:20.162551 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m14:39:20.164083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:20.358740 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:20.360740 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:39:20.361740 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m14:39:20.391360 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:20.396052 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:39:20.396052 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m14:39:20.419965 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:20.424964 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:39:20.424964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:39:20.425967 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:39:20.454971 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:20.458050 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m14:39:20.459043 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:39:20.459043 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m14:39:20.482416 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:20.485411 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 14:39:20.149898 => 14:39:20.484412
[0m14:39:20.486378 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m14:39:20.488340 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677A74D30>]}
[0m14:39:20.490529 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.35s]
[0m14:39:20.492540 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:39:20.494515 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:39:20.494515 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m14:39:20.497510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m14:39:20.498463 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:39:20.504292 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:39:20.510124 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 14:39:20.499503 => 14:39:20.508977
[0m14:39:20.511144 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:39:20.519551 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:39:20.523031 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:39:20.524080 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m14:39:20.524080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:20.747513 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:20.749454 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:39:20.749454 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m14:39:20.778445 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:20.785459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:39:20.787446 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m14:39:20.810738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:20.812740 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:39:20.813748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:39:20.814730 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:39:20.842030 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:20.849017 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m14:39:20.850016 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:39:20.851050 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m14:39:20.872668 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:20.875580 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 14:39:20.511144 => 14:39:20.875580
[0m14:39:20.876586 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m14:39:20.877519 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677AEFF70>]}
[0m14:39:20.878511 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.38s]
[0m14:39:20.881054 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:39:20.881054 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:39:20.883073 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m14:39:20.884742 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m14:39:20.888020 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:39:20.893017 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:39:20.896750 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 14:39:20.888020 => 14:39:20.895735
[0m14:39:20.897272 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:39:20.907611 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:39:20.911940 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:39:20.914033 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m14:39:20.914533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:21.138304 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:21.139523 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:39:21.140601 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:39:21.175233 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:21.180730 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:39:21.180730 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m14:39:21.204560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:21.207559 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:39:21.208559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:39:21.209559 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:39:21.245160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:21.249160 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m14:39:21.250160 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:39:21.251161 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m14:39:21.274367 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:21.278755 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 14:39:20.898615 => 14:39:21.277756
[0m14:39:21.278755 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m14:39:21.280757 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6779F0790>]}
[0m14:39:21.282784 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.40s]
[0m14:39:21.284756 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:39:21.285760 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:39:21.287561 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m14:39:21.290128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m14:39:21.291277 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:39:21.298907 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:39:21.302808 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 14:39:21.291277 => 14:39:21.301856
[0m14:39:21.303312 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:39:21.312064 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:39:21.316964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:39:21.318174 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m14:39:21.318174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:21.536170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:21.537735 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:39:21.539735 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:39:21.588703 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:21.595725 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:39:21.596727 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m14:39:21.623914 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:21.628830 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:39:21.630807 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:39:21.631950 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:39:21.661376 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:21.668530 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m14:39:21.671532 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:39:21.672531 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m14:39:21.696207 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:21.699207 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 14:39:21.304366 => 14:39:21.698704
[0m14:39:21.699704 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m14:39:21.701209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677B5F7C0>]}
[0m14:39:21.702205 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.41s]
[0m14:39:21.704204 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:39:21.705705 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:39:21.707202 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m14:39:21.708702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m14:39:21.709701 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:39:21.718379 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:39:21.722880 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 14:39:21.710204 => 14:39:21.722048
[0m14:39:21.724376 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:39:21.733376 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:39:21.738958 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:39:21.740573 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m14:39:21.741369 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:21.934120 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:21.935117 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:39:21.937109 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:39:21.970651 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:21.980011 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:39:21.980998 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m14:39:22.007570 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:22.011643 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:39:22.013662 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:39:22.015567 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:39:22.042654 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:22.048701 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m14:39:22.050463 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:39:22.051360 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m14:39:22.075504 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:22.079774 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 14:39:21.724876 => 14:39:22.078773
[0m14:39:22.080806 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m14:39:22.082774 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677B5F790>]}
[0m14:39:22.083774 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.37s]
[0m14:39:22.085771 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:39:22.086772 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:39:22.087777 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m14:39:22.090776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m14:39:22.090776 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:39:22.096780 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:39:22.100803 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 14:39:22.091783 => 14:39:22.099791
[0m14:39:22.101787 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:39:22.108983 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:39:22.113968 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:39:22.115027 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m14:39:22.115966 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:22.305568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:22.306562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:39:22.307558 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:39:22.340955 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:22.347078 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:39:22.348072 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m14:39:22.371548 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:22.375652 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:39:22.376653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:39:22.377643 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:39:22.407440 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:22.410666 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m14:39:22.411656 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:39:22.412685 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m14:39:22.435410 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:22.440551 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 14:39:22.101787 => 14:39:22.440285
[0m14:39:22.441942 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m14:39:22.443942 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677AFC070>]}
[0m14:39:22.444942 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.35s]
[0m14:39:22.446713 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:39:22.448253 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:39:22.449252 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m14:39:22.452518 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m14:39:22.453020 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:39:22.462585 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:39:22.467771 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 14:39:22.454568 => 14:39:22.466150
[0m14:39:22.468265 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:39:22.479557 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:39:22.484010 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:39:22.485007 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m14:39:22.486009 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:39:22.687197 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:39:22.689187 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:39:22.690195 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:39:22.726172 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:39:22.733848 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:39:22.734886 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m14:39:22.759176 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:39:22.761176 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:39:22.762176 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:39:22.762176 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:39:22.793176 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:39:22.802799 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m14:39:22.805799 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:39:22.806801 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m14:39:22.831011 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:39:22.834011 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 14:39:22.469302 => 14:39:22.833014
[0m14:39:22.835010 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m14:39:22.836336 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92a35ba5-4b6e-4c44-82f4-dcc0f4fe66ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F677B649A0>]}
[0m14:39:22.838422 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.39s]
[0m14:39:22.840376 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:39:22.842358 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:22.843358 [debug] [MainThread]: On master: BEGIN
[0m14:39:22.843358 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:23.040135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:39:23.042121 [debug] [MainThread]: On master: COMMIT
[0m14:39:23.042619 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:23.043893 [debug] [MainThread]: On master: COMMIT
[0m14:39:23.065873 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:39:23.067173 [debug] [MainThread]: On master: Close
[0m14:39:23.069418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:23.070758 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m14:39:23.071766 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m14:39:23.071766 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m14:39:23.072793 [info ] [MainThread]: 
[0m14:39:23.074828 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m14:39:23.079819 [debug] [MainThread]: Command end result
[0m14:39:23.112460 [info ] [MainThread]: 
[0m14:39:23.114462 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:23.115496 [info ] [MainThread]: 
[0m14:39:23.117843 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m14:39:23.119962 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:23.119962 after 8.57 seconds
[0m14:39:23.119962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F674ADE9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6775E2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F6776CF670>]}
[0m14:39:23.120992 [debug] [MainThread]: Flushing usage events
[0m14:40:07.470764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FD5619D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FFDBA580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FFDBAC10>]}


============================== 14:40:07.479883 | 421b3abc-7320-4a89-a732-005125630706 ==============================
[0m14:40:07.479883 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:40:07.480908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --target-path docs/', 'log_format': 'default', 'introspect': 'True', 'target_path': 'docs/', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:07.709233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '421b3abc-7320-4a89-a732-005125630706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FDE535B0>]}
[0m14:40:07.787773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '421b3abc-7320-4a89-a732-005125630706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020080175B80>]}
[0m14:40:07.789702 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:40:07.797762 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:40:07.822692 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:40:07.823656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '421b3abc-7320-4a89-a732-005125630706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020080027FD0>]}
[0m14:40:08.660383 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perptreated_data.sql
[0m14:40:08.675018 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m14:40:08.678019 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_current_and_history.sql
[0m14:40:08.681018 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m_history.sql
[0m14:40:08.684081 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h.sql
[0m14:40:08.687019 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_current_and_history.sql
[0m14:40:08.691321 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1h_history.sql
[0m14:40:08.695320 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w.sql
[0m14:40:08.700320 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_current_and_history.sql
[0m14:40:08.704896 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_1w_history.sql
[0m14:40:08.724100 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h.sql
[0m14:40:08.728102 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_current_and_history.sql
[0m14:40:08.732099 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_4h_history.sql
[0m14:40:08.737100 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m.sql
[0m14:40:08.741231 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_current_and_history.sql
[0m14:40:08.744743 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_5m_history.sql
[0m14:40:08.748739 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\raw_data_btc_perp.sql
[0m14:40:08.818991 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'btc_perp_data_1d' in the 'models' section of file 'models\trading_perp_btc_data\schema.yml'
[0m14:40:08.938062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '421b3abc-7320-4a89-a732-005125630706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020080273F70>]}
[0m14:40:08.944148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '421b3abc-7320-4a89-a732-005125630706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200802F1820>]}
[0m14:40:08.945148 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:40:08.946155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421b3abc-7320-4a89-a732-005125630706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020080136790>]}
[0m14:40:08.948156 [info ] [MainThread]: 
[0m14:40:08.949148 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:08.951443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m14:40:08.960447 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:40:08.960447 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m14:40:08.960447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:09.237298 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:40:09.238298 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:40:09.239561 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m14:40:09.267379 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:40:09.268314 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m14:40:09.290375 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m14:40:09.306386 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:09.306386 [debug] [MainThread]: On master: BEGIN
[0m14:40:09.306386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:09.507626 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:40:09.508664 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:09.508664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:40:09.552100 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m14:40:09.560100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '421b3abc-7320-4a89-a732-005125630706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008040B2E0>]}
[0m14:40:09.560100 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:09.583102 [debug] [MainThread]: On master: Close
[0m14:40:09.585104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:09.585690 [info ] [MainThread]: 
[0m14:40:09.598465 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m14:40:09.600964 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m14:40:09.601464 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m14:40:09.618433 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:40:09.624648 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 14:40:09.602488 => 14:40:09.623651
[0m14:40:09.625646 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m14:40:09.626689 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 14:40:09.625646 => 14:40:09.625646
[0m14:40:09.629752 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m14:40:09.630637 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:40:09.632695 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m14:40:09.633793 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m14:40:09.641052 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:40:09.645580 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 14:40:09.634823 => 14:40:09.644585
[0m14:40:09.646583 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m14:40:09.647583 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 14:40:09.646583 => 14:40:09.646583
[0m14:40:09.648579 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:40:09.649581 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:40:09.650578 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m14:40:09.651579 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m14:40:09.657395 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:40:09.662402 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 14:40:09.651579 => 14:40:09.661396
[0m14:40:09.662402 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m14:40:09.663396 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 14:40:09.663396 => 14:40:09.663396
[0m14:40:09.664395 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:40:09.665400 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:40:09.666396 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m14:40:09.667401 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:40:09.672406 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:40:09.675396 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 14:40:09.667401 => 14:40:09.675396
[0m14:40:09.676397 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:40:09.677400 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 14:40:09.676397 => 14:40:09.676397
[0m14:40:09.678401 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:40:09.679403 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:40:09.680398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m14:40:09.681399 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m14:40:09.685400 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:40:09.688402 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 14:40:09.681399 => 14:40:09.687400
[0m14:40:09.690408 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m14:40:09.691582 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 14:40:09.690408 => 14:40:09.690408
[0m14:40:09.696619 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:40:09.697618 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:40:09.698226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m14:40:09.699139 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:40:09.705195 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:40:09.708253 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 14:40:09.700142 => 14:40:09.707253
[0m14:40:09.709252 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:40:09.711253 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 14:40:09.710257 => 14:40:09.710257
[0m14:40:09.713256 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:40:09.715258 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:40:09.716256 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m14:40:09.717256 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m14:40:09.723253 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:40:09.726253 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 14:40:09.718262 => 14:40:09.725254
[0m14:40:09.727253 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m14:40:09.728259 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 14:40:09.728259 => 14:40:09.728259
[0m14:40:09.730256 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:40:09.731254 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:40:09.733252 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m14:40:09.733252 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:40:09.738259 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:40:09.741303 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 14:40:09.734251 => 14:40:09.741303
[0m14:40:09.742325 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:40:09.743331 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 14:40:09.742325 => 14:40:09.742325
[0m14:40:09.744326 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:40:09.745325 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:40:09.747330 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m14:40:09.748338 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m14:40:09.754524 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:40:09.757564 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 14:40:09.749324 => 14:40:09.756565
[0m14:40:09.758563 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m14:40:09.758563 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 14:40:09.758563 => 14:40:09.758563
[0m14:40:09.760564 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:40:09.761563 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:40:09.762563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m14:40:09.762563 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:40:09.767563 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:40:09.769562 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 14:40:09.763566 => 14:40:09.769562
[0m14:40:09.770566 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:40:09.771562 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 14:40:09.771562 => 14:40:09.771562
[0m14:40:09.773567 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:40:09.773567 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:40:09.775563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m14:40:09.776563 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m14:40:09.779563 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:40:09.781570 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 14:40:09.776563 => 14:40:09.781570
[0m14:40:09.782563 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m14:40:09.783563 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 14:40:09.783563 => 14:40:09.783563
[0m14:40:09.785744 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:40:09.787177 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:40:09.788209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m14:40:09.789209 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:40:09.796217 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:40:09.799207 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 14:40:09.790207 => 14:40:09.798208
[0m14:40:09.799207 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:40:09.800210 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 14:40:09.800210 => 14:40:09.800210
[0m14:40:09.801217 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:40:09.802215 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:40:09.803207 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m14:40:09.804209 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:40:09.809208 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:40:09.812213 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 14:40:09.805213 => 14:40:09.812213
[0m14:40:09.813209 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:40:09.813209 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 14:40:09.813209 => 14:40:09.813209
[0m14:40:09.814209 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:40:09.815210 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:40:09.816210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m14:40:09.817264 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:40:09.822537 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:40:09.825533 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 14:40:09.817522 => 14:40:09.825533
[0m14:40:09.826897 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:40:09.827904 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 14:40:09.827406 => 14:40:09.827406
[0m14:40:09.828918 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:40:09.829918 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:40:09.830917 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m14:40:09.831919 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:40:09.835918 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:40:09.838919 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 14:40:09.831919 => 14:40:09.837919
[0m14:40:09.839919 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:40:09.840933 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 14:40:09.839919 => 14:40:09.839919
[0m14:40:09.841922 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:40:09.841922 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:40:09.842923 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m14:40:09.843917 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:40:09.847922 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:40:09.849918 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 14:40:09.843917 => 14:40:09.849918
[0m14:40:09.850919 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:40:09.851925 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 14:40:09.851925 => 14:40:09.851925
[0m14:40:09.853919 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:40:09.854921 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:40:09.855918 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m14:40:09.856923 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:40:09.860916 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:40:09.862922 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 14:40:09.856923 => 14:40:09.861918
[0m14:40:09.862922 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:40:09.863918 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 14:40:09.863918 => 14:40:09.863918
[0m14:40:09.864917 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:40:09.866918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:09.867918 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m14:40:09.867918 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m14:40:09.871916 [debug] [MainThread]: Command end result
[0m14:40:09.903697 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:40:09.904696 [info ] [MainThread]: Building catalog
[0m14:40:09.912696 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m14:40:09.923696 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m14:40:09.923696 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m14:40:09.924697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:10.129219 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:40:10.130219 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m14:40:10.131219 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perptreated_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:40:10.209325 [debug] [ThreadPool]: SQL status: SELECT 570 in 0.0 seconds
[0m14:40:10.247477 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m14:40:10.271320 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m14:40:10.422032 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\dbt-wizetrading-demo\docs\catalog.json
[0m14:40:10.426198 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:40:10.425698 after 2.99 seconds
[0m14:40:10.427200 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:40:10.427697 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m14:40:10.428699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200FD5619D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020080279610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002008015B760>]}
[0m14:40:10.429699 [debug] [MainThread]: Flushing usage events
[0m14:41:39.196435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D44CCEA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D475794C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47579550>]}


============================== 14:41:39.206390 | 841c1bf1-9ced-465f-a53b-8c4c5cb556bf ==============================
[0m14:41:39.206390 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:41:39.207375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:41:39.474910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D455D8EE0>]}
[0m14:41:39.562483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D478E5BB0>]}
[0m14:41:39.564484 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:41:39.574080 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:41:39.702727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:39.704732 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m14:41:39.827151 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m14:41:39.971087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D479EC430>]}
[0m14:41:40.005239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47A03E80>]}
[0m14:41:40.005239 [info ] [MainThread]: Found 17 models, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:41:40.007232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47894250>]}
[0m14:41:40.010231 [info ] [MainThread]: 
[0m14:41:40.011251 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:40.015233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m14:41:40.029371 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m14:41:40.030362 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m14:41:40.030362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:40.299537 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.0 seconds
[0m14:41:40.303490 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m14:41:40.311493 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m14:41:40.324491 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:41:40.325491 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m14:41:40.325491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:40.536008 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:41:40.537662 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:41:40.539261 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m14:41:40.566807 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:41:40.570807 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m14:41:40.594813 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m14:41:40.610874 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:40.611882 [debug] [MainThread]: On master: BEGIN
[0m14:41:40.612916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:40.799512 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:41:40.800554 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:40.802559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:40.841445 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m14:41:40.854629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47A03EB0>]}
[0m14:41:40.856657 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:40.879457 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:40.880449 [debug] [MainThread]: On master: BEGIN
[0m14:41:40.928156 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:41:40.928351 [debug] [MainThread]: On master: COMMIT
[0m14:41:40.929372 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:40.931240 [debug] [MainThread]: On master: COMMIT
[0m14:41:40.953802 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:41:40.954800 [debug] [MainThread]: On master: Close
[0m14:41:40.956823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:40.957857 [info ] [MainThread]: 
[0m14:41:40.971859 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m14:41:40.973863 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m14:41:40.975861 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m14:41:40.976858 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m14:41:40.992971 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:40.997302 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 14:41:40.977859 => 14:41:40.996302
[0m14:41:40.998302 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m14:41:41.070664 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:41.073665 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:41.074164 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m14:41:41.075164 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:41:41.262873 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:41.263880 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:41.264878 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m14:41:41.292796 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:41.307041 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:41.308043 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m14:41:41.332858 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:41.342560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:41.343561 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m14:41:41.366555 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:41.402148 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:41:41.403148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:41.404149 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:41:41.435156 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:41.455155 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m14:41:41.471745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:41:41.472744 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m14:41:41.519333 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:41.522142 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 14:41:40.998973 => 14:41:41.522142
[0m14:41:41.523292 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m14:41:41.524313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47D35940>]}
[0m14:41:41.525330 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.55s]
[0m14:41:41.527617 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m14:41:41.528818 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:41:41.529321 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m14:41:41.533005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m14:41:41.534662 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m14:41:41.544358 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.550189 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 14:41:41.534662 => 14:41:41.549570
[0m14:41:41.551933 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m14:41:41.567302 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.572806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.574630 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m14:41:41.576289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:41.762222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:41.763446 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.764447 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m14:41:41.792017 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:41.800992 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.802014 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m14:41:41.826106 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:41.833026 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.834026 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m14:41:41.857025 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:41.860031 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:41:41.861030 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.862033 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:41:41.890375 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:41.895379 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m14:41:41.897377 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:41:41.898458 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m14:41:41.925472 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:41.929474 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 14:41:41.553432 => 14:41:41.928477
[0m14:41:41.930494 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m14:41:41.932474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47CC43A0>]}
[0m14:41:41.934376 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.40s]
[0m14:41:41.937364 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:41:41.938365 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:41:41.940366 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m14:41:41.942920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m14:41:41.943919 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m14:41:41.952065 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:41:41.956547 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 14:41:41.945415 => 14:41:41.955547
[0m14:41:41.958361 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m14:41:41.971502 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:41:41.976288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:41:41.977465 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m14:41:41.978532 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:42.162029 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:42.164955 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:41:42.165962 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m14:41:42.194952 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:42.204950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:41:42.206951 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m14:41:42.235911 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:42.242462 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:41:42.243911 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:41:42.244911 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:41:42.277490 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:42.281491 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m14:41:42.283515 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:41:42.284493 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m14:41:42.307910 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:42.310914 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 14:41:41.959522 => 14:41:42.310914
[0m14:41:42.311911 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m14:41:42.312932 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47D41730>]}
[0m14:41:42.313911 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.37s]
[0m14:41:42.315908 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:41:42.316912 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:41:42.318704 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m14:41:42.320723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m14:41:42.321723 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:41:42.327723 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:41:42.332277 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 14:41:42.322718 => 14:41:42.331263
[0m14:41:42.334385 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:41:42.343974 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:41:42.347675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:41:42.348293 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m14:41:42.349270 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:42.540171 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:42.541171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:41:42.541171 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m14:41:42.570173 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:42.576172 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:41:42.577174 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m14:41:42.600175 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:42.603174 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:41:42.604182 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:41:42.605174 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:41:42.637329 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:42.642336 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m14:41:42.644330 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:41:42.645329 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m14:41:42.669209 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:42.672379 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 14:41:42.335424 => 14:41:42.672379
[0m14:41:42.673371 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m14:41:42.675291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47D35400>]}
[0m14:41:42.676399 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.36s]
[0m14:41:42.678326 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:41:42.680325 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:41:42.681326 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m14:41:42.683327 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m14:41:42.684328 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m14:41:42.689327 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:41:42.692599 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 14:41:42.684328 => 14:41:42.691326
[0m14:41:42.693939 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m14:41:42.709239 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:41:42.712939 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:41:42.714299 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m14:41:42.714768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:42.905792 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:42.905792 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:41:42.905792 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m14:41:42.938910 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:42.944287 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:41:42.945288 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m14:41:42.968547 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:42.971684 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:41:42.972681 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:41:42.972681 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:41:43.000223 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:43.006476 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m14:41:43.009477 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:41:43.009979 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m14:41:43.033275 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:43.035278 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 14:41:42.694941 => 14:41:43.034278
[0m14:41:43.035278 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m14:41:43.037295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D4777E550>]}
[0m14:41:43.038278 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.35s]
[0m14:41:43.040275 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:41:43.042278 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:41:43.043378 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m14:41:43.045962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m14:41:43.047463 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:41:43.056069 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:41:43.061179 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 14:41:43.047463 => 14:41:43.060678
[0m14:41:43.063199 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:41:43.078963 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:41:43.083090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:41:43.085313 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m14:41:43.086515 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:43.275470 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:43.277546 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:41:43.278049 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m14:41:43.308764 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:43.317036 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:41:43.318720 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m14:41:43.342620 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:43.347327 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:41:43.348820 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:41:43.350321 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:41:43.381051 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:43.389050 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m14:41:43.391051 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:41:43.392050 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m14:41:43.416052 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:43.419555 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 14:41:43.064197 => 14:41:43.419053
[0m14:41:43.420552 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m14:41:43.422551 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47CD4E20>]}
[0m14:41:43.424053 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.38s]
[0m14:41:43.426550 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:41:43.428052 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:41:43.429551 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m14:41:43.432083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m14:41:43.434373 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m14:41:43.442266 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:41:43.446768 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 14:41:43.434926 => 14:41:43.445766
[0m14:41:43.448266 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m14:41:43.458267 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:41:43.461266 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:41:43.462266 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m14:41:43.463266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:43.656723 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:43.658725 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:41:43.659723 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m14:41:43.687151 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:43.693675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:41:43.693675 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m14:41:43.716115 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:43.719119 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:41:43.720206 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:41:43.722338 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:41:43.767015 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:43.774015 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m14:41:43.775923 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:41:43.777047 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m14:41:43.800368 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:43.804357 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 14:41:43.449268 => 14:41:43.803359
[0m14:41:43.805360 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m14:41:43.806356 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47CDD550>]}
[0m14:41:43.808356 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.38s]
[0m14:41:43.810356 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:41:43.811365 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:41:43.813871 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m14:41:43.817393 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m14:41:43.818396 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:41:43.831234 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:41:43.836282 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 14:41:43.819392 => 14:41:43.835058
[0m14:41:43.837855 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:41:43.852144 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:41:43.856342 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:41:43.857924 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m14:41:43.859243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:44.051408 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:44.052156 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:41:44.053166 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m14:41:44.082065 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:44.090065 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:41:44.092065 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m14:41:44.115064 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:44.119067 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:41:44.120070 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:41:44.121067 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:41:44.154947 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:44.160949 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m14:41:44.163950 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:41:44.165955 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m14:41:44.188945 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:44.191949 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 14:41:43.839365 => 14:41:44.190946
[0m14:41:44.192966 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m14:41:44.194947 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E42910>]}
[0m14:41:44.195949 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.38s]
[0m14:41:44.198949 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:41:44.200948 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:41:44.201947 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m14:41:44.204950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m14:41:44.205949 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m14:41:44.210951 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:41:44.216303 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 14:41:44.205949 => 14:41:44.214945
[0m14:41:44.217383 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m14:41:44.230960 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:41:44.234806 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:41:44.235809 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m14:41:44.236695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:44.430128 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:44.432195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:41:44.433193 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m14:41:44.462185 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:44.467183 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:41:44.468183 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m14:41:44.490845 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:44.493848 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:41:44.494848 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:41:44.494848 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:41:44.523116 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:44.534568 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m14:41:44.537194 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:41:44.538695 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m14:41:44.562496 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:44.566887 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 14:41:44.218382 => 14:41:44.566887
[0m14:41:44.567883 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m14:41:44.569885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47DEF100>]}
[0m14:41:44.570881 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.37s]
[0m14:41:44.573186 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:41:44.574186 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:41:44.575687 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m14:41:44.578009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m14:41:44.579069 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:41:44.586676 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:41:44.592161 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 14:41:44.580106 => 14:41:44.591104
[0m14:41:44.593167 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:41:44.603878 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:41:44.608478 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:41:44.609855 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m14:41:44.610358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:44.806858 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:44.807857 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:41:44.809415 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m14:41:44.838347 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:44.843862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:41:44.844863 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m14:41:44.868640 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:44.872813 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:41:44.873830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:41:44.874820 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:41:44.906712 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:44.914454 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m14:41:44.917021 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:41:44.918029 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m14:41:44.941771 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:44.944771 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 14:41:44.595197 => 14:41:44.944771
[0m14:41:44.945771 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m14:41:44.947772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47DD69A0>]}
[0m14:41:44.948772 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.37s]
[0m14:41:44.950777 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:41:44.951774 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:41:44.952770 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m14:41:44.954771 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m14:41:44.955772 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m14:41:44.963568 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:41:44.966864 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 14:41:44.957547 => 14:41:44.966768
[0m14:41:44.967367 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m14:41:44.976491 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:41:44.980948 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:41:44.982438 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m14:41:44.984620 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:45.173365 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:45.175989 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:41:45.177015 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m14:41:45.209984 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:45.218594 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:41:45.219618 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m14:41:45.242617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:45.246618 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:41:45.247619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:41:45.247619 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:41:45.276271 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:45.287866 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m14:41:45.291374 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:41:45.293375 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m14:41:45.316956 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:45.319961 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 14:41:44.967367 => 14:41:45.318956
[0m14:41:45.320956 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m14:41:45.323694 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E75E50>]}
[0m14:41:45.325791 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.37s]
[0m14:41:45.328012 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:41:45.329430 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:41:45.331126 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m14:41:45.333293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m14:41:45.334876 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:41:45.344874 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:41:45.350980 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 14:41:45.335874 => 14:41:45.349399
[0m14:41:45.352480 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:41:45.366837 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:41:45.371390 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:41:45.372890 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m14:41:45.374922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:45.563602 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:45.564602 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:41:45.565603 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m14:41:45.593600 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:45.601600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:41:45.602600 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m14:41:45.625761 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:45.630246 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:41:45.632246 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:41:45.633246 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:41:45.663723 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:45.671821 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m14:41:45.674637 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:41:45.675636 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m14:41:45.701829 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:45.706193 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 14:41:45.353723 => 14:41:45.705193
[0m14:41:45.707192 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m14:41:45.709692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E78220>]}
[0m14:41:45.710874 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.38s]
[0m14:41:45.713776 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:41:45.714934 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:41:45.717304 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m14:41:45.719898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m14:41:45.721398 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:41:45.732599 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:41:45.738099 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 14:41:45.722398 => 14:41:45.737102
[0m14:41:45.739810 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:41:45.753206 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:41:45.761192 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:41:45.762356 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m14:41:45.764018 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:45.961361 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:45.961916 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:41:45.962889 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:41:45.998974 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:46.005972 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:41:46.005972 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m14:41:46.030463 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:46.036606 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:41:46.037606 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:41:46.040089 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:41:46.067939 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:46.074710 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m14:41:46.075712 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:41:46.076726 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m14:41:46.099581 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:46.103577 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 14:41:45.740913 => 14:41:46.102581
[0m14:41:46.103577 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m14:41:46.105577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E78250>]}
[0m14:41:46.106577 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.39s]
[0m14:41:46.108576 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:41:46.109577 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:41:46.110576 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m14:41:46.112579 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m14:41:46.113578 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:41:46.124104 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:41:46.129778 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 14:41:46.114577 => 14:41:46.128776
[0m14:41:46.130891 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:41:46.146049 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:41:46.150905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:41:46.151908 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m14:41:46.151908 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:46.335905 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:46.336900 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:41:46.337900 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:41:46.370514 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:46.379447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:41:46.380447 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m14:41:46.404452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:46.409448 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:41:46.411447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:41:46.413445 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:41:46.444451 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:46.452446 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m14:41:46.455446 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:41:46.456456 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m14:41:46.479909 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:46.483907 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 14:41:46.131510 => 14:41:46.482907
[0m14:41:46.484907 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m14:41:46.485909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47EF33A0>]}
[0m14:41:46.487919 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.37s]
[0m14:41:46.490903 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:41:46.491923 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:41:46.493902 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m14:41:46.496689 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m14:41:46.498766 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:41:46.504709 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:41:46.509649 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 14:41:46.498766 => 14:41:46.508651
[0m14:41:46.511135 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:41:46.526933 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:41:46.532164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:41:46.533160 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m14:41:46.533160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:46.720940 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:46.721440 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:41:46.723520 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:41:46.759042 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:46.769042 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:41:46.770045 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m14:41:46.793728 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:46.796871 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:41:46.797824 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:41:46.798821 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:41:46.828088 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:46.835835 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m14:41:46.837836 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:41:46.839766 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m14:41:46.863074 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:46.865596 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 14:41:46.512795 => 14:41:46.865596
[0m14:41:46.867598 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m14:41:46.869595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E2D5E0>]}
[0m14:41:46.870598 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.37s]
[0m14:41:46.873109 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:41:46.874412 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:41:46.875400 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m14:41:46.878410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m14:41:46.880259 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:41:46.889771 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:41:46.895281 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 14:41:46.881552 => 14:41:46.894089
[0m14:41:46.895817 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:41:46.903544 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:41:46.907821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:41:46.909465 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m14:41:46.911066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:47.108095 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:47.110100 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:41:47.112103 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:41:47.145785 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:47.151786 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:41:47.152790 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m14:41:47.175340 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:47.179454 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:41:47.180449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:41:47.180449 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:41:47.212860 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:47.219374 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m14:41:47.222460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:41:47.223958 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m14:41:47.246550 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:47.253786 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 14:41:46.896233 => 14:41:47.251851
[0m14:41:47.255345 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m14:41:47.258219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E96100>]}
[0m14:41:47.260217 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.38s]
[0m14:41:47.262655 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:41:47.263345 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:41:47.263853 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m14:41:47.265903 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m14:41:47.267021 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:41:47.276151 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:41:47.283537 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 14:41:47.267520 => 14:41:47.281381
[0m14:41:47.285116 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:41:47.298808 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:41:47.303813 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:41:47.304809 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m14:41:47.305810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:47.508244 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:41:47.509244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:41:47.510244 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:41:47.543255 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:41:47.548259 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:41:47.548259 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m14:41:47.572259 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:41:47.576256 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:41:47.577258 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:41:47.578258 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:41:47.605265 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:41:47.616103 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m14:41:47.619583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:41:47.622052 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m14:41:47.649144 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:41:47.652959 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 14:41:47.285921 => 14:41:47.652959
[0m14:41:47.654592 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m14:41:47.657014 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '841c1bf1-9ced-465f-a53b-8c4c5cb556bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E2D5E0>]}
[0m14:41:47.658795 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.39s]
[0m14:41:47.661853 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:41:47.664063 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.666083 [debug] [MainThread]: On master: BEGIN
[0m14:41:47.667089 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:47.858215 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:41:47.859421 [debug] [MainThread]: On master: COMMIT
[0m14:41:47.860422 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:47.861418 [debug] [MainThread]: On master: COMMIT
[0m14:41:47.884313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:41:47.885314 [debug] [MainThread]: On master: Close
[0m14:41:47.887312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:47.888311 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m14:41:47.888311 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m14:41:47.889895 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m14:41:47.890927 [info ] [MainThread]: 
[0m14:41:47.892959 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m14:41:47.903670 [debug] [MainThread]: Command end result
[0m14:41:47.937560 [info ] [MainThread]: 
[0m14:41:47.939550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:47.941581 [info ] [MainThread]: 
[0m14:41:47.942820 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m14:41:47.945896 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:47.944822 after 8.80 seconds
[0m14:41:47.946834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D44CCEA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47AE9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D47E34C70>]}
[0m14:41:47.946834 [debug] [MainThread]: Flushing usage events
[0m14:43:16.903661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9FA719D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA23094F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2309520>]}


============================== 14:43:16.917051 | c45a5b69-a08c-46e2-8366-2b7e04fa098a ==============================
[0m14:43:16.917051 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:43:16.918553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:17.206623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA0361BE0>]}
[0m14:43:17.317049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA259D580>]}
[0m14:43:17.319045 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:43:17.328051 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:43:17.462974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:43:17.464975 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m14:43:17.590589 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m14:43:17.788825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2BB2460>]}
[0m14:43:17.821506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2793D60>]}
[0m14:43:17.821506 [info ] [MainThread]: Found 17 models, 1 test, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:43:17.823506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2865F70>]}
[0m14:43:17.825513 [info ] [MainThread]: 
[0m14:43:17.826508 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:43:17.830517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel'
[0m14:43:17.841801 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel"
[0m14:43:17.842803 [debug] [ThreadPool]: On list_aoavfbel: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel"} */

    select distinct nspname from pg_namespace
  
[0m14:43:17.842803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:18.065482 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.0 seconds
[0m14:43:18.068479 [debug] [ThreadPool]: On list_aoavfbel: Close
[0m14:43:18.074480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m14:43:18.084568 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:43:18.085585 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m14:43:18.087300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:18.289561 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:43:18.290580 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:43:18.291596 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m14:43:18.319008 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:43:18.322007 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m14:43:18.346085 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m14:43:18.364855 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:18.364855 [debug] [MainThread]: On master: BEGIN
[0m14:43:18.365854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:43:18.556419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:18.557419 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:18.558418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:43:18.593938 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m14:43:18.603700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2BB2460>]}
[0m14:43:18.604726 [debug] [MainThread]: On master: ROLLBACK
[0m14:43:18.626848 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:18.627848 [debug] [MainThread]: On master: BEGIN
[0m14:43:18.672022 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:18.673018 [debug] [MainThread]: On master: COMMIT
[0m14:43:18.674019 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:18.675020 [debug] [MainThread]: On master: COMMIT
[0m14:43:18.707014 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:43:18.708013 [debug] [MainThread]: On master: Close
[0m14:43:18.709013 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:18.711014 [info ] [MainThread]: 
[0m14:43:18.725014 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m14:43:18.727085 [info ] [Thread-1  ]: 1 of 17 START sql view model wizetrading.btc_perptreated_data .................. [RUN]
[0m14:43:18.729023 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m14:43:18.730015 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m14:43:18.739015 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:18.742524 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 14:43:18.730015 => 14:43:18.741694
[0m14:43:18.743521 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m14:43:18.796999 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:18.800539 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:18.801667 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: BEGIN
[0m14:43:18.802615 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:43:18.995522 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:18.996773 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:18.998917 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */

  create view "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as 
(
   select
       stream      :: varchar as stream
       ,"data_e"   :: varchar as event_type
       ,"data_E"   :: bigint as event_time
       ,"data_s"   :: varchar as symbole_src
       ,"data_k_t" :: bigint as candle_open_time
       ,"data_k_T" :: bigint as candle_close_time
       ,"data_k_s" :: varchar as symbole
       ,"data_k_i" :: varchar as interval
       ,"data_k_f" :: int as first_trade_id
       ,"data_k_L" :: int as last_trade_id
       ,"data_k_o" :: decimal as openprice
       ,"data_k_c" :: decimal as close_price
       ,"data_k_h" :: decimal as high_price
       ,"data_k_l" :: decimal as low_price
       ,"data_k_v" :: int as base_asset_volume
       ,"data_k_n" :: int as  nb_trades
       ,"data_k_x" :: boolean as candle_closed
       ,"data_k_q" :: decimal as quote_asset_volume
       ,"data_k_V" :: decimal as taker_buy_base_asset_volume
       ,"data_k_Q" :: decimal as taker_buy_quote_asset_volume
    from wizetrading.raw_data
)
select * from final
  );
[0m14:43:19.026468 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:19.041540 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:19.043331 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data" rename to "btc_perptreated_data__dbt_backup"
[0m14:43:19.067500 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:19.076257 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:19.077893 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
alter table "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_tmp" rename to "btc_perptreated_data"
[0m14:43:19.100504 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:19.136728 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:43:19.138540 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:19.139025 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: COMMIT
[0m14:43:19.166888 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:19.181882 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup"
[0m14:43:19.188960 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perptreated_data"
[0m14:43:19.189959 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perptreated_data"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perptreated_data__dbt_backup" cascade
[0m14:43:19.246273 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:19.249271 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 14:43:18.743521 => 14:43:19.249271
[0m14:43:19.250271 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perptreated_data: Close
[0m14:43:19.251772 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2D45910>]}
[0m14:43:19.252774 [info ] [Thread-1  ]: 1 of 17 OK created sql view model wizetrading.btc_perptreated_data ............. [[32mCREATE VIEW[0m in 0.52s]
[0m14:43:19.254773 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m14:43:19.255777 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:43:19.257272 [info ] [Thread-1  ]: 2 of 17 START sql view model wizetrading.raw_data_btc_perp ..................... [RUN]
[0m14:43:19.258273 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m14:43:19.259272 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m14:43:19.264774 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.268774 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 14:43:19.259272 => 14:43:19.267806
[0m14:43:19.269776 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m14:43:19.281587 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.285082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.286735 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: BEGIN
[0m14:43:19.288591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:19.482499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:19.483447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.485536 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */

  create view "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp"
    
    
  as (
    with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."raw_data"
),
final as (
    select * from source_btc_data
)

select * from final
  );
[0m14:43:19.513051 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:19.522190 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.523188 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp" rename to "raw_data_btc_perp__dbt_backup"
[0m14:43:19.547077 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:19.553809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.553843 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
alter table "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_tmp" rename to "raw_data_btc_perp"
[0m14:43:19.576918 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:19.578916 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:43:19.579915 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.580926 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: COMMIT
[0m14:43:19.608454 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:19.613479 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup"
[0m14:43:19.615470 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:43:19.616469 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.raw_data_btc_perp"} */
drop view if exists "aoavfbel"."wizetrading"."raw_data_btc_perp__dbt_backup" cascade
[0m14:43:19.645391 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:19.649395 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 14:43:19.270776 => 14:43:19.648394
[0m14:43:19.650394 [debug] [Thread-1  ]: On model.dbt_wizetrading.raw_data_btc_perp: Close
[0m14:43:19.651394 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2BC2550>]}
[0m14:43:19.652393 [info ] [Thread-1  ]: 2 of 17 OK created sql view model wizetrading.raw_data_btc_perp ................ [[32mCREATE VIEW[0m in 0.39s]
[0m14:43:19.654470 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:43:19.654748 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:43:19.655783 [info ] [Thread-1  ]: 3 of 17 START sql view model wizetrading.btc_perp_data_15m ..................... [RUN]
[0m14:43:19.656781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m14:43:19.657781 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m14:43:19.660781 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:43:19.664708 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 14:43:19.657781 => 14:43:19.662782
[0m14:43:19.665811 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m14:43:19.681565 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:43:19.686035 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:43:19.688083 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: BEGIN
[0m14:43:19.689084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:19.891170 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:19.892166 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:43:19.893164 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='15m'
)

select * from final
  );
[0m14:43:19.921116 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:19.927639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:43:19.928636 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_tmp" rename to "btc_perp_data_15m"
[0m14:43:19.951643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:19.956659 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:43:19.957583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:43:19.958659 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: COMMIT
[0m14:43:19.990941 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:19.994893 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup"
[0m14:43:19.996919 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:43:19.997894 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m__dbt_backup" cascade
[0m14:43:20.023348 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:20.028278 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 14:43:19.666812 => 14:43:20.028278
[0m14:43:20.030946 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m: Close
[0m14:43:20.032964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C6AD00>]}
[0m14:43:20.035230 [info ] [Thread-1  ]: 3 of 17 OK created sql view model wizetrading.btc_perp_data_15m ................ [[32mCREATE VIEW[0m in 0.38s]
[0m14:43:20.037324 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:43:20.038233 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:43:20.039734 [info ] [Thread-1  ]: 4 of 17 START sql view model wizetrading.btc_perp_data_15m_history ............. [RUN]
[0m14:43:20.041230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m14:43:20.042229 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:43:20.047228 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:43:20.051236 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 14:43:20.043226 => 14:43:20.050224
[0m14:43:20.051236 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:43:20.061496 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:43:20.064495 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:43:20.065495 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: BEGIN
[0m14:43:20.066496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:20.280199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:20.281214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:43:20.283131 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '15m'::text
)

select * from final
  );
[0m14:43:20.311574 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:20.319659 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:43:20.320659 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_tmp" rename to "btc_perp_data_15m_history"
[0m14:43:20.346415 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:20.350409 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:43:20.351410 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:43:20.352409 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: COMMIT
[0m14:43:20.382465 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:20.390463 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup"
[0m14:43:20.394460 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:43:20.396561 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_history__dbt_backup" cascade
[0m14:43:20.420562 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:20.423561 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 14:43:20.052233 => 14:43:20.423561
[0m14:43:20.424562 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_history: Close
[0m14:43:20.426560 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C6AD00>]}
[0m14:43:20.428188 [info ] [Thread-1  ]: 4 of 17 OK created sql view model wizetrading.btc_perp_data_15m_history ........ [[32mCREATE VIEW[0m in 0.39s]
[0m14:43:20.431189 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:43:20.432195 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:43:20.433188 [info ] [Thread-1  ]: 5 of 17 START sql view model wizetrading.btc_perp_data_1h ...................... [RUN]
[0m14:43:20.435189 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m14:43:20.437190 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m14:43:20.445649 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:43:20.449232 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 14:43:20.437190 => 14:43:20.448588
[0m14:43:20.450287 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m14:43:20.462944 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:43:20.466614 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:43:20.467800 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: BEGIN
[0m14:43:20.469562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:20.682540 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:20.684541 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:43:20.685540 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1h'
)

select * from final
  );
[0m14:43:20.715268 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:20.720269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:43:20.721570 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_tmp" rename to "btc_perp_data_1h"
[0m14:43:20.746598 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:20.752039 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:43:20.754432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:43:20.755442 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: COMMIT
[0m14:43:20.783278 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:20.788286 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup"
[0m14:43:20.789278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:43:20.790282 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h__dbt_backup" cascade
[0m14:43:20.815182 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:20.818334 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 14:43:20.451268 => 14:43:20.817336
[0m14:43:20.818334 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h: Close
[0m14:43:20.820335 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2B669D0>]}
[0m14:43:20.821334 [info ] [Thread-1  ]: 5 of 17 OK created sql view model wizetrading.btc_perp_data_1h ................. [[32mCREATE VIEW[0m in 0.39s]
[0m14:43:20.823335 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:43:20.823335 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:43:20.825364 [info ] [Thread-1  ]: 6 of 17 START sql view model wizetrading.btc_perp_data_1h_history .............. [RUN]
[0m14:43:20.827336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m14:43:20.828340 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:43:20.836027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:43:20.839450 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 14:43:20.829336 => 14:43:20.839450
[0m14:43:20.840484 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:43:20.852213 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:43:20.857260 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:43:20.858569 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: BEGIN
[0m14:43:20.859588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:21.065729 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:21.066747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:43:21.067741 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1h'::text
)

select * from final
  );
[0m14:43:21.095002 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:21.099467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:43:21.100472 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_tmp" rename to "btc_perp_data_1h_history"
[0m14:43:21.123591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:21.130156 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:43:21.132165 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:43:21.133148 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: COMMIT
[0m14:43:21.162148 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:21.173149 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup"
[0m14:43:21.176146 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:43:21.177147 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_history__dbt_backup" cascade
[0m14:43:21.200144 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:21.203144 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 14:43:20.841984 => 14:43:21.203144
[0m14:43:21.204145 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_history: Close
[0m14:43:21.205145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2CAAB80>]}
[0m14:43:21.207143 [info ] [Thread-1  ]: 6 of 17 OK created sql view model wizetrading.btc_perp_data_1h_history ......... [[32mCREATE VIEW[0m in 0.38s]
[0m14:43:21.208146 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:43:21.209144 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:43:21.210144 [info ] [Thread-1  ]: 7 of 17 START sql view model wizetrading.btc_perp_data_1w ...................... [RUN]
[0m14:43:21.211153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m14:43:21.212150 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m14:43:21.216147 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:43:21.219145 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 14:43:21.212150 => 14:43:21.219145
[0m14:43:21.220144 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m14:43:21.228149 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:43:21.231144 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:43:21.232154 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: BEGIN
[0m14:43:21.233149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:21.423010 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:21.424011 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:43:21.425011 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='1w'
)

select * from final
  );
[0m14:43:21.453872 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:21.459886 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:43:21.461398 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_tmp" rename to "btc_perp_data_1w"
[0m14:43:21.485134 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:21.490928 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:43:21.492434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:43:21.493433 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: COMMIT
[0m14:43:21.522736 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:21.528279 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup"
[0m14:43:21.529890 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:43:21.530532 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w__dbt_backup" cascade
[0m14:43:21.552875 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:21.555875 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 14:43:21.221147 => 14:43:21.555375
[0m14:43:21.556374 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w: Close
[0m14:43:21.557375 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C45610>]}
[0m14:43:21.558876 [info ] [Thread-1  ]: 7 of 17 OK created sql view model wizetrading.btc_perp_data_1w ................. [[32mCREATE VIEW[0m in 0.35s]
[0m14:43:21.559874 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:43:21.560875 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:43:21.562025 [info ] [Thread-1  ]: 8 of 17 START sql view model wizetrading.btc_perp_data_1w_history .............. [RUN]
[0m14:43:21.563883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m14:43:21.564374 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:43:21.570882 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:43:21.575376 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 14:43:21.564874 => 14:43:21.574376
[0m14:43:21.576876 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:43:21.590375 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:43:21.594376 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:43:21.595874 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: BEGIN
[0m14:43:21.596877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:21.792989 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:21.793986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:43:21.794988 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '1w'::text
)

select * from final
  );
[0m14:43:21.822385 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:21.828376 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:43:21.829378 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_tmp" rename to "btc_perp_data_1w_history"
[0m14:43:21.854387 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:21.861442 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:43:21.862449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:43:21.864449 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: COMMIT
[0m14:43:21.893113 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:21.899113 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup"
[0m14:43:21.900113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:43:21.901114 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_history__dbt_backup" cascade
[0m14:43:21.923110 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:21.929109 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 14:43:21.577407 => 14:43:21.928109
[0m14:43:21.930108 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_history: Close
[0m14:43:21.932112 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2CCEB20>]}
[0m14:43:21.934109 [info ] [Thread-1  ]: 8 of 17 OK created sql view model wizetrading.btc_perp_data_1w_history ......... [[32mCREATE VIEW[0m in 0.37s]
[0m14:43:21.936109 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:43:21.937109 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:43:21.938109 [info ] [Thread-1  ]: 9 of 17 START sql view model wizetrading.btc_perp_data_4h ...................... [RUN]
[0m14:43:21.939711 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m14:43:21.941531 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m14:43:21.945996 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:43:21.948997 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 14:43:21.942013 => 14:43:21.948997
[0m14:43:21.949997 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m14:43:21.957029 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:43:21.960195 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:43:21.961196 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: BEGIN
[0m14:43:21.962599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:22.148566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:22.149575 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:43:22.150572 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='4h'
)

select * from final
  );
[0m14:43:22.180544 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:22.193454 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:43:22.195453 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_tmp" rename to "btc_perp_data_4h"
[0m14:43:22.219890 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:22.224896 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:43:22.225889 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:43:22.225889 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: COMMIT
[0m14:43:22.253892 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:22.261893 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup"
[0m14:43:22.263891 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:43:22.270100 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h__dbt_backup" cascade
[0m14:43:22.295025 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:22.298027 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 14:43:21.949997 => 14:43:22.297025
[0m14:43:22.299027 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h: Close
[0m14:43:22.301032 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2CBDD30>]}
[0m14:43:22.302611 [info ] [Thread-1  ]: 9 of 17 OK created sql view model wizetrading.btc_perp_data_4h ................. [[32mCREATE VIEW[0m in 0.36s]
[0m14:43:22.305238 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:43:22.306491 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:43:22.306991 [info ] [Thread-1  ]: 10 of 17 START sql view model wizetrading.btc_perp_data_4h_history ............. [RUN]
[0m14:43:22.309021 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m14:43:22.310017 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:43:22.315927 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:43:22.319156 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 14:43:22.310017 => 14:43:22.318155
[0m14:43:22.320156 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:43:22.334106 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:43:22.338101 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:43:22.340109 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: BEGIN
[0m14:43:22.341631 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:22.531907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:22.532908 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:43:22.533901 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '4h'::text
)

select * from final
  );
[0m14:43:22.562580 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:22.569580 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:43:22.569580 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_tmp" rename to "btc_perp_data_4h_history"
[0m14:43:22.593266 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:22.599625 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:43:22.601623 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:43:22.603622 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: COMMIT
[0m14:43:22.632701 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:22.636694 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup"
[0m14:43:22.637695 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:43:22.638695 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_history__dbt_backup" cascade
[0m14:43:22.661763 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:22.664760 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 14:43:22.321156 => 14:43:22.664760
[0m14:43:22.665760 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_history: Close
[0m14:43:22.667765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C417F0>]}
[0m14:43:22.668766 [info ] [Thread-1  ]: 10 of 17 OK created sql view model wizetrading.btc_perp_data_4h_history ........ [[32mCREATE VIEW[0m in 0.36s]
[0m14:43:22.670761 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:43:22.671775 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:43:22.672764 [info ] [Thread-1  ]: 11 of 17 START sql view model wizetrading.btc_perp_data_5m ..................... [RUN]
[0m14:43:22.674761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m14:43:22.675762 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m14:43:22.681761 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:43:22.684762 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 14:43:22.676762 => 14:43:22.683762
[0m14:43:22.685762 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m14:43:22.693218 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:43:22.696214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:43:22.698212 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: BEGIN
[0m14:43:22.699216 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:22.910928 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:22.911901 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:43:22.911901 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
        and interval ='5m'
)

select * from final
  );
[0m14:43:22.949623 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:22.959791 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:43:22.960821 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_tmp" rename to "btc_perp_data_5m"
[0m14:43:22.984821 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:22.987822 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:43:22.989821 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:43:22.990819 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: COMMIT
[0m14:43:23.018912 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:23.023275 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup"
[0m14:43:23.024895 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:43:23.024895 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m__dbt_backup" cascade
[0m14:43:23.054046 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:23.057046 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 14:43:22.685867 => 14:43:23.057046
[0m14:43:23.058061 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m: Close
[0m14:43:23.059051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C417F0>]}
[0m14:43:23.060045 [info ] [Thread-1  ]: 11 of 17 OK created sql view model wizetrading.btc_perp_data_5m ................ [[32mCREATE VIEW[0m in 0.39s]
[0m14:43:23.064050 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:43:23.065048 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:43:23.066050 [info ] [Thread-1  ]: 12 of 17 START sql view model wizetrading.btc_perp_data_5m_history ............. [RUN]
[0m14:43:23.068047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m14:43:23.069046 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:43:23.075968 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:43:23.079634 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 14:43:23.070050 => 14:43:23.078618
[0m14:43:23.081347 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:43:23.095052 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:43:23.100128 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:43:23.101126 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: BEGIN
[0m14:43:23.101126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:23.304568 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:23.306061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:43:23.307412 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp"
    
    
  as (
    -- This is now a dbt model file, not a raw SQL query
with source_btc_data as
(
    select * from "aoavfbel"."wizetrading"."btc_perptreated_data"
),
final as (
    select * from source_btc_data
    where 1=1
         AND source_btc_data.interval::text = '5m'::text
)

select * from final
  );
[0m14:43:23.335355 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:23.344748 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:43:23.345772 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_tmp" rename to "btc_perp_data_5m_history"
[0m14:43:23.370177 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:23.374177 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:43:23.376175 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:43:23.376175 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: COMMIT
[0m14:43:23.416252 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:23.421299 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup"
[0m14:43:23.423620 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:43:23.425643 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_history__dbt_backup" cascade
[0m14:43:23.449649 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:23.453639 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 14:43:23.081845 => 14:43:23.452639
[0m14:43:23.454639 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_history: Close
[0m14:43:23.456637 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2CA4EB0>]}
[0m14:43:23.457637 [info ] [Thread-1  ]: 12 of 17 OK created sql view model wizetrading.btc_perp_data_5m_history ........ [[32mCREATE VIEW[0m in 0.39s]
[0m14:43:23.459635 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:43:23.460639 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:43:23.461642 [info ] [Thread-1  ]: 13 of 17 START sql view model wizetrading.btc_perp_data_15m_current_and_history  [RUN]
[0m14:43:23.463644 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m14:43:23.463644 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:43:23.470638 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:43:23.475639 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 14:43:23.464641 => 14:43:23.475639
[0m14:43:23.476646 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:43:23.488344 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:43:23.494259 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:43:23.495995 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: BEGIN
[0m14:43:23.497098 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:23.740803 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:23.742372 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:43:23.744517 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_15min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_15m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m"
)
,
BTC_PERP_15m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_15m_history"
),
BTC_PERP_15m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_15m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_15m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_15m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_15m_btc_c_treated curr
             LEFT JOIN BTC_PERP_15m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:43:23.778236 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:23.783249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:43:23.784237 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_tmp" rename to "btc_perp_data_15m_current_and_history"
[0m14:43:23.807303 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:23.811496 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:43:23.812536 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:43:23.813546 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: COMMIT
[0m14:43:23.841755 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:23.848753 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup"
[0m14:43:23.850755 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:43:23.851876 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_15m_current_and_history__dbt_backup" cascade
[0m14:43:23.875435 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:23.879016 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 14:43:23.477643 => 14:43:23.879016
[0m14:43:23.881014 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_15m_current_and_history: Close
[0m14:43:23.883015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C1CB80>]}
[0m14:43:23.884015 [info ] [Thread-1  ]: 13 of 17 OK created sql view model wizetrading.btc_perp_data_15m_current_and_history  [[32mCREATE VIEW[0m in 0.42s]
[0m14:43:23.886016 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:43:23.887015 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:43:23.888016 [info ] [Thread-1  ]: 14 of 17 START sql view model wizetrading.btc_perp_data_1h_current_and_history . [RUN]
[0m14:43:23.890263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m14:43:23.890749 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:43:23.896248 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:43:23.900747 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 14:43:23.891249 => 14:43:23.899759
[0m14:43:23.901802 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:43:23.915956 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:43:23.920589 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:43:23.922017 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: BEGIN
[0m14:43:23.922956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:24.131233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:24.132063 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:43:24.134047 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h"
)
,
BTC_PERP_1h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1h_history"
),
BTC_PERP_1h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1h_btc_c_treated curr
             LEFT JOIN BTC_PERP_1h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:43:24.169412 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:24.175412 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:43:24.176414 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_tmp" rename to "btc_perp_data_1h_current_and_history"
[0m14:43:24.200407 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:24.204405 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:43:24.205407 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:43:24.206406 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: COMMIT
[0m14:43:24.238474 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:24.246091 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup"
[0m14:43:24.249092 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:43:24.250091 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1h_current_and_history__dbt_backup" cascade
[0m14:43:24.275188 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:24.278736 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 14:43:23.902849 => 14:43:24.278736
[0m14:43:24.279734 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1h_current_and_history: Close
[0m14:43:24.280742 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2D99D00>]}
[0m14:43:24.281309 [info ] [Thread-1  ]: 14 of 17 OK created sql view model wizetrading.btc_perp_data_1h_current_and_history  [[32mCREATE VIEW[0m in 0.39s]
[0m14:43:24.284827 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:43:24.286816 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:43:24.287813 [info ] [Thread-1  ]: 15 of 17 START sql view model wizetrading.btc_perp_data_1w_current_and_history . [RUN]
[0m14:43:24.291124 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m14:43:24.291624 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:43:24.299618 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:43:24.303532 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 14:43:24.292641 => 14:43:24.302531
[0m14:43:24.304531 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:43:24.314410 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:43:24.317408 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:43:24.318409 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: BEGIN
[0m14:43:24.319409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:24.523258 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:24.524259 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:43:24.526257 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_1week_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_1w_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w"
)
,
BTC_PERP_1w_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_1w_history"
),
BTC_PERP_1w_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_1w_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_1w_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_1w_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_1w_btc_c_treated curr
             LEFT JOIN BTC_PERP_1w_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:43:24.562152 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:24.571152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:43:24.572152 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_tmp" rename to "btc_perp_data_1w_current_and_history"
[0m14:43:24.596603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:24.600632 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:43:24.601629 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:43:24.602628 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: COMMIT
[0m14:43:24.635160 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:24.643603 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup"
[0m14:43:24.645598 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:43:24.646628 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_1w_current_and_history__dbt_backup" cascade
[0m14:43:24.670380 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:24.673384 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 14:43:24.305532 => 14:43:24.673384
[0m14:43:24.675385 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_1w_current_and_history: Close
[0m14:43:24.677384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2BE3760>]}
[0m14:43:24.678382 [info ] [Thread-1  ]: 15 of 17 OK created sql view model wizetrading.btc_perp_data_1w_current_and_history  [[32mCREATE VIEW[0m in 0.39s]
[0m14:43:24.681381 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:43:24.683380 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:43:24.684381 [info ] [Thread-1  ]: 16 of 17 START sql view model wizetrading.btc_perp_data_4h_current_and_history . [RUN]
[0m14:43:24.686379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m14:43:24.687380 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:43:24.693381 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:43:24.697200 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 14:43:24.687380 => 14:43:24.696163
[0m14:43:24.698190 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:43:24.706800 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:43:24.710343 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:43:24.711339 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: BEGIN
[0m14:43:24.711339 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:24.914926 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:24.916925 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:43:24.917924 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_4hour_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_4h_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h"
)
,
BTC_PERP_4h_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_4h_history"
),
BTC_PERP_4h_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_4h_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_4h_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_4h_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_4h_btc_c_treated curr
             LEFT JOIN BTC_PERP_4h_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:43:24.951656 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:24.957657 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:43:24.958657 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_tmp" rename to "btc_perp_data_4h_current_and_history"
[0m14:43:24.985440 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:24.988444 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:43:24.989445 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:43:24.990440 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: COMMIT
[0m14:43:25.020435 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:25.029434 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup"
[0m14:43:25.030434 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:43:25.031443 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_4h_current_and_history__dbt_backup" cascade
[0m14:43:25.056589 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:25.062247 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 14:43:24.698190 => 14:43:25.061220
[0m14:43:25.063245 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_4h_current_and_history: Close
[0m14:43:25.066160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2C388E0>]}
[0m14:43:25.069407 [info ] [Thread-1  ]: 16 of 17 OK created sql view model wizetrading.btc_perp_data_4h_current_and_history  [[32mCREATE VIEW[0m in 0.38s]
[0m14:43:25.072889 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:43:25.074508 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:43:25.076275 [info ] [Thread-1  ]: 17 of 17 START sql view model wizetrading.btc_perp_data_5m_current_and_history . [RUN]
[0m14:43:25.078874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m14:43:25.079873 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:43:25.095842 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:43:25.103276 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 14:43:25.080897 => 14:43:25.101776
[0m14:43:25.104297 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:43:25.115478 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:43:25.119844 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:43:25.121344 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: BEGIN
[0m14:43:25.121844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:43:25.317534 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m14:43:25.318570 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:43:25.320578 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */

  create view "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp"
    
    
  as (
    -- wizetrading.candle_5min_current_and_history source

-- This is now a dbt model file, not a raw SQL query
with 
BTC_PERP_5m_btc_c as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m"
)
,
BTC_PERP_5m_btc_h as
(
    select * from "aoavfbel"."wizetrading"."btc_perp_data_5m_history"
),
BTC_PERP_5m_btc_c_treated as (
    select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
    stream,
    event_type,
    event_time,
    symbole_src,
    candle_open_time,
    candle_close_time,
    symbole,
    "interval",
    first_trade_id,
    last_trade_id,
    openprice,
    close_price,
    high_price,
    low_price,
    base_asset_volume,
    nb_trades,
    candle_closed,
    quote_asset_volume,
    taker_buy_base_asset_volume,
    taker_buy_quote_asset_volume
    FROM BTC_PERP_5m_btc_c
      WHERE candle_closed = false
)
,
BTC_PERP_5m_btc_h_treated as (
         select to_char(to_timestamp((event_time / 1000)::double precision), 'YYYY-MM-DD HH24:MI:SS'::text) AS formatted_datetime,
         stream,
         event_type,
         event_time,
         symbole_src,
         candle_open_time,
         candle_close_time,
         symbole,
         "interval",
         first_trade_id,
         last_trade_id,
         openprice,
         close_price,
         high_price,
         low_price,
         base_asset_volume,
         nb_trades,
         candle_closed,
         quote_asset_volume,
         taker_buy_base_asset_volume,
         taker_buy_quote_asset_volume
        FROM BTC_PERP_5m_btc_h
)
,
pivot_curent AS (
         select curr.formatted_datetime,
         curr.stream,
         curr.event_type,
         curr.event_time,
         curr.symbole_src,
         curr.candle_open_time,
         curr.candle_close_time,
         curr.symbole,
         curr."interval",
         curr.first_trade_id,
         curr.last_trade_id,
         curr.openprice,
         curr.close_price,
         curr.high_price,
         curr.low_price,
         curr.base_asset_volume,
         curr.nb_trades,
         curr.candle_closed,
         curr.quote_asset_volume,
         curr.taker_buy_base_asset_volume,
         curr.taker_buy_quote_asset_volume,
         lag(hist.openprice, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_1,
         lag(hist.openprice, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_2,
         lag(hist.openprice, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_3,
         lag(hist.openprice, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_4,
         lag(hist.openprice, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_5,
         lag(hist.openprice, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_6,
         lag(hist.openprice, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_7,
         lag(hist.openprice, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_8,
         lag(hist.openprice, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_9,
         lag(hist.openprice, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS openprice_lag_10,
         lag(hist.close_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_1,
         lag(hist.close_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_2,
         lag(hist.close_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_3,
         lag(hist.close_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_4,
         lag(hist.close_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_5,
         lag(hist.close_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_6,
         lag(hist.close_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_7,
         lag(hist.close_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_8,
         lag(hist.close_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_9,
         lag(hist.close_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS close_price_lag_10,
         lag(hist.high_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_1,
         lag(hist.high_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_2,
         lag(hist.high_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_3,
         lag(hist.high_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_4,
         lag(hist.high_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_5,
         lag(hist.high_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_6,
         lag(hist.high_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_7,
         lag(hist.high_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_8,
         lag(hist.high_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_9,
         lag(hist.high_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS high_price_lag_10,
         lag(hist.low_price, 1) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_1,
         lag(hist.low_price, 2) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_2,
         lag(hist.low_price, 3) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_3,
         lag(hist.low_price, 4) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_4,
         lag(hist.low_price, 5) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_5,
         lag(hist.low_price, 6) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_6,
         lag(hist.low_price, 7) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_7,
         lag(hist.low_price, 8) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_8,
         lag(hist.low_price, 9) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_9,
         lag(hist.low_price, 10) OVER (PARTITION BY curr.event_time ORDER BY hist.event_time) AS low_price_lag_10,
         row_number() OVER (PARTITION BY curr.event_time ORDER BY hist.event_time DESC) AS rank
           FROM BTC_PERP_5m_btc_c_treated curr
             LEFT JOIN BTC_PERP_5m_btc_h_treated hist ON curr.event_time >= hist.event_time
          ORDER BY curr.event_time
)
,
final as 
(
    SELECT pivot_curent.formatted_datetime,
    pivot_curent.stream,
    pivot_curent.event_type,
    pivot_curent.event_time,
    pivot_curent.symbole_src,
    pivot_curent.candle_open_time,
    pivot_curent.candle_close_time,
    pivot_curent.symbole,
    pivot_curent."interval",
    pivot_curent.first_trade_id,
    pivot_curent.last_trade_id,
    pivot_curent.openprice,
    pivot_curent.close_price,
    pivot_curent.high_price,
    pivot_curent.low_price,
    pivot_curent.base_asset_volume,
    pivot_curent.nb_trades,
    pivot_curent.candle_closed,
    pivot_curent.quote_asset_volume,
    pivot_curent.taker_buy_base_asset_volume,
    pivot_curent.taker_buy_quote_asset_volume,
    pivot_curent.openprice_lag_1,
    pivot_curent.openprice_lag_2,
    pivot_curent.openprice_lag_3,
    pivot_curent.openprice_lag_4,
    pivot_curent.openprice_lag_5,
    pivot_curent.openprice_lag_6,
    pivot_curent.openprice_lag_7,
    pivot_curent.openprice_lag_8,
    pivot_curent.openprice_lag_9,
    pivot_curent.openprice_lag_10,
    pivot_curent.close_price_lag_1,
    pivot_curent.close_price_lag_2,
    pivot_curent.close_price_lag_3,
    pivot_curent.close_price_lag_4,
    pivot_curent.close_price_lag_5,
    pivot_curent.close_price_lag_6,
    pivot_curent.close_price_lag_7,
    pivot_curent.close_price_lag_8,
    pivot_curent.close_price_lag_9,
    pivot_curent.close_price_lag_10,
    pivot_curent.high_price_lag_1,
    pivot_curent.high_price_lag_2,
    pivot_curent.high_price_lag_3,
    pivot_curent.high_price_lag_4,
    pivot_curent.high_price_lag_5,
    pivot_curent.high_price_lag_6,
    pivot_curent.high_price_lag_7,
    pivot_curent.high_price_lag_8,
    pivot_curent.high_price_lag_9,
    pivot_curent.high_price_lag_10,
    pivot_curent.low_price_lag_1,
    pivot_curent.low_price_lag_2,
    pivot_curent.low_price_lag_3,
    pivot_curent.low_price_lag_4,
    pivot_curent.low_price_lag_5,
    pivot_curent.low_price_lag_6,
    pivot_curent.low_price_lag_7,
    pivot_curent.low_price_lag_8,
    pivot_curent.low_price_lag_9,
    pivot_curent.low_price_lag_10,
    pivot_curent.rank
   FROM pivot_curent
  WHERE pivot_curent.rank = 1
)
select * from final
  );
[0m14:43:25.358288 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:43:25.370697 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:43:25.371699 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
alter table "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_tmp" rename to "btc_perp_data_5m_current_and_history"
[0m14:43:25.396550 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:43:25.400560 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:43:25.401545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:43:25.402546 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: COMMIT
[0m14:43:25.432424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m14:43:25.438425 [debug] [Thread-1  ]: Applying DROP to: "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup"
[0m14:43:25.441427 [debug] [Thread-1  ]: Using postgres connection "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:43:25.442427 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"} */
drop view if exists "aoavfbel"."wizetrading"."btc_perp_data_5m_current_and_history__dbt_backup" cascade
[0m14:43:25.466589 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m14:43:25.472496 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 14:43:25.105295 => 14:43:25.471171
[0m14:43:25.474506 [debug] [Thread-1  ]: On model.dbt_wizetrading.btc_perp_data_5m_current_and_history: Close
[0m14:43:25.478408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45a5b69-a08c-46e2-8366-2b7e04fa098a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2D62DF0>]}
[0m14:43:25.481149 [info ] [Thread-1  ]: 17 of 17 OK created sql view model wizetrading.btc_perp_data_5m_current_and_history  [[32mCREATE VIEW[0m in 0.40s]
[0m14:43:25.483703 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:43:25.486028 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:25.486983 [debug] [MainThread]: On master: BEGIN
[0m14:43:25.486983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:43:25.675227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:43:25.676577 [debug] [MainThread]: On master: COMMIT
[0m14:43:25.677202 [debug] [MainThread]: Using postgres connection "master"
[0m14:43:25.677703 [debug] [MainThread]: On master: COMMIT
[0m14:43:25.699191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:43:25.700390 [debug] [MainThread]: On master: Close
[0m14:43:25.702623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:25.702623 [debug] [MainThread]: Connection 'list_aoavfbel' was properly closed.
[0m14:43:25.703626 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m14:43:25.704568 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m14:43:25.704568 [info ] [MainThread]: 
[0m14:43:25.706646 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 7.88 seconds (7.88s).
[0m14:43:25.711736 [debug] [MainThread]: Command end result
[0m14:43:25.738220 [info ] [MainThread]: 
[0m14:43:25.740268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:25.741849 [info ] [MainThread]: 
[0m14:43:25.742872 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m14:43:25.746876 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:25.745961 after 8.91 seconds
[0m14:43:25.748873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A9FA719D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2879040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA2879100>]}
[0m14:43:25.750872 [debug] [MainThread]: Flushing usage events
[0m14:45:20.725043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CCF04FA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD18F4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD18F4CD0>]}


============================== 14:45:20.735042 | 058fb6cd-d991-4a65-811b-b23b7b947117 ==============================
[0m14:45:20.735042 [info ] [MainThread]: Running with dbt=1.7.11
[0m14:45:20.737446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --target-path docs/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'docs/', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:21.020752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '058fb6cd-d991-4a65-811b-b23b7b947117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CCF9587F0>]}
[0m14:45:21.123484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '058fb6cd-d991-4a65-811b-b23b7b947117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD18E3C40>]}
[0m14:45:21.125413 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m14:45:21.139413 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m14:45:21.278294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:21.280289 [debug] [MainThread]: Partial parsing: updated file: dbt_wizetrading://models\trading_perp_btc_data\schema.yml
[0m14:45:21.390283 [debug] [MainThread]: 1699: static parser successfully parsed trading_perp_btc_data\btc_perp_data_15m.sql
[0m14:45:21.616774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '058fb6cd-d991-4a65-811b-b23b7b947117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD21A4580>]}
[0m14:45:21.626689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '058fb6cd-d991-4a65-811b-b23b7b947117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD1D83820>]}
[0m14:45:21.626689 [info ] [MainThread]: Found 17 models, 1 test, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m14:45:21.628672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '058fb6cd-d991-4a65-811b-b23b7b947117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD1D838B0>]}
[0m14:45:21.630673 [info ] [MainThread]: 
[0m14:45:21.632694 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:21.636741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m14:45:21.649740 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:45:21.650754 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m14:45:21.651746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:21.885497 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:45:21.885497 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m14:45:21.886500 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m14:45:21.923196 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m14:45:21.926135 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m14:45:21.953277 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m14:45:21.968274 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:21.969263 [debug] [MainThread]: On master: BEGIN
[0m14:45:21.970261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:22.178935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:45:22.179934 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:22.180933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:45:22.245312 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m14:45:22.256233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '058fb6cd-d991-4a65-811b-b23b7b947117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD1B47760>]}
[0m14:45:22.257252 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:22.286020 [debug] [MainThread]: On master: Close
[0m14:45:22.288016 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:22.290018 [info ] [MainThread]: 
[0m14:45:22.308013 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perptreated_data
[0m14:45:22.310014 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.dbt_wizetrading.btc_perptreated_data'
[0m14:45:22.311033 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perptreated_data
[0m14:45:22.324027 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perptreated_data"
[0m14:45:22.328014 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (compile): 14:45:22.311033 => 14:45:22.327012
[0m14:45:22.329014 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perptreated_data
[0m14:45:22.329417 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perptreated_data (execute): 14:45:22.329417 => 14:45:22.329417
[0m14:45:22.331013 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perptreated_data
[0m14:45:22.331013 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:45:22.332054 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perptreated_data, now model.dbt_wizetrading.raw_data_btc_perp)
[0m14:45:22.333160 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.raw_data_btc_perp
[0m14:45:22.338704 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.raw_data_btc_perp"
[0m14:45:22.342703 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (compile): 14:45:22.334403 => 14:45:22.341689
[0m14:45:22.344775 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.raw_data_btc_perp
[0m14:45:22.345721 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.raw_data_btc_perp (execute): 14:45:22.345721 => 14:45:22.345721
[0m14:45:22.349782 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.raw_data_btc_perp
[0m14:45:22.350779 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:45:22.352727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.raw_data_btc_perp, now model.dbt_wizetrading.btc_perp_data_15m)
[0m14:45:22.353254 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m
[0m14:45:22.359873 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m"
[0m14:45:22.364796 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (compile): 14:45:22.353254 => 14:45:22.363779
[0m14:45:22.365764 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m
[0m14:45:22.366846 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m (execute): 14:45:22.366846 => 14:45:22.366846
[0m14:45:22.368765 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m
[0m14:45:22.368765 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:45:22.369760 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m, now model.dbt_wizetrading.btc_perp_data_15m_history)
[0m14:45:22.370853 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:45:22.380163 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_history"
[0m14:45:22.385826 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (compile): 14:45:22.372776 => 14:45:22.384744
[0m14:45:22.387198 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:45:22.388230 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_history (execute): 14:45:22.387700 => 14:45:22.387700
[0m14:45:22.391231 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_history
[0m14:45:22.392229 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:45:22.394845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_history, now model.dbt_wizetrading.btc_perp_data_1h)
[0m14:45:22.396337 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h
[0m14:45:22.402873 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h"
[0m14:45:22.407146 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (compile): 14:45:22.396841 => 14:45:22.407146
[0m14:45:22.408471 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h
[0m14:45:22.409462 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h (execute): 14:45:22.408471 => 14:45:22.408471
[0m14:45:22.412461 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h
[0m14:45:22.413462 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:45:22.415463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h, now model.dbt_wizetrading.btc_perp_data_1h_history)
[0m14:45:22.416462 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:45:22.421936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_history"
[0m14:45:22.425165 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (compile): 14:45:22.417468 => 14:45:22.424172
[0m14:45:22.426266 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:45:22.427692 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_history (execute): 14:45:22.426266 => 14:45:22.426266
[0m14:45:22.429679 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_history
[0m14:45:22.430683 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:45:22.431686 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_history, now model.dbt_wizetrading.btc_perp_data_1w)
[0m14:45:22.433678 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w
[0m14:45:22.439075 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w"
[0m14:45:22.442899 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (compile): 14:45:22.433678 => 14:45:22.441875
[0m14:45:22.443899 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w
[0m14:45:22.445899 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w (execute): 14:45:22.444899 => 14:45:22.444899
[0m14:45:22.449182 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w
[0m14:45:22.451120 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:45:22.452661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w, now model.dbt_wizetrading.btc_perp_data_1w_history)
[0m14:45:22.453618 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:45:22.461009 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_history"
[0m14:45:22.465114 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (compile): 14:45:22.454119 => 14:45:22.464113
[0m14:45:22.466112 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:45:22.466112 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_history (execute): 14:45:22.466112 => 14:45:22.466112
[0m14:45:22.470035 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_history
[0m14:45:22.472415 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:45:22.475034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_history, now model.dbt_wizetrading.btc_perp_data_4h)
[0m14:45:22.476033 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h
[0m14:45:22.480676 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h"
[0m14:45:22.484479 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (compile): 14:45:22.476664 => 14:45:22.483680
[0m14:45:22.485499 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h
[0m14:45:22.486501 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h (execute): 14:45:22.486501 => 14:45:22.486501
[0m14:45:22.489699 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h
[0m14:45:22.490463 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:45:22.492590 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h, now model.dbt_wizetrading.btc_perp_data_4h_history)
[0m14:45:22.492590 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:45:22.498597 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_history"
[0m14:45:22.501266 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (compile): 14:45:22.493591 => 14:45:22.500764
[0m14:45:22.502963 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:45:22.503984 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_history (execute): 14:45:22.502963 => 14:45:22.503984
[0m14:45:22.506986 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_history
[0m14:45:22.508314 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:45:22.510367 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_history, now model.dbt_wizetrading.btc_perp_data_5m)
[0m14:45:22.510867 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m
[0m14:45:22.522318 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m"
[0m14:45:22.527020 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (compile): 14:45:22.511884 => 14:45:22.526350
[0m14:45:22.528285 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m
[0m14:45:22.529428 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m (execute): 14:45:22.528776 => 14:45:22.528776
[0m14:45:22.531930 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m
[0m14:45:22.532931 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:45:22.534929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m, now model.dbt_wizetrading.btc_perp_data_5m_history)
[0m14:45:22.536431 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:45:22.541932 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_history"
[0m14:45:22.544930 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (compile): 14:45:22.537429 => 14:45:22.544429
[0m14:45:22.545430 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:45:22.546429 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_history (execute): 14:45:22.545930 => 14:45:22.545930
[0m14:45:22.547929 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_history
[0m14:45:22.548428 [debug] [Thread-1  ]: Began running node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m14:45:22.549929 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_5m_history, now test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c)
[0m14:45:22.550929 [debug] [Thread-1  ]: Began compiling node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m14:45:22.568778 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c"
[0m14:45:22.574216 [debug] [Thread-1  ]: Timing info for test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c (compile): 14:45:22.551929 => 14:45:22.573215
[0m14:45:22.575993 [debug] [Thread-1  ]: Began executing node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m14:45:22.577494 [debug] [Thread-1  ]: Timing info for test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c (execute): 14:45:22.576495 => 14:45:22.576995
[0m14:45:22.580046 [debug] [Thread-1  ]: Finished running node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m14:45:22.581954 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:45:22.583993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c, now model.dbt_wizetrading.btc_perp_data_15m_current_and_history)
[0m14:45:22.584993 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:45:22.592992 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_15m_current_and_history"
[0m14:45:22.597494 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (compile): 14:45:22.585993 => 14:45:22.596492
[0m14:45:22.598996 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:45:22.600492 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_15m_current_and_history (execute): 14:45:22.599996 => 14:45:22.599996
[0m14:45:22.602992 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_15m_current_and_history
[0m14:45:22.604492 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:45:22.605993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_15m_current_and_history, now model.dbt_wizetrading.btc_perp_data_1h_current_and_history)
[0m14:45:22.607493 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:45:22.617994 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1h_current_and_history"
[0m14:45:22.623492 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (compile): 14:45:22.607991 => 14:45:22.622491
[0m14:45:22.624492 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:45:22.625992 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1h_current_and_history (execute): 14:45:22.625493 => 14:45:22.625493
[0m14:45:22.628495 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1h_current_and_history
[0m14:45:22.629992 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:45:22.632492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1h_current_and_history, now model.dbt_wizetrading.btc_perp_data_1w_current_and_history)
[0m14:45:22.633491 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:45:22.639991 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_1w_current_and_history"
[0m14:45:22.644998 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (compile): 14:45:22.633990 => 14:45:22.644437
[0m14:45:22.645993 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:45:22.646497 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_1w_current_and_history (execute): 14:45:22.646497 => 14:45:22.646497
[0m14:45:22.648991 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_1w_current_and_history
[0m14:45:22.649993 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:45:22.651992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_1w_current_and_history, now model.dbt_wizetrading.btc_perp_data_4h_current_and_history)
[0m14:45:22.652992 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:45:22.660001 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_4h_current_and_history"
[0m14:45:22.664001 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (compile): 14:45:22.652992 => 14:45:22.663000
[0m14:45:22.665001 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:45:22.667219 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_4h_current_and_history (execute): 14:45:22.665999 => 14:45:22.665999
[0m14:45:22.669274 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_4h_current_and_history
[0m14:45:22.670273 [debug] [Thread-1  ]: Began running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:45:22.672273 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_wizetrading.btc_perp_data_4h_current_and_history, now model.dbt_wizetrading.btc_perp_data_5m_current_and_history)
[0m14:45:22.673272 [debug] [Thread-1  ]: Began compiling node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:45:22.681269 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_wizetrading.btc_perp_data_5m_current_and_history"
[0m14:45:22.685274 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (compile): 14:45:22.673272 => 14:45:22.685274
[0m14:45:22.686273 [debug] [Thread-1  ]: Began executing node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:45:22.688491 [debug] [Thread-1  ]: Timing info for model.dbt_wizetrading.btc_perp_data_5m_current_and_history (execute): 14:45:22.687273 => 14:45:22.687273
[0m14:45:22.690988 [debug] [Thread-1  ]: Finished running node model.dbt_wizetrading.btc_perp_data_5m_current_and_history
[0m14:45:22.692989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:22.693989 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m14:45:22.694989 [debug] [MainThread]: Connection 'model.dbt_wizetrading.btc_perp_data_5m_current_and_history' was properly closed.
[0m14:45:22.703489 [debug] [MainThread]: Command end result
[0m14:45:22.754133 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:45:22.755634 [info ] [MainThread]: Building catalog
[0m14:45:22.763634 [debug] [ThreadPool]: Acquiring new postgres connection 'aoavfbel.information_schema'
[0m14:45:22.775641 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m14:45:22.776648 [debug] [ThreadPool]: On aoavfbel.information_schema: BEGIN
[0m14:45:22.777754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:22.981296 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:45:22.982300 [debug] [ThreadPool]: Using postgres connection "aoavfbel.information_schema"
[0m14:45:22.983294 [debug] [ThreadPool]: On aoavfbel.information_schema: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "aoavfbel.information_schema"} */

    
    

    select
        'aoavfbel' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_15m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data_btc_perp')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1w_current_and_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_1h')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perptreated_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('raw_data')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_4h_history')) or (upper(sch.nspname) = upper('wizetrading') and
           upper(tbl.relname) = upper('btc_perp_data_5m_current_and_history')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:45:23.051631 [debug] [ThreadPool]: SQL status: SELECT 570 in 0.0 seconds
[0m14:45:23.102716 [debug] [ThreadPool]: On aoavfbel.information_schema: ROLLBACK
[0m14:45:23.124716 [debug] [ThreadPool]: On aoavfbel.information_schema: Close
[0m14:45:23.211108 [info ] [MainThread]: Catalog written to C:\Users\alarcher\Documents\dbt\dbt_env\dbt_wizetrading\dbt-wizetrading-demo\docs\catalog.json
[0m14:45:23.215120 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:45:23.214110 after 2.54 seconds
[0m14:45:23.215120 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:45:23.216126 [debug] [MainThread]: Connection 'aoavfbel.information_schema' was properly closed.
[0m14:45:23.217113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CCF04FA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD18E3C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CD20F6CA0>]}
[0m14:45:23.218175 [debug] [MainThread]: Flushing usage events
[0m15:58:47.260798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021981E319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219846853D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984685A60>]}


============================== 15:58:47.275811 | 534f104f-180f-4a54-99a9-4f0f5f9f2c51 ==============================
[0m15:58:47.275811 [info ] [MainThread]: Running with dbt=1.7.11
[0m15:58:47.276811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\alarcher\\.dbt', 'log_path': 'C:\\Users\\alarcher\\Documents\\dbt\\dbt_env\\dbt_wizetrading\\dbt-wizetrading-demo\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:47.538689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '534f104f-180f-4a54-99a9-4f0f5f9f2c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219826E8AF0>]}
[0m15:58:47.620419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '534f104f-180f-4a54-99a9-4f0f5f9f2c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984917520>]}
[0m15:58:47.622419 [info ] [MainThread]: Registered adapter: postgres=1.7.11
[0m15:58:47.644371 [debug] [MainThread]: checksum: 1b58ec263fbd34ee8091684d6a2f6c1ad2902b1459e632a74eb63768af36ddb7, vars: {}, profile: , target: , version: 1.7.11
[0m15:58:48.467971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:48.468971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:48.475973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '534f104f-180f-4a54-99a9-4f0f5f9f2c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984C3F4C0>]}
[0m15:58:48.504778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '534f104f-180f-4a54-99a9-4f0f5f9f2c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984A2E1C0>]}
[0m15:58:48.505778 [info ] [MainThread]: Found 17 models, 1 test, 1 source, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m15:58:48.506778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534f104f-180f-4a54-99a9-4f0f5f9f2c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984985970>]}
[0m15:58:48.507778 [info ] [MainThread]: 
[0m15:58:48.508777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:58:48.511778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_aoavfbel_wizetrading'
[0m15:58:48.522929 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m15:58:48.523780 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: BEGIN
[0m15:58:48.523780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:48.753952 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:58:48.754947 [debug] [ThreadPool]: Using postgres connection "list_aoavfbel_wizetrading"
[0m15:58:48.754947 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "list_aoavfbel_wizetrading"} */
select
      'aoavfbel' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'wizetrading'
    union all
    select
      'aoavfbel' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'wizetrading'
  
[0m15:58:48.780068 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.0 seconds
[0m15:58:48.782088 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: ROLLBACK
[0m15:58:48.807370 [debug] [ThreadPool]: On list_aoavfbel_wizetrading: Close
[0m15:58:48.814240 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:48.815231 [debug] [MainThread]: On master: BEGIN
[0m15:58:48.815231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:49.017939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:49.017939 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:49.018933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:58:49.051740 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m15:58:49.057737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534f104f-180f-4a54-99a9-4f0f5f9f2c51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219848ACD00>]}
[0m15:58:49.058738 [debug] [MainThread]: On master: ROLLBACK
[0m15:58:49.079916 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:49.079916 [debug] [MainThread]: On master: BEGIN
[0m15:58:49.133027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:49.133027 [debug] [MainThread]: On master: COMMIT
[0m15:58:49.133027 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:49.134034 [debug] [MainThread]: On master: COMMIT
[0m15:58:49.155136 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:49.156136 [debug] [MainThread]: On master: Close
[0m15:58:49.156136 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:58:49.157137 [info ] [MainThread]: 
[0m15:58:49.186028 [debug] [Thread-1  ]: Began running node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m15:58:49.187027 [info ] [Thread-1  ]: 1 of 1 START test unique_btc_perp_data_15m_stream .............................. [RUN]
[0m15:58:49.188027 [debug] [Thread-1  ]: Acquiring new postgres connection 'test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c'
[0m15:58:49.189033 [debug] [Thread-1  ]: Began compiling node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m15:58:49.243549 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c"
[0m15:58:49.246541 [debug] [Thread-1  ]: Timing info for test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c (compile): 15:58:49.189033 => 15:58:49.246541
[0m15:58:49.246541 [debug] [Thread-1  ]: Began executing node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m15:58:49.262945 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c"
[0m15:58:49.265943 [debug] [Thread-1  ]: Using postgres connection "test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c"
[0m15:58:49.265943 [debug] [Thread-1  ]: On test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c: BEGIN
[0m15:58:49.266946 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m15:58:49.462488 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m15:58:49.463549 [debug] [Thread-1  ]: Using postgres connection "test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c"
[0m15:58:49.463549 [debug] [Thread-1  ]: On test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c: /* {"app": "dbt", "dbt_version": "1.7.11", "profile_name": "dbt_wizetrading", "target_name": "dev", "node_id": "test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    stream as unique_field,
    count(*) as n_records

from "aoavfbel"."wizetrading"."btc_perp_data_15m"
where stream is not null
group by stream
having count(*) > 1



      
    ) dbt_internal_test
[0m15:58:49.544099 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m15:58:49.546099 [debug] [Thread-1  ]: Timing info for test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c (execute): 15:58:49.247551 => 15:58:49.546099
[0m15:58:49.547099 [debug] [Thread-1  ]: On test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c: ROLLBACK
[0m15:58:49.568832 [debug] [Thread-1  ]: On test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c: Close
[0m15:58:49.570830 [error] [Thread-1  ]: 1 of 1 FAIL 1 unique_btc_perp_data_15m_stream .................................. [[31mFAIL 1[0m in 0.38s]
[0m15:58:49.571832 [debug] [Thread-1  ]: Finished running node test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c
[0m15:58:49.572770 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:49.572770 [debug] [MainThread]: On master: BEGIN
[0m15:58:49.573917 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:49.760716 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:58:49.761716 [debug] [MainThread]: On master: COMMIT
[0m15:58:49.761716 [debug] [MainThread]: Using postgres connection "master"
[0m15:58:49.762716 [debug] [MainThread]: On master: COMMIT
[0m15:58:49.783912 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:58:49.784910 [debug] [MainThread]: On master: Close
[0m15:58:49.784910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:49.785909 [debug] [MainThread]: Connection 'list_aoavfbel_wizetrading' was properly closed.
[0m15:58:49.785909 [debug] [MainThread]: Connection 'test.dbt_wizetrading.unique_btc_perp_data_15m_stream.d31528f66c' was properly closed.
[0m15:58:49.785909 [info ] [MainThread]: 
[0m15:58:49.786909 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m15:58:49.787913 [debug] [MainThread]: Command end result
[0m15:58:49.800366 [info ] [MainThread]: 
[0m15:58:49.802376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:58:49.802376 [info ] [MainThread]: 
[0m15:58:49.803594 [error] [MainThread]: [31mFailure in test unique_btc_perp_data_15m_stream (models\trading_perp_btc_data\schema.yml)[0m
[0m15:58:49.804376 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:58:49.804376 [info ] [MainThread]: 
[0m15:58:49.805376 [info ] [MainThread]:   compiled Code at target\compiled\dbt_wizetrading\models\trading_perp_btc_data\schema.yml\unique_btc_perp_data_15m_stream.sql
[0m15:58:49.806376 [info ] [MainThread]: 
[0m15:58:49.806376 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:58:49.807375 [debug] [MainThread]: Command `dbt test` failed at 15:58:49.807375 after 2.61 seconds
[0m15:58:49.808375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021981E319A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984C3F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021984CA4E50>]}
[0m15:58:49.808375 [debug] [MainThread]: Flushing usage events
